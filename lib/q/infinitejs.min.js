var __extends=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),__decorate=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},__metadata=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};define("sys/Filters",["require","exports","sys/Corelib"],function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i;(function(t){var e;(function(t){var e=function(t){function e(e,n,i){var r=t.call(this,e,1)||this;return r.p=n,r.fl=i,r}return __extends(e,t),e.prototype.getFilter=function(){return null},e.prototype.getSource=function(t){return t instanceof Array&&(this.fl.Source=new n.collection.List(Object,t),this.isConst=!0),null},e.prototype.getPatent=function(t){return t},e.prototype.Convert=function(t){if(!this.isConst)return null==this.fl&&(this.fl=new n.collection.ExList(Object)),this.fl.Source=t,this.fl},e.prototype.ConvertBack=function(t){return t.Source},e.prototype.Initialize=function(){var e=this.fl,r=this.p;if(e||(this.fl=e=new n.collection.ExList(Object)),r){var o=JSON.parse(decodeURI(r));for(var s in o)"filter"===s&&(e.Filter=this.getFilter()),"source"===s&&(e.Source=this.getSource(o[s])),"patent"===s&&(null==e.Filter&&(e.Filter=new i.LStringFilter),e.Filter.Patent=this.getPatent(o[s])),"max"===s&&(e.MaxResult=parseInt(s)),"shift"===s&&(e.Shift=parseInt(s))}null==e.Filter&&(e.Filter=new i.LStringFilter),null==e.Source&&this.source&&(e.Source=this.source.Value),t.prototype.Initialize.call(this)},e}(n.bind.Filter);t.ListFilter=e,n.bind.RegisterFilter({BindingMode:1,Name:"listfilter",CreateNew:function(t,n,i){return new e(t,i)}})})(e=t.scopic||(t.scopic={}));var i;(function(e){function i(e,n){function i(){var t=e.Count/n;return t%1==0?t:Math.floor(t)+1}function r(){var e=i();return s=Math.max(0,Math.min(s,e-1)),new t.list.SubListPatent(s*n,(s+1)*n-1)}var o=new t.list.SubListFilter,s=0,a=e.Filtred(o);return o.Patent=r(),{update:function(){o.Patent=r()},reset:function(){s=0,o.Patent=r()},next:function(){++s,o.Patent=r()},previouse:function(){--s,o.Patent=r()},get List(){return a},get numPages(){var t=e.Count/n;return t%1==0?t:t+1},get Index(){return s},set Index(t){s=t,o.Patent=r()},get CountPerPage(){return n},set CountPerPage(t){n=t,o.Patent=r()}}}var r=function(){function t(t,e){t>e?(this.Start=e,this.End=t):(this.Start=t,this.End=e)}return t.prototype.Check=function(t){return t<=this.End&&t>=this.Start},t.prototype.equals=function(t){return this._refresh?delete this._refresh&&!1:this.Start==t.Start&&this.End==t.End},t.prototype.Refresh=function(){return this._refresh=!0,this},t}();e.SubListPatent=r;var o=function(){function t(t){this.o=t=t.trim().toLowerCase(),this.p=""===t?[]:t.split(" ")}return t.prototype.Check=function(t){if(!t)return!0;var e=this.p;t=t.toLowerCase();for(var n=0,i=e.length;n<i;n++)if(t.indexOf(e[n])===-1)return!1;return!0},t.prototype.equals=function(t){return t.o===this.o},t}();e.StringPatent=o;var s=function(){function t(t){this.s=t}return t.prototype.Check=function(t){return void 0===this.s||t===this.s},t.prototype.equals=function(t){return t.s===this.s},t}();e.PropertyPatent=s;var a=function(t){function e(e){var n=t.call(this)||this;return n.DP=e,n}return __extends(e,t),e.prototype.Begin=function(t,e){this._patent||(this._skip=!0),this._patent.s||(this._skip=!0),this._skip=!1},e.prototype.IsMatch=function(t,e){return this._skip||!e||this._patent.Check(e.GetValue(this.DP))},e.prototype.convertFromString=function(t){return null},e}(n.utils.Filter);e.PropertyFilter=a;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.Begin=function(t,e){},e.prototype.IsMatch=function(t,e){return null==this._patent||this._patent.Check(e.toString())},e.prototype.convertFromString=function(t){var e=new o(t);return this._patent&&this._patent.equals(e)?this._patent:e},e}(n.utils.Filter);e.StringFilter=u;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.Begin=function(t,e){this.deb=t,this.fin=t+e},e.prototype.IsMatch=function(t,e){return t>=this.deb&&t<this.fin?null==this._patent||this._patent.Check(e.toString()):null},e.prototype.convertFromString=function(t){var e=new o(t);return this._patent&&this._patent.equals(e)?this._patent:e},e}(n.utils.Filter);e.BoundStringFilter=c;var l=function(){function t(t){this.o=t=t.trim().toLowerCase()}return t.prototype.Check=function(t){if(!t)return!0},t.prototype.equals=function(t){return t.o===this.o},t}();e.DObjectPatent=l;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.Begin=function(t,e){},e.prototype.IsMatch=function(t,e){return null==this._patent||this._patent.Check(e.toString())},e.prototype.convertFromString=function(t){var e=new o(t);return this._patent&&this._patent.equals(e)?this._patent:e},e}(n.utils.Filter);e.DObjectFilter=p;var h=function(){function t(t,e){this.left=t,this.right=e}return t.prototype.equals=function(t){var e,n,i=t;return i&&(e=i.left,n=i.right),(!t||t instanceof this.constructor)&&(this.areEquals(this.left,e)&&this.areEquals(this.right,n))},t.prototype.areEquals=function(t,e){return null==t&&null==e||(null==t?e.equals(t):t.equals(e))},t}();e.PatentGroup=h;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.Check=function(t){var e=!this.left||this.left.Check(t);if(null==e)return null;var n=!this.right||this.right.Check(t);return null==n?null:e&&n},e.prototype.Clone=function(){return new e(this.left,this.right)},e}(h);e.ANDPatentGroup=d;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.Clone=function(){return new e(this.left,this.right)},e.prototype.Check=function(t){var e=!!this.left&&this.left.Check(t);if(null==e)return null;var n=!!this.right&&this.right.Check(t);return null==n?null:n||e},e}(h);e.ORPatentGroup=f;var y=function(t){function e(e){var n=t.call(this)||this;if(!e)throw"";return n.Patent=e,n}return __extends(e,t),e.prototype.Begin=function(t,e){},e.prototype.IsMatch=function(t,e){return null==this._patent||this._patent.Check(e)},e.prototype.convertFromString=function(t){throw"null"},Object.defineProperty(e.prototype,"LeftPatent",{set:function(t){this.Patent.left=t,this.Patent=this.Patent.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RightPatent",{set:function(t){this.Patent.right=t,this.Patent=this.Patent.Clone()},enumerable:!0,configurable:!0}),e}(n.utils.Filter);e.FilterGroup=y;var v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.Begin=function(t,e){this.deb=t||0,this.count=e},e.prototype.IsMatch=function(t,e){if(0===this.deb){if(this.count>0)return!(null!=this._patent&&!this._patent.Check(e.toString()))&&(this.count--,!0)}else this.deb--;return!1},e.prototype.convertFromString=function(t){var e=new o(t);return this._patent&&this._patent.equals(e)?this._patent:e},e}(n.utils.Filter);e.LStringFilter=v;var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.deb=0,e.count=50,e}return __extends(e,t),e.prototype.Begin=function(t,e){this.deb=t,this.count=e},e.prototype.IsMatch=function(t,e){var n=null==this._patent||this._patent.Check(t);return!!n&&(this.deb>0?(this.deb--,!1):this.count>0?(this.count--,!0):null)},e.prototype.convertFromString=function(t){var e=t.split(/[\s|\\|\.|\/]+/),n=0,i=0;e.length>0&&(n=parseFloat(e[0])),i=e.length>1?parseFloat(e[1]):n+(null==this._patent?10:this._patent.End-this._patent.Start);var o=new r(n,i);return this._patent&&this._patent.equals(o)?this._patent:o},e}(n.utils.Filter);e.SubListFilter=g,e.indexdFilter=i})(i=t.list||(t.list={}))})(i=e.filters||(e.filters={}))}),define("sys/runtime",["require","exports","context"],function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i;(function(t){function e(t,e,n,i){try{if(e)return e.apply(t,i);var r=new Error("Undefined Try Block")}catch(t){r=t}return n&&n.apply(t,(i=i.slice(),i.unshift(r),i))}function n(e,n,i,r){return t.TryCatch(Object,Object.defineProperty,r,[e,n,i])||!1}t.TryCatch=e,t.$defineProperty=n})(i=e.helper||(e.helper={}));var r;(function(t){function e(t){return t instanceof y?t:new y(t)}function n(t,e,n){var i;try{"function"==typeof t?i=t.apply(e,n):t instanceof y?i=t.Invoke.apply(t,n):"Invoke"in t&&(i=t.Invoke.apply(t.Owner||e,n))}catch(t){}return i}function r(t,e){for(;t=t.__proto__;)if(t.constructor.name==e)return!0;return!1}function o(t,e){for(;t=t.__proto__;)if(t.constructor===e)return!0;return!1}function s(t,e){for(var n=t;t;){if(t==e)return!0;n=n.base}return!1}function a(e){if(e instanceof t.GenericType)return e.GetBaseType();var n=e.prototype.__proto__;return null==n?null:n.constructor}function u(t,e){var n=[],i=t.prototype;do{if(i.constructor==e)break;n.push(i.constructor),i=i.__proto__}while(null!==i);return n}function c(e,n){if(e===n||n===Object)return!0;e.constructor==t.GenericType&&(e=e.Constructor),n.constructor==t.GenericType&&(n=n.Constructor);var i=e.prototype;do{if(i.constructor===n)return!0;i=i.__proto__}while(null!==i);return!1}function l(){return g||(g=new Map)}function p(t){return t&&"prototype"in t&&"function"==typeof t}function h(t){return"object"==typeof t&&"constructor"in t&&p(t.constructor)&&!(t instanceof t.constructor)}function d(t){return"constructor"in t&&t instanceof t.constructor}var f=!1,y=function(){function t(t,e){this.Owner=e,this._list=[],t&&this._list.push(t)}return t.prototype.add=function(t){return this._list.push(t),this},t.prototype.With=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this.Owner;this.Owner=t;var o=i.TryCatch(this,this.Invoke,void 0,e);return this.Owner=r,o},t.prototype.Clone=function(){var e=new t;return e._list=this._list.slice(),e},t}();t.MethodGroup=y,y.prototype.Invoke=function(){for(var t=0;t<this._list.length;t++){var e,n=this._list[t];try{"function"==typeof n?e=n.apply(this.Owner,arguments):n instanceof y?e=n.Invoke.apply(n,arguments):"Invoke"in n&&(e=n.Invoke.apply(n.Owner||this.Owner,arguments))}catch(t){}}return e},t.ToMethodGroup=e,t.Invoke=n;Array.prototype.slice;t.isInstanceOfClassName=r,t.isInstanceOfClass=o,t._isInstanceOf=s,t.GetBaseType=a,t.GetBaseTypes=u,t.IsInstanceOf=c;var v=function(){function t(t){this.passed=[],this.type=t}return t.prototype._getPath=function(t){for(var e in t){var n=t[e];if(this.passed.indexOf(n)===-1)switch(this.passed.push(n),typeof n){case"string":case"number":case"boolean":case"undefined":continue;default:if(n===this.type)return e;if(n instanceof Function)continue;var i=this._getPath(n);if(null!=i)return e+"."+i}}},t.prototype.GetType=function(t){return null==this.passed&&(this.passed=[]),this.passed.length=0,this._getPath(t)},t}();t.Type=v;var g,b=function(){function t(t,e,n){if(this.Constructor=t,this.Params=e,this.prototype=t.prototype,!f)throw this;l().set(this,n),f=!1}return Object.defineProperty(t.prototype,"base",{get:function(){return l().get(this)},enumerable:!0,configurable:!0}),t.prototype.GetBaseType=function(){return l().get(this)},t.GetType=function(e,n,i,r){if("function"!=typeof e)throw"type must be fanction";if(null==n||0===n.length)return e;for(var o=(this.i(e),l().entries()),s=o.next();!s.done;s=o.next()){var u=s.value[0];s.value[1];if(e==u.Constructor&&n.length==u.Params.length){for(var c=u.Params,p=c.length-1;p>=0;p--)if(c[p]!=n[p]){c=void 0;break}if(c)return u}}return i?void 0:(f=!0,new t(e,n,null==r?a(e):r))},t.i=function(e){return e instanceof t?1:0},t.IsInstanceOf=function(t,e){return this._isInstanceOf[this.i(t)+2*this.i(e)](t,e)},t._isInstanceOf=[function(t,e){return c(t,e)},function(t,e){return c(t,e.Constructor)},function(t,e){return c(t.Constructor,e.Constructor)},function(t,e){return c(t.Constructor,e)}],t}();t.GenericType=b,Function.prototype.IsInstanceOf=t.IsInstanceOf;var m=function(){function t(t){this._type=t}return Object.defineProperty(t.prototype,"Type",{get:function(){return this._type()},enumerable:!0,configurable:!0}),t}();t.DelayedType=m;var _;(function(t){function e(t,e,n){var r=Object.getOwnPropertyDescriptor(t,e);i.$defineProperty(t,e,{get:r.get,set:function(t){var e=r.get.call(this);if(t!==e){r.set.call(this,t);var i=0==o.length?document.createEvent("Event"):o.pop();i.initEvent(n,!0,!0),i.oldValue=e,i.newValue=t,dispatchEvent(new Event(n,{bubbles:!1,cancelable:!0,scoped:!1})),this instanceof EventTarget?this.dispatchEvent(i):dispatchEvent(i),o.push(i)}}})}function n(t,e,n,r,s){i.$defineProperty(t,e,{get:n,set:function(t){var e=n.call(this);if(t!==e){r.call(this,t);var i=0==o.length?document.createEvent("Event"):o.pop();i.initEvent(s,!0,!0),i.oldValue=e,i.newValue=t,dispatchEvent(new Event(s,{bubbles:!0,cancelable:!0,scoped:!0})),this instanceof EventTarget?this.dispatchEvent(i):dispatchEvent(i),o.push(i)}}})}function r(t){}var o=[];t.observeProperty=e,t.setObservableProperty=n,i.$defineProperty(Node.prototype,"value",{get:function(){return this.textContent},set:function(t){this.textContent=t}}),e(Node.prototype,"textContent","textContentChanged"),t.ObjectToObservable=r})(_=t.Observable||(t.Observable={})),t.IsClass=p,t.IsPrototype=h,t.IsInstance=d})(r=e.reflection||(e.reflection={}));var o;(function(t){function e(t,e,n){var i=h.get(t);i||h.set(t,i=new Map),i.set(e,n)}function n(t,n){e(t,this,n)}function i(t){return l(t,this)}function o(t,e){t.declare=n,t.getData=i,d.set(t,e)}function s(t){return d.get(t)}function a(t,e){var n=s(t);if(!n)return!0;var i=e[2],o=(e[1],e[0]);switch(n.Target){case p.All:return!0;case p.Class:return r.IsClass(o);case p.Function:return!(!i||"function"!=typeof i.value);case p.Object:return!!r.IsInstance(o);case p.Property:return!!i;default:return!1}}function u(t,e){var n=h.get(t);return n&&n.get(e)}function c(t){return h.get(t)}function l(t,e){var n=u(t,e);if(!n){var i=s(e);if(i&&i.Heritable){var o=r.GetBaseTypes(t,Object);for(var a in o)if(n=u(a,e))return n}}return n}var p;(function(t){t[t.Class=2]="Class",t[t.Object=4]="Object",t[t.Function=8]="Function",t[t.Property=16]="Property",t[t.All=-1]="All"})(p=t.AttributeTargets||(t.AttributeTargets={}));var h=new Map,d=new Map;t.asAttribute=o,t.getAttributeDef=s,t.check=a,t.getAttributesOf=c,t.getAttributeOf=l})(o=e.Attributes||(e.Attributes={}));var s;(function(t){function e(){c=!0;for(var t=l.slice(),e=0,s=0;s<t.length;s++){var a=t[s];a.once&&(l.splice(s-e,1),e++),i.TryCatch(a.owner,a.callback)}c=!1,0!=o.length&&(clearTimeout(r),r=setTimeout(p.start,1),n=!0)}var n=!1,r=-1,o=[],s=[],a=0,u=function(){function t(t,e){this.id=t,this.params=e||[]}return t.prototype.Set=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n,i=t.length-1;i>=0;i--){if(void 0===(n=t[i]))continue;this.params[i]=n}return this},t.prototype.Set1=function(t){for(var e,n=t.length-1;n>=0;n--){if(void 0===(e=t[n]))continue;this.params[n]=e}return this},t.prototype.Clone=function(){var e=new t(this.id);return e.Set1(this.params),e},t}();t.JobParam=u;var c,l=[],p=function(){function t(){}return t.OnIdle=function(t,e,r){c||!n?i.TryCatch(t,e):l.push({owner:t,callback:e,once:1==r})},t.InIdle=function(){return!n},t.GC=function(){for(var t=0,n=s.length;t<n;t++){var i=s[t];i.children.length=0,i.ce=0}o.length=0,a=0,e()},t.clone=function(t,e,n){var i={callback:t.callback,_this:void 0===n?t._this:n,id:t.id,isWaiting:!0,optimizable:!1,params:new u(t.id).Set1(e||t.params.params)};return t.children.push(i),i},t.cretaeJob=function(t,e,n,i){var r={callback:t,params:new u(s.length,e),_this:n,optimizable:i,isWaiting:!1,id:s.length,children:[],ce:0};return s.push(r),r.params},t.Clear=function(t){for(var e=s[t.id],n=e.children,i=e.ce,r=n.length,o=r-1;o>i;o--){var a=n[o];a.isWaiting=!1,a.optimizable=!0}n.length=0,e.ce=0},Object.defineProperty(t,"CurrentJob",{get:function(){return o[a]},enumerable:!0,configurable:!0}),t.start=function(){if(n=!0,0===o.length)return n=!1,void e();c=!1;for(var u=a+Math.min(3,o.length-a);a<u;a++){var l=o[a];if(l.isWaiting&&i.TryCatch(l._this,l.callback,void 0,l.params.params),!l.optimizable){var p=s[l.id];p.ce++}l.isWaiting=!1,o[a]=null}n=a<o.length,n?r=setTimeout(t.start,0):t.GC()},t.Push=function(e,i,a){var u=s[e.id];if(u.optimizable){if(i&&u.params.Set(i),u._this=void 0===a?u._this:a,u.isWaiting)return}else u=this.clone(u,i,a);return u.isWaiting=!0,o.push(u),n||o.length>0&&(clearTimeout(r),r=setTimeout(t.start,0),n=!0,c=!1),u},t.call=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];this.Push(h,[t,e,n])},t.IsRunning=function(){return n},t}();t.Dispatcher=p;var h=t.Dispatcher.cretaeJob(function(t,e,n){e.apply(t,n)},[],null,!1)})(s=e.thread||(e.thread={}));var a;(function(t){function e(t,e,n){if(!t)throw"Argument inst is null";switch(l){case c.Stoped:l=c.Waitting,i();case c.Waitting:p[++h]={ins:t,e:e,scop:n};break;case c.Executing:r({ins:t,e:e,scop:n})}}function n(t){if(!t.method)throw"Argument inst is null";switch(l){case c.Stoped:l=c.Waitting,i();case c.Waitting:p[++h]=t;break;case c.Executing:o(t)}}function i(){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame;e?e(u):s.Dispatcher.OnIdle(t,u,!0)}function r(t){try{var e=t.ins.job;e&&e.Todo&&e.Todo(t.ins,t.e)}catch(t){}}function o(t){try{var e=t;e.method&&e.method.apply(e.owner,e.args)}catch(t){}}function a(t){try{if(t.ins){var e=t.ins.job;e&&e.Todo&&e.Todo(t.ins,t.e)}else{var n=t;n.method&&n.method.apply(n.owner,n.args)}}catch(t){}}function u(){for(l=c.Executing;h>=0;h--)a(p[h]);l=c.Stoped}var c;(function(t){t[t.Stoped=0]="Stoped",t[t.Waitting=1]="Waitting",t[t.Executing=2]="Executing"})(c||(c={}));var l=0,p=new Array(100),h=-1;t.Push=e,t.OnPaint=n})(a=e.PaintThread||(e.PaintThread={}));var u;(function(t){function e(t,e){h.add(e,t),__global.useListenerOrMutation||e.addEventListener("DOMNodeInsertedIntoDocument",t)}function n(t){var e=h.Dispose(t);__global.useListenerOrMutation||t.removeEventListener("DOMNodeInsertedIntoDocument",e)}function r(t,e){var n;if(h.dic.size)for(var i=0;i<t.length;i++){var r=t[i];if("childList"==r.type){n=r.addedNodes;for(var a=0;a<n.length;a++){var u=h.GetAndRemove(n[a]);u&&u.OnNodeLoaded()}}}h.unknown.size&&s.Dispatcher.call(h,h.ReValidate,function(t,e){e.OnNodeLoaded()},o)}function o(){p||a()}function a(){if(0!=d.length)return p=!0,s.Dispatcher.IsRunning()?s.Dispatcher.OnIdle(null,a):void s.Dispatcher.call(null,u)}function u(){for(var t=0;t<d.length;t++)i.TryCatch(void 0,d[t]);d.splice(0,d.length),p=!1}function c(t){t instanceof Function&&(d.push(t),o())}function l(){if(h=new y,__global.useListenerOrMutation){var t=new MutationObserver(r);t.observe(document.body,{childList:!0,subtree:!0})}}var p,h,d=[];t.OnNodeInserted=e,t.RemoveListener=n,t.pushToIdl=c;var f,y=function(){function t(){this.dic=new Map,this.unknown=new Map}return t.prototype.add=function(t,e){var n=this.dic.get(t);if(!n){var i=this.unknown.get(t);if(!i)return window.document.body.contains(t)?this.dic.set(t,e):void this.unknown.set(t,e)}},t.prototype.ReValidate=function(t,e){if(this.unknown)for(var n=this.unknown.entries(),i=n.next();!i.done;i=n.next()){var r=i.value[0],o=i.value[1];window.document.body.contains(r)&&(t(r,o),this.unknown.delete(r))}e&&e()},t.prototype.Remove=function(t){this.dic.delete(t)},t.prototype.GetAndRemove=function(t){var e=this.dic.get(t);return this.dic.delete(t),e},t.prototype.Dispose=function(t){var e=this.dic.get(t)||this.unknown.get(t);return this.dic.delete(t),this.unknown.delete(t),e},t}();(function(e){function n(e){t.pushToIdl(e)}e.OnIdle=n})(f=t.UIDispatcher||(t.UIDispatcher={})),l()})(u=e.Dom||(e.Dom={}));var c;(function(e){var i=function(){function t(t){this.Name=t.toLowerCase()}return t}();e.ITemplate=i;var r=function(t){function e(e,n,i){var r=t.call(this,n)||this;if(null==e)throw"url is null";if(null==n)throw"category is null";return r._Url=e,void 0==i?r:(r.Shadow=i,r)}return __extends(e,t),Object.defineProperty(e.prototype,"Url",{get:function(){return this._Url},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Shadow",{get:function(){return this._Shadow},set:function(t){if(null!=t&&!(t instanceof HTMLElement))throw"shadow is not HTMLElement";this._Shadow=t},enumerable:!0,configurable:!0}),e.prototype.Create=function(){var t=this._Shadow;return null==t?null:t.content.firstElementChild.cloneNode(!0)},e.prototype.Load=function(){},e}(i);e.iTemplate=r;var o;(function(t){t[t.Desktop=0]="Desktop",t[t.Mobile=1]="Mobile",t[t.Tablete=2]="Tablete"})(o=e.Devices||(e.Devices={}));var a=function(){function t(){}return t}();e.NULL=a;var u=new Map,c=function(){function t(t,e){this.Subs={},this.Items={},this.Name=t.toLowerCase(),this.DataType=e}return Object.defineProperty(t.prototype,"DataType",{get:function(){return this._dataType},set:function(t){if(t!=this._dataType&&t){if(this._dataType!=a&&"function"==typeof this._dataType&&t)throw"Conflit types";var e=u.get(this._dataType||a);if(e){var n=e.indexOf(this);n!==-1&&e.splice(n,1)}var e=u.get(t||a);e||u.set(t||a,e=new Array),e.push(this),this._dataType=t}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Root",{get:function(){for(var t=this;t.Parent;)t=t.Parent;return t},enumerable:!0,configurable:!0}),t.prototype.Get=function(t){t="string"==typeof t?t.toLowerCase().split("."):t;var e=this.GetFoder(t,t.length-1);return e&&e.Items[t[t.length-1]]},t.prototype.GetFoder=function(t,e){if(t=t||"","string"==typeof t){if(t=t.trim().toLowerCase(),""==t)return this;t=t.split(".")}for(var n=this,i=0,e=e||t.length-1;i<e;i++){var r=t[i];if(!n)return;switch(r){case"":case".":continue;case"..":n=n.Parent;break;case"/":n=n.Root;default:n=n.Subs[r]}}return n},t.prototype.CreateFolder=function(t,e){t=t||"","string"==typeof t&&(t=t.trim().toLowerCase(),""==t&&(this.DataType=e),t=t.split("."));for(var n=this,i=0,r=t.length;i<r;i++){var o=t[i];if(!n)return;switch(o){case"":case".":continue;case"..":n=n.Parent||n;break;case"/":n=n.Root;default:n=n.Subs[o]||n.AddFolder(o,i==r-1?e:void 0)}}return n},t.prototype.Add=function(t){return this.Subs||(this.Subs={}),this.Items[t.Name]=t,this.Default||(this.Default=t),this},t.prototype.AddFolder=function(e,n){var i=this.Subs[e=e.toLowerCase()];if(i){if(i.DataType){if(n&&i.DataType!=n)throw"Conflit types";return i}return i.DataType=n,i}return this.Subs[e]=i=new t(e,n),i},t.prototype.registerTemplates=function(t,e,n){for(var i,r=(t.getAttribute("name"),t.hasAttribute("type")?n(t.getAttribute("type")):void 0,0);r<t.children.length;r++)i=t.children.item(r),this.Process(i,e,n);return this},t.prototype.registerTemplate=function(t,n,i){var r=i||t.getAttribute("name");if(null==r)return void console.error("template must have a name \r\nfrom :"+n,t);if(t.children.length>1){for(var o=document.createElement("div"),s=t.children,a=0;a<s.length;a++){var u=s.item(a);u.remove(),o.appendChild(u)}t.appendChild(o)}var c;return this.Add(c=new e.iTemplate(n+"#"+i+"+"+r,r,t)),t.hasAttribute("default")&&(this.Default=c),this},t.Get=function(t){return this.Root.Get(t)},t.GetByType=function(t){var e=u.get(t||a);return e&&e[0]},t.GetByName=function(t){var e=this.Root;for(var n in e.Subs)if(n==t)return e.Subs[n];return null},t.Add=function(t,e,n){var i=this.Root.CreateFolder("templates",Object);return i.registerTemplate(t,e,n)},t.New=function(e,n){return new t(e,n)},t.prototype.Register=function(t,e,n,i){var r=this.CreateFolder(t,void 0);return r.registerTemplate(e,n,i)},t.prototype.Process=function(t,e,n){switch(t.tagName){case"TEMPLATE":return this.registerTemplate(t,e);case"DESCRIPTOR":case"TEMPLATES":var i=t.getAttribute("name"),r=t.hasAttribute("type")?n(t.getAttribute("type")):void 0;return this.CreateFolder(i,r).registerTemplates(t,e,n);case"IMPORT":var i=t.getAttribute("name");if(!i)return;var o=this.GetFoder(t.getAttribute("from")||"");return void(o.Subs[i]=o);case"DEBUGGER":return void stop();case"REQUIRE":case"DEBUGGER":return;default:console.error("Tag {"+t.tagName+"} Unresolved")}},t.Root=new t("root",function(){}),t}();e.MvcDescriptor=c;var l=function(){function i(t){if(this.require=t,this._system=new Array,this._pending=0,this.templatesDescrpt=this.getDescriptor("templates",Object),null==t)throw"require argument is null";if(e._Instance)throw"App cannot have more than initializer";e._Instance=this,this.Init()}return Object.defineProperty(i,"Instances",{get:function(){return e._Instance||(e._Instance=new i(t))},enumerable:!0,configurable:!0}),i.prototype.Init=function(){},i.prototype.Dispose=function(){},Object.defineProperty(i.prototype,"System",{get:function(){return this._system},enumerable:!0,configurable:!0}),i.prototype.Add=function(t,e){this.pending++,(e||this.require)("template|"+t.Url,i.gonsuccess,i.gonerror,{_this:this,tmpl:t})},i.SetTypeResolver=function(t,e){i.typeResolvers[t]=e},Object.defineProperty(i.prototype,"pending",{get:function(){return this._pending},set:function(t){if(t<0)throw"pending cannot be less then 0";t!==this._pending&&(this._pending=t,0===t&&i.onfinish(this))},enumerable:!0,configurable:!0}),i.gonsuccess=function(t){var e=this,n=e._this;try{i.MakeAsParsed(t),n.ExcecuteTemplate(e.tmpl.Url,t.html),e.tmpl.OnSuccess&&s.Dispatcher.call(e.tmpl,e.tmpl.OnSuccess,e._this)}catch(t){}n.pending--},i.gonerror=function(t){var e=this;console.error(" Group of templates ["+e.tmpl.Url+"]: error downloading"),e.tmpl&&e.tmpl.OnError&&s.Dispatcher.call(e.tmpl,e.tmpl.OnError,e._this),e._this.pending--},i.html2Template=function(t){var e=document.createElement("template");return e.innerHTML=t,e},i.htmlToElements=function(t){var e=document.createElement("div");return e.innerHTML=t,e},i.prototype.then=function(t){return this.pending<=0?t(this):void i.callbacks.push(t)},i.then=function(t){i.callbacks.push(t)},i.prototype.onfinish=function(){for(var t=i.callbacks;t.length;)t.shift()(this)},i.onfinish=function(t){for(var e=0;e<i.callbacks.length;e++)i.callbacks[e](t)},i.Get=function(t){for(var n=e._Instance.System,i=n.length,r=0;r<i;r++){var o=n[r];if(o.DataType==t)return o}return null},i.prototype.getDescriptor=function(t,e){if(t=t.toLowerCase(),!t&&!e)return this.templatesDescrpt;if(t)var n=c.GetByName(t);return!n&&e&&(n=c.GetByType(e)),n&&n.Name.toLowerCase()!=t.toLowerCase()&&(n=null),n?n.Name===t.toLowerCase()&&n.DataType===e||console.log("Conflit with others template: Name("+t+","+n.Name+")==Type("+e+","+n.DataType+")"):n=c.Root.AddFolder(t,e),n},i.prototype.ExcecuteTemplate=function(t,e,i,r){function o(t){var e=s[t=t];if(null!=e)return e;if(i&&(e=i(t)),!(null!=e&&e instanceof Function||(e=r&&r.context&&r.context.GetType(t)||n.context.GetType(t),void 0!=e&&e instanceof Function)))throw"type "+t+" unresolved";return s[t]=e,e}var s={};this.getDescriptor("templates",Object);c.Root.Process(e,t,o)},i.Register=function(t){var e=t.exports;this.parsed.indexOf(e)===-1&&(e.html.hasAttribute("private")||this.Instances.ExcecuteTemplate(t.url.toString(),e.html,null,e))},i.MakeAsParsed=function(t){this.parsed.push(t)},i.typeResolvers={},i.callbacks=[],i.parsed=[],i}();e.Initializer=l;var p=function(){function t(e){if(this._name="",this._for="",void 0===t._store&&(t._store=new Array),1!=t.fromInside)throw"Access violatile";if(this._view=e,this._name=e.getAttribute("name"),this._for=e.getAttribute("for"),null==this._name)throw"name is null";t._store.Add(this)}return Object.defineProperty(t.prototype,"forType",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"View",{get:function(){return this._view},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"For",{get:function(){return this._for},enumerable:!0,configurable:!0}),t.getTemplates=function(e){for(var n=t._store,i=[],r=n.Count-1;r>=0;r--){var o=n.Get(r);o.forType==e&&i.push(o)}return i},t.createTemplate=function(e){t.fromInside=!0;var n=null;try{n=new t(e)}catch(t){}return t.fromInside=!1,n},t.GetAll=function(e){if(2==arguments.length)var n=t._store;for(var i=[],r=0;r<n.Count;r++){var o=n.Get(r);o._name==e&&i.push(o)}return i},t.Get=function(e,n){for(var i=t._store,r=0;r<i.Count;r++){var o=i.Get(r);if(o._name==e&&n==o._for)return o}return null},t.Foreach=function(e){for(var n=t._store,i=n.Count-1;i>=0;i--){var r=n.Get(i);if(e(r))return}},t.TempplatesPath="./templates/",t.fromInside=!1,t}();e.Template=p})(c=e.mvc||(e.mvc={}))}),define("sys/Dom",["require","exports","sys/Corelib","sys/runtime"],function(t,e,n,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r;(function(t){function e(t){l.register(t)}function i(e){return t.Manager.register(e)}function r(t){return d.Compile(t)}var a=function(){function t(){}return t.OnAttribute=function(t,e){this.lst.push({check:function(n){return n.instance.attribute==t&&n.value==e}})},t.check=function(t){for(var e=0,n=this.lst;e<n.length;e++){var i=n[e];i.check(t)}},t.lst=[],t}();t.debug=a;var u;(function(t){t[t.None=0]="None",t[t.Waitting=1]="Waitting",t[t.Executing=2]="Executing",t[t.Executed=3]="Executed"})(u=t.Stat||(t.Stat={}));var c=function(){function t(e){this.arg=e;var n=this.arg.name=this.name.toUpperCase();DEBUG&&t._store[n]&&console.warn("The component "+n+" was overrided"),t._store[n]=this}return t.get=function(t){return this._store[t]},Object.defineProperty(t.prototype,"name",{get:function(){return this.arg.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"attribute",{get:function(){return this.arg.name},enumerable:!0,configurable:!0}),t.prototype.check=function(t,e){return!0},t.prototype.execute=function(t,e){var i=this.arg,r="function"==typeof i.handler?i.handler:i.target[i.handler],o=r.call(i.target,{node:t,instance:e,Services:this.getServices(i.Serices)})||t,s=o.e.Control,a=t.parent.Control;return s?(s.Parent||(s.Parent=a),s.View!==o.e.dom&&(o.e.dom=n.html.replace(o.e.dom,s.View)),o):o},t.prototype.getServices=function(e){return t.empty},t.prototype.valueParser=function(t){},Object.defineProperty(t.prototype,"priority",{get:function(){return 900719925474e4},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPrimitive",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFinalizer",{get:function(){return!1},enumerable:!0,configurable:!0}),t._store={},t.empty=[],t}(),l=function(){function t(e){this.enumerator=[],this.events={},this.notifies={};var n=e.attributes;e instanceof HTMLElement&&c.get(e.tagName)&&this.enumerator.push(this.ComponentCreator={instance:c.get(e.tagName),manager:this,stat:u.Waitting,value:e});for(var i,r=0;r<n.length;r++){var o=n[r].name;if(0!==o.indexOf("on-"))if(0!==o.indexOf("on:")){if(t._processors.hasOwnProperty(o)){var s=t.getPrcessorByAttribute(o);if(0===o.indexOf("db-")){if(!s)throw new Error("the processor "+o+" is not defined");this.enumerator.push({manager:this,instance:s,value:s.valueParser?s.valueParser(n[r].value):n[r].value,stat:u.Waitting})}else s&&this.enumerator.push({instance:s,value:s.valueParser?s.valueParser(n[r].value):n[r].value,manager:this,stat:u.Waitting})}}else i||this.enumerator.push({manager:this,instance:t.getPrcessorByAttribute("ON:"),value:i={},stat:u.Waitting}),i[o.substr(3)]=n[r].value;else this.events[o.substr(3)]=n[r].value}this.enumerator=this.enumerator.sort(t.orderInstances);
}return t.getPrcessorByName=function(t){for(var e in this._processors)if(this._processors[e].name==t)return this._processors[e]},t.getPrcessorByAttribute=function(t){return this._processors[t]},t.stringIsNullOrWhiteSpace=function(t){return!(t&&t.trim())},t.registerComponent=function(t){new c(t)},t.register=function(t){if(this.stringIsNullOrWhiteSpace(t.attribute))throw new Error("attribute value is null");if(t.check&&"function"!=typeof t.check)throw new Error("check value is not function");if(this.stringIsNullOrWhiteSpace(t.name)&&(t.name=t.attribute),t.attribute=t.attribute.toLowerCase(),t.name=t.name.toLowerCase(),t.priority||(t.priority=++this.maxPriority),this.maxPriority<t.priority&&(this.maxPriority=t.priority),this._processors[t.attribute])throw"processor "+t.attribute+" cannot be re-define ";if(t.isPrimitive=!!t.isPrimitive,t.isFinalizer=!!t.isFinalizer,t.isFinalizer===t.isPrimitive&&t.isFinalizer===!0)throw new Error("invalid arguments isPremitive && isFinalizer set to true");this._processors[t.attribute]=t,this.enumerator.push(t),this.enumerator.sort(this.orderDefs)},t.orderDefs=function(t,e){return!!t.isPrimitive==!!e.isPrimitive?t.priority-e.priority:t.isPrimitive?-1:t.isFinalizer?1:void 0},t.orderInstances=function(e,n){return t.orderDefs(e.instance,n.instance)},t.prototype.getProcessorByAttribute=function(t){for(var e=0,n=this.enumerator;e<n.length;e++){var i=n[e];if(i.instance.attribute==t)return i}},t._processors={},t.enumerator=[],t.maxPriority=0,t}();t.Manager=l;var p=function(){function t(t,e,n){this.e=t,this.parent=e,this.controller=n}return Object.defineProperty(t.prototype,"Scop",{get:function(){return this.e.Scop||this.parent&&this.parent.Scop||this.controller.Scop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Control",{get:function(){return this.e.Control||this.parent&&this.parent.Control||this.controller.CurrentControl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dom",{get:function(){return this.e.dom},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsNew",{get:function(){return this.parent?this.e.Scop!=this.parent.Scop||this.e.Control!=this.parent.Control||0!=this.e.Jobs.length:null!=this.e.Scop||0!=this.e.Jobs.length},enumerable:!0,configurable:!0}),t.prototype.validateE=function(){this.IsNew&&(this.e.Scop=this.Scop)},t.New=function(e,n,i){return new t({dom:e,Scop:null,Control:null,IsNew:!1,Jobs:[]},n,i)},t.Root=function(e,n,i,r){return new t({dom:e,Scop:n,Control:i,IsNew:!1,Jobs:[]},null,r||i.__Controller__)},t.prototype.New=function(e){return new t({dom:e,Scop:null,Control:null,IsNew:!1,Jobs:[]},this,this.controller)},Object.defineProperty(t.prototype,"Depth",{get:function(){return this.parent?this.parent.Depth+1:1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ContinueInto",{get:function(){return this.e.ContinueInto},set:function(t){this.e.ContinueInto=t},enumerable:!0,configurable:!0}),t}();t.Tree=p;var h=function(){function e(){}return e.ParseBinding=function(n){var n=t.Compiler.Compile(n)||n,i=n.e;if(!i.skipProcessing)if(i.Control){var r=o.Content.getData(i.Control.getType());r?r.type!==o.ContentType.premitive&&(i.ContinueInto?e.processComponentChild(n,r):e.processComponentChildren(n,i,r)):e.ExploreTree(n)}else i.ContinueInto?e.ParseBinding(n.New(i.ContinueInto)):e.ExploreTree(n);return n},e.setChild=function(t,e){var n=t.parent.Control,i=e.selector?e.selector(t):t;if(e.IsProperty)return n[e.handler]=i,t.child;if("string"==typeof e.handler)n[e.handler];else{if("function"!=typeof e.handler)throw"Unvalide component handler";var r=e.handler}return r&&r.call(n,i),t.child},e.processComponentChild=function(t,n){var i=e.ParseBinding(t.New(t.ContinueInto));this.setChild({child:i,parent:t},n)},e.processComponentChildren=function(t,n,i){for(var r=Array.prototype.slice.call(t.Dom.childNodes,0),o=0;o<r.length;o++){var s=r[o];s instanceof Element&&this.setChild({child:e.ParseBinding(t.New(s)),parent:t},i)}},e.strTemplate=function(t,e){var i=n.bind.StringScop.GetStringScop(t.wholeText,e.Scop,e.controller);if("string"!=typeof i)return i.AttacheTo(t),e.controller.registerScop(i),i},e.ExploreTree=function(t){for(var n=Array.prototype.slice.call(t.Dom.childNodes,0),i=0;i<n.length;i++){var r=n[i];r instanceof Element?r.hasAttribute("controlled")||this.ParseBinding(t.New(r)):r.constructor===Text&&e.strTemplate(r,t)}},e}();t.TreeWalker=h,t.register=e;var d=function(){function t(){}return t.initEvents=function(t,e){if(e.events){var n;for(var i in e.events)n||(n=new s.events(t)),n.Register(i,e.events[i]);return n}},t.Compile=function(e){var n=e.e.dom;if(n.hasAttribute("debugger"),n.hasAttribute("compiled"))return e;n.setAttribute("compiled","");for(var i=e,r=new l(n),o=0,s=r.enumerator;o<s.length;o++){var a=s[o];a.instance.check&&!a.instance.check(e,a)||(i=a.instance.execute(e,a)||i)}return t.initEvents(e,r),e.e.IsNew=e.Scop!=e.parent.Scop||e.Control!=e.parent.Control,e.validateE(),e.e.Scop||(e.e.Scop=e.parent.Scop||e.controller.Scop),i},t}();t.Compiler=d,t.Register=i,t.Compile=r})(r=e.Processor||(e.Processor={}));var o;(function(t){function e(t){var e=this;if(this.IsProperty)return function(n){return t[e.handler]=n,n};if("string"==typeof this.handler)return t[this.handler];if("function"==typeof this.handler)return this.handler;throw"Unvalide component handler"}var n;(function(t){t[t.premitive=0]="premitive",t[t.multiple=1]="multiple",t[t.signle=2]="signle",t[t.costum=3]="costum"})(n=t.ContentType||(t.ContentType={})),t.Content=function(n){return function(i){n.target=i,t.Content.declare(i,n),n.getHandler||(n.getHandler=e)}},i.Attributes.asAttribute(t.Content,{AllowMultiple:!1,Heritable:!0,Target:i.Attributes.AttributeTargets.Class})})(o=e.attributes||(e.attributes={})),function(t){t.Component=function(e){return function(n){e.target=n,t.Component.declare(n,e),r.Manager.registerComponent(e)}},i.Attributes.asAttribute(t.Component,{AllowMultiple:!1,Heritable:!1,Target:i.Attributes.AttributeTargets.Class})}(o=e.attributes||(e.attributes={})),function(t){t.Event=function(e){return function(n){e||(e={}),e.target=n;var i=t.Event.getData(n);i||t.Event.declare(n,i={}),i[e.name]=e}},i.Attributes.asAttribute(t.Event,{AllowMultiple:!1,Heritable:!1,Target:i.Attributes.AttributeTargets.Class}),t.Event.getEventData=function(e,n){var i=t.Event.getData(e);return i?i[n]:void 0}}(o=e.attributes||(e.attributes={})),function(t){t.Component=function(e){return function(n){e.target=n,t.Component.declare(n,e),r.Manager.registerComponent(e)}},i.Attributes.asAttribute(t.Component,{AllowMultiple:!1,Heritable:!1,Target:i.Attributes.AttributeTargets.Class})}(o=e.attributes||(e.attributes={}));var s;(function(t){var e=function(){function t(t,e){this.events=t,this.interpolation=e}return Object.defineProperty(t.prototype,"dom",{get:function(){return this.events.xx.Dom},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"controller",{get:function(){return this.events.xx.controller},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentScop",{get:function(){return this.events.xx.Scop},enumerable:!0,configurable:!0}),t}();t.EventData=e;var r=function(){function t(t){this.xx=t,this.Name="Events",this.scop=t.Scop}return t.prototype.Todo=function(t,e){throw new Error("Method not implemented.")},t.prototype.Register=function(t,n){this.events||(this.events={});var i=this.events[t],r=new e(this,n);i?i.push(r):(this.events[t]=i=[r],this.xx.Dom.addEventListener(t,this))},t.prototype.getScop=function(t){if(void 0!==t.scop)return t;if(0==t.interpolation.indexOf("."))var e=this.xx.Scop,i=i.substring(1);else var e=this.scop;return t.scop=n.bind.Scop.Create(t.interpolation,e,0,this.xx.controller),t.scop||(t.scop=null),t},t.prototype.handleEvent=function(t){for(var e=this.events[t.type],n=0;n<e.length;n++){var r=this.getScop(e[n]);i.helper.TryCatch(this,this.exec,void 0,[r,this.scop,t])}},t.prototype.exec=function(t,e,i){var r=t.scop,o=r.Value;if(r instanceof n.bind.FunctionCallScop)return r.Invoke();if("function"==typeof o){var s=r.ParentValue;o.call(s,i,t,e,this)}else o instanceof Object&&o.handleEvent&&o.handleEvent(i,t,e,this)},t}();t.events=r})(s=e.help||(e.help={}));var a;(function(t){t[t.NotProcessed=0]="NotProcessed",t[t.Processing=1]="Processing",t[t.Processed=2]="Processed"})(a=e.ProcessStat||(e.ProcessStat={}));var u=function(t){function e(e){var n=t.call(this)||this;return n.scops=[],n._stat=0,n.JCParent=[],n._onCompiled=[],n._onCompiling=[],n.instances=[],e&&n.JCParent.push(e),n}return __extends(e,t),e.prototype.registerScop=function(t){this.scops.push(t)},e.prototype.unregisterScop=function(t){for(var e=0;(e=this.scops.indexOf(t))!=-1;)this.scops.splice(e,1)},e.prototype.OnNodeLoaded=function(){this.ProcessBinding()},Object.defineProperty(e.prototype,"MainControll",{get:function(){return this.JCParent[0]},enumerable:!0,configurable:!0}),e.Attach=function(t,i){var r=new e(t);return r.Scop=i instanceof n.bind.Scop||null==i?i:new n.bind.ValueScop(i),r.View=t.View,r},e.prototype.getStat=function(){return this._stat},Object.defineProperty(e.prototype,"Stat",{set:function(t){t<=this._stat||(this._stat=t,1!==t&&2!==t||this.processEvent(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"processHowEver",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),e.__feilds__=function(){return[e.DPView]},Object.defineProperty(e.prototype,"View",{get:function(){return this.get(e.DPView)},set:function(t){this.set(e.DPView,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OnCompiled",{set:function(t){this._stat>1?t.Invoke.call(t.Owner,this):this._onCompiled.push(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OnCompiling",{set:function(t){this._stat>0?t.Invoke.call(t.Owner,this):this._onCompiling.push(t)},enumerable:!0,configurable:!0}),e.prototype.ViewChanged=function(t){var e=t._new,n=t._old;e!==n&&(n&&(this.unlistenForNodeInsertion(n),n.removeAttribute("controlled")),null!=e&&(e.setAttribute("controlled",""),this.processHowEver||this.implemented(e)?(this.Stat=0,this.ProcessBinding()):this.listenForNodeInsertion(e)))},e.prototype.unlistenForNodeInsertion=function(t,e){e||this.PDispose(),i.Dom.RemoveListener(t)},e.prototype.listenForNodeInsertion=function(t){i.Dom.OnNodeInserted(this,t)},e.prototype.implemented=function(t){return document.body.contains(t)},e.prototype.handleEvent=function(t){var e=this.View;t.srcElement==t.target&&t.currentTarget==e&&(t.preventDefault(),this.unlistenForNodeInsertion(e,!0),this.ProcessBinding(t))},e.prototype.ProcessBinding=function(t){this._stat||(null==this.Scop,i.thread.Dispatcher.Push(e.explorerJob,[this]))},e.pb=function(t){if(!t._stat){t.Stat=1;var e=r.Tree.Root(null,t.Scop,t.CurrentControl,t);null==t.Scop,i.helper.TryCatch(t,r.TreeWalker.ParseBinding,void 0,[e.New(t.View)]),t.Stat=2}},Object.defineProperty(e.prototype,"CurrentControl",{get:function(){return this.JCParent[this.JCParent.length-1]},enumerable:!0,configurable:!0}),e.prototype.CompileChild=function(t,e,n){this.JCParent.push(n);var i=r.Tree.Root(null,e,n,this),o=r.TreeWalker.ParseBinding(i.New(t));return this.JCParent.pop(),o},e.prototype.processEvent=function(t){var e=1===t?this._onCompiling:this._onCompiled,n=e.slice();e.length=0;for(var r=0;r<n.length;r++){var o=n[r];i.helper.TryCatch(o.Owner,o.Invoke,void 0,[this])}},e.prototype.PDispose=function(){var t=this.View;null!=t&&this.unlistenForNodeInsertion(t);for(var e=this.instances.length-1;e>=0;e--)this.instances[e].Dispose();for(var n=0;n<this.scops.length;n++)this.scops[n].Dispose();this.Stat=0,this.instances.length=0},e.prototype.Dispose=function(){var e=this.OnDispose();null!==e&&(this.PDispose(),t.prototype.Dispose.call(this),e||(this.DisposingStat=2))},e.prototype.createJobInstance=function(t,e){var i=e.Scop;if("."==t[0])r=i.GetJob(t.substring(0));else var r=n.bind.GetJob(t);var o=i.AddJob(r,e.Dom);return this.instances.push(o),o},e.DPView=n.bind.DObject.CreateField("View",HTMLElement,null,function(t){return t.__this.ViewChanged(t)},function(t){return t.__this.PDispose()}),e.explorerJob=i.thread.Dispatcher.cretaeJob(e.pb,[null],null,!1),e}(n.bind.DObject);e.Controller=u}),define("sys/UI",["require","exports","sys/Corelib","sys/Filters","context","sys/runtime","sys/Dom"],function(t,e,n,i,r,o,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,u="px",c=Error;(function(t){function e(e,n){var i=new t.TControl(e,n);return i.Parent=t.Desktop.Current,i}var i;(function(t){t[t.Handled=0]="Handled",t[t.Release=-1]="Release",t[t.ByPass=2]="ByPass"})(i=t.KeyboardControllerResult||(t.KeyboardControllerResult={})),t.processHTML=e;var r=(function(){function t(t,e){this.element=t,this.header=e,this.pos1=0,this.pos2=0,this.pos3=0,this.pos4=0,this.closeDragElementHandler={handleEvent:function(t){this.owner.closeDragElement()},owner:this},this.elementDragHandler={handleEvent:function(t){this.owner.elementDrag(t)},owner:this},this.initialize(t,e)}return t.prototype.elementDrag=function(t){t=t||window.event,t.preventDefault(),this.pos1=this.pos3-t.clientX,this.pos2=this.pos4-t.clientY,this.pos3=t.clientX,this.pos4=t.clientY,this.element.style.top=this.element.offsetTop-this.pos2+"px",this.element.style.left=this.element.offsetLeft-this.pos1+"px"},t.prototype.closeDragElement=function(){document.removeEventListener("mouseup",this.closeDragElementHandler),document.removeEventListener("mousemove",this.elementDragHandler)},t.prototype.handleEvent=function(t){t=t||window.event,t.preventDefault(),this.pos3=t.clientX,this.pos4=t.clientY,document.addEventListener("mouseup",this.closeDragElementHandler),document.addEventListener("mousemove",this.elementDragHandler)},t.prototype.initialize=function(t,e){this.Dispose(),this.element=t,this.header=e,this.header.addEventListener("mousedown",this)},t.prototype.Dispose=function(){this.closeDragElement(),this.header.removeEventListener("mousedown",this),this.element=void 0,this.header=void 0},t}(),function(){function e(t){this.Owner=t,this.OnComined=new n.bind.EventListener(0),this.handlers={}}return e.prototype.sort=function(e){function n(t){for(var e=0;t;)e++,t=t.parentElement;return e}function i(t,e){if(t==e)return 0;for(;t;)if(t=t.nextSibling,t==e)return-1;return 1}e.sort(function(e,r){if(!e.target)return-1;if(!r.target)return 1;if(!e.target&&!r.target)return 0;var o,s=e.target instanceof t.JControl?e.target.View:e.target,a=r.target instanceof t.JControl?r.target.View:r.target;return s.contains(a)?1:a.contains(s)?-1:o=n(a)-n(s)>0?1:o<0?-1:i(s,a)})},e.prototype.sort1=function(t){function e(t){for(var e=0;t;)e++,t=t.parentElement;return e}function n(t,e){if(t==e)return 0;for(;t;)if(t=t.nextSibling,t==e)return-1;return 1}t.sort(function(t,i){var r;return t.contains(i)?1:i.contains(t)?-1:r=e(i)-e(t)>0?1:r<0?-1:n(t,i)})},Object.defineProperty(e.prototype,"KeyA",{get:function(){return this._keyA},set:function(t){this._keyA=t,this._keyB=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"KeyB",{get:function(){return this._keyB},set:function(t){return null==this._keyA?(this._keyA=t,void(this._keyB=null)):(this._keyB=t,void this._rise())},enumerable:!0,configurable:!0}),e.prototype.elementInViewport1=function(t){for(var e=t.offsetTop,n=t.offsetLeft,i=t.offsetWidth,r=t.offsetHeight;t.offsetParent;)t=t.offsetParent,e+=t.offsetTop,n+=t.offsetLeft;return e<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&e+r>window.pageYOffset&&n+i>window.pageXOffset},e.prototype.elementInViewport=function(t){if(!this.dom.contains(t))return!1;for(var e=t.offsetTop,n=t.offsetLeft,i=t.offsetWidth,r=t.offsetHeight;t.offsetParent;)t=t.offsetParent,e+=t.offsetTop,n+=t.offsetLeft;var o=this.dom;return e<o.offsetTop+o.offsetHeight&&n<o.offsetLeft+o.offsetWidth&&e+r>o.offsetTop&&n+i>o.offsetLeft},Object.defineProperty(e.prototype,"Cancel",{set:function(t){this._stopEvent=!!t},enumerable:!0,configurable:!0}),e.prototype._rise=function(){var e=this.handlers[this._keyA.key.toUpperCase()]&&this.handlers[this._keyA.key.toUpperCase()][this._keyB.key.toUpperCase()];if(this._stopEvent=!1,e)for(var n=this.sort(e)||0;n<e.length;n++){try{var i=e[n],r=i.target;if(r&&!this.elementInViewport(r instanceof t.JControl?r.View:r))continue;i.Invoke.call(i.Owner||i.target||this.Owner,this,i)}catch(t){}if(this._stopEvent)break}this._stopEvent=void 0,this.OnComined.PInvok(0,[this],this.Owner),this.reset()},e.prototype.reset=function(){this._keyB=null,this._keyA=null},e.prototype.handleEvent=function(t){return t.preventDefault(),!this._pause&&t.ctrlKey?void((t.keyCode>47&&t.keyCode<91||t.keyCode>97&&t.keyCode<123)&&(this.KeyB=t)):void this.reset()},e.prototype.isValid=function(t){if("string"==typeof t){if(1==t.length)return t=t.charCodeAt(0),t>47&&t<91||t>97&&t<123}else if("number"==typeof t)return t>47&&t<91||t>97&&t<123;return!1},e.prototype.On=function(t,e,n,i,r){if(this.isValid(t)&&this.isValid(e)&&"function"==typeof n){t=t.toUpperCase(),e=e.toUpperCase(),!this.handlers[t]&&(this.handlers[t]={});var o=this.handlers[t][e];!o&&(this.handlers[t][e]=o=[]);var s={Invoke:n,Owner:r,target:i};return o.push(s),o.sort(),s}throw"unvalide arguments"},e.prototype.Off=function(t,e,n){if(!this.isValid(t)||!this.isValid(e))throw"unvalide arguments";t=t.toUpperCase(),e=e.toUpperCase();var i=this.handlers[t]&&this.handlers[t][e];if(i){var r=i.indexOf(n);r!==-1&&i.splice(r,1)}},e.prototype.pause=function(){this._pause=!0},e.prototype.resume=function(){this._pause=!1},e.prototype.attachTo=function(t){this.dom&&this.dom.removeEventListener("keyup",this),this.dom=t,this.dom.addEventListener("keyup",this)},e.prototype.stopPropagation=function(){},e}());t.keyCominerEvent=r;var s=function(t){function e(e){var n=t.call(this,e)||this;return n.desk=e,t.prototype.attachTo.call(n,e.View),n}return __extends(e,t),Object.defineProperty(e.prototype,"dom",{get:function(){var t=this.desk.CurrentApp;return(t&&t.CurrentModal||t||this.desk).View},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.attachTo=function(t){},e}(r);t.DesktopKeyboardManager=s;var a=function(){function t(t){this.Desktop=t,this._controllers=[]}return t.prototype.Current=function(){return this._current},t.prototype.GetController=function(t){if(!t)throw"Argument null exception";if(this._current==t)return!0;if(!t)throw"Argument null exception";var e=this._current,n={Controller:t};return!(e&&(e.stackable?e.onStop&&!e.onStop(n):e.onPause&&!e.onPause(n)))&&(t.onResume&&!t.onResume(n)?this.ResumeStack():(e&&(e.stackable||this._controllers.pop()),this._controllers.push(t),!0))},t.prototype.Release=function(t){var e=this._controllers.indexOf(t);if(e==-1)return!1;for(var n=this._controllers.length-e;n-- >=0;){var t=this._controllers[this._controllers.length-1];if(t&&t.onStop&&!t.onStop({Controller:t}))return!1;this._controllers.pop(),this._current=this._controllers[this._controllers.length-1]}return!0},t.prototype.ResumeStack=function(){for(var t,e=this._controllers[this._controllers.length-1];e&&e.onResume&&!e.onResume(t={Controller:e});)this._controllers.pop(),this._current=e=this._controllers[this._controllers.length-1];return!0},t.prototype.Invoke=function(t){for(var e,n=this._controllers.length,r=[void 0];e=e=this._controllers[--n];){r[0]={Controller:e,e:t},o.helper.TryCatch(e,e.invoke,void 0,r);var s=r[0].Result||0;if((s&i.Release)==i.Release&&this.Release(e),(s&i.ByPass)!==i.ByPass)return s}return s||0},t}();t.KeyboardControllerManager=a})(a=e.UI||(e.UI={})),function(t){function e(){this.init=!0,this.initialize(),this.OnFullInitialized()}function i(t){var n=this;if(null!=t&&!this.init)if(t.init)e.call(this);else{var i=this.parent;i&&!i.init&&i._onInitialize.Remove(this._id),t._onInitialize.Add(function(t){if(n.parent!=t)throw"";e.call(n)},this._id)}}var a;(function(t){t[t.keydown=2]="keydown",t[t.keyup=3]="keyup",t[t.keypress=5]="keypress"})(a=t.Events||(t.Events={}));var c=function(t){function e(i){var r=t.call(this,3)||this;return r._view=i,r._onInitialize=new n.bind.EventListener(r,!0),r._display=void 0,r._id=++e.counter,r.init=!1,r._events=0,r._events_={},i&&""===i.id&&(i.id=r._id+""),r._hasValue_()||(r.Value=r),r}return __extends(e,t),e.prototype.getParent=function(){return this.Parent||this._parentScop},e.prototype._OnValueChanged=function(t){},e.prototype.setParent=function(t){if(!this.canBeParent(t))throw null;return t instanceof e?t.Add(this):this._parentScop=t,!0},e.prototype.CombinatorKey=function(t,e,n){return f.Current.KeyCombiner.On(t,e,n,this,this)},e.prototype.SearchParents=function(t){for(var e=this.Parent;e;){if(e instanceof t)return e;e=e.Parent}},e.LoadCss=function(t){var e=document.head,n=document.createElement("link");return n.setAttribute("as","style"),n.rel="stylesheet",n.type="text/css",n.href=t,n.media="all",e.appendChild(n),n},e.__fields__=function(){return[]},Object.defineProperty(e.prototype,"InnerHtml",{get:function(){return this._view.innerHTML},enumerable:!0,configurable:!0}),e.prototype.Float=function(t){this._view.style.cssFloat=0===t?"left":1===t?"initiale":"right"},e.prototype.Clear=function(){this._view.innerHTML=""},Object.defineProperty(e.prototype,"OnInitialized",{set:function(t){this.init?t(this):this._onInitialize.On=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Presenter",{get:function(){return this._presenter||this},set:function(t){this._presenter=t||this},enumerable:!0,configurable:!0}),e.prototype.setAttribute=function(t,e){return this.View.setAttribute(t,e),this},e.prototype.OnKeyDown=function(t){},e.prototype.OnContextMenu=function(t){},e.prototype.OnKeyCombined=function(t,e){},e.prototype.setAttributes=function(t){var e=this.View;for(var n in t)e.setAttribute(n,t[n]);return this},e.prototype.applyStyle=function(){return this._view.classList.add.apply(this._view.classList,arguments),this},e.prototype.disapplyStyle=function(){return this._view.classList.remove.apply(this._view.classList,arguments),this},Object.defineProperty(e.prototype,"Visible",{get:function(){return"none"!=this.View.style.display&&"visible"==this.View.style.visibility},set:function(t){t=t===!0,t!==this._display&&(this._display="none"!==this.View.style.display?this.View.style.display:"",t?this.View.style.display=this._display:this.View.style.display="none")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Wait",{set:function(t){t?this.applyStyle("Wait"):this.disapplyStyle("Wait")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Enable",{get:function(){return"none"!=this.View.style.pointerEvents},set:function(t){this.View.style.pointerEvents=t?"all":"none"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Parent",{get:function(){return this.parent},set:function(t){this.parent=t,i.call(this,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsInit",{get:function(){return this.init},enumerable:!0,configurable:!0}),e.prototype.OnFullInitialized=function(){this._onInitialize.PInvok(this,[this],this)},Object.defineProperty(e.prototype,"OnPaint",{set:function(t){o.PaintThread.OnPaint({args:[this],method:t,owner:this})},enumerable:!0,configurable:!0}),e.prototype.instantanyInitializeParent=function(){return!1},Object.defineProperty(e.prototype,"ToolTip",{set:function(t){this.View.title=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"View",{get:function(){return this._view},enumerable:!0,configurable:!0}),e.prototype._hasValue_=function(){return!1},e.createDiv=function(){return document.createElement("div")},e.prototype.addEventListener=function(t,i,r,o){var s=new n.basic.DomEventHandler(this._view,t,o,e._handle,{jc:this,handle:i,p:r});return s.Start(),s},e._handle=function(t,e,n){n.handle.call(this,n.jc,e,n.p)},e.prototype.AddRange=function(t){for(var e=0,n=t.length;e<n;e++)this.Add(t[e]);return this},e.prototype.Add=function(t){if(null!=t.parent){if(t.parent===this)return;t.parent.Remove(t,!1)}return t=this.getTemplate(t),t.Parent=this,this.View.appendChild(t.View),this},e.prototype.IndexOf=function(t){},e.prototype.Insert=function(t,e){return null!=t.parent&&t.parent.Remove(t,!1),t=this.getTemplate(t),t.Parent=this,this.View.insertChildAtIndex(t.View,e),this},e.prototype.Remove=function(t,e){return t.parent==this&&(t.Parent=null,this.View.contains(t.View)?this.View.removeChild(t.View):null!=t._view.parentNode&&t.View.remove(),e&&t.Dispose(),!0)},e.prototype.getTemplate=function(t){return t},Object.defineProperty(e.prototype,"Id",{get:function(){return this._id},enumerable:!0,configurable:!0}),e.prototype.Dispose=function(){var e=this.OnDispose();null!==e&&(this.parent&&this.parent.Remove(this,!1),null!=this._presenter&&this._presenter!=this&&this._presenter.Dispose(),this._presenter=null,this.Parent=null,this._view=null,this._display=null,this._onInitialize.Dispose(),this._presenter=null,this.parent=null,this.Presenter,n.basic.DomEventHandler.Dispose(this._view),t.prototype.Dispose.call(this),e||(this.DisposingStat=2))},e.prototype.OnHotKey=function(){},Object.defineProperty(e.prototype,"HotKey",{get:function(){return this._hotKey},set:function(t){this.isEventRegistred(a.keyup)||this.registerEvent(a.keypress),this._hotKey=t},enumerable:!0,configurable:!0}),e.prototype.handleEvent=function(t){switch(a[t.type]){case a.keydown:break;case a.keyup:this._hotKey&&this._hotKey.IsPressed(t)&&this.OnHotKey();break;case a.keypress:}},e.prototype.isEventRegistred=function(t){var e="number"==typeof t?t:a[t];if(void 0===e)throw"event is not registred";return this._events/e%1===0},e.prototype.registerEvent=function(t){this._view.addEventListener(a[t],this)},e.toggleClass=function(t,e){t.classList.contains(e)?t.classList.remove(e):t.classList.add(e)},e.prototype.watch=function(t,e,i){var r=this._events_[t];if(!r){var o=s.attributes.Event.getEventData(this.GetType(),t);if(!o)throw"The Event "+t+" is not declared in "+this.GetType().name;this._events_[t]=r=new n.bind.FEventListener(this._events_,o.signliton)}return r.On={Invoke:e,Owner:i},this},e.prototype.notify=function(t,e){var n=this._events_[t];n&&n.PInvok(this._events_,[e],this)},e.prototype.unwatch=function(t,e,n){var i=this._events_[t];i&&(i.Off={Invoke:e,Owner:n})},e.counter=0,e}(n.bind.Scop);t.JControl=c;var p=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),Object.defineProperty(e.prototype,"Children",{get:function(){return this._c||(this._c=[])},enumerable:!0,configurable:!0}),e.prototype.Add=function(t){if(!this.Check(t))throw"Uncompatible";var e;return t instanceof c&&(void 0==(e=t.Presenter)&&(e=t),null!=e.Parent&&e.Parent.Remove(e,!1)),e=this.getTemplate(t),e.Parent=this,e!==t&&(t._presenter=e),this.Children.push(t),this.NativeAdd(e),this.OnChildAdded(t),this},e.prototype.NativeAdd=function(t){t.View.remove(),this.View.appendChild(t.View)},e.prototype.Insert=function(t,e){if(!this.Check(t))throw"Uncompatible";var n;return t instanceof c&&(n=t.Presenter,void 0===n&&(n=t),null!=n.Parent&&n.Parent.Remove(n,!1)),n=this.getTemplate(t),n.Parent=this,this.Children.splice(e,0,t),this.View.insertChildAtIndex(t.View,e),this.OnChildAdded(t),this},e.prototype.Remove=function(t,e){var n=this.Children.indexOf(t);if(n==-1)return!0;var i=t.Presenter;return i.Parent==this&&(i.Parent=null,0!=this.Children.splice(n,1).length&&this.View.removeChild(i.View),!0)},e.prototype.RemoveAt=function(t,e){var n=this.Children[t];if(n){var i=n.Presenter;return i.Parent=null,this.Children.splice(t,1),this.View.removeChild(this.Presenter?i.Presenter.View:i.View),e&&n.Dispose(),!0}},Object.defineProperty(e.prototype,"HasTemplate",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.getTemplate=function(t){return t},e.prototype.OnChildAdded=function(t){},e.prototype.getChild=function(t){return this.Children[t]},e.prototype.IndexOf=function(t){return this.Children.indexOf(t)},Object.defineProperty(e.prototype,"Count",{get:function(){return this.Children.length},enumerable:!0,configurable:!0}),e.prototype.CloneChildren=function(){for(var t=this.Children,e=new Array(t.length),n=0,i=e.length;n<i;n++)e[n]=t[n]},e.prototype.Clear=function(t){for(var e=0,n=this.Count;e<n;e++)this.RemoveAt(0,t)},e.prototype.Dispose=function(){var e=this.OnDispose();null!==e&&(this.Clear(!0),this._c.length=0,this._c=null,t.prototype.Dispose.call(this),e||(this.DisposingStat=2))},e}(c);t.Control=p;var h,d=function(t){vt.AuthStatChanged(t)},f=function(i){function r(){var r=i.call(this,document.body)||this;if(r.KeyCombiner=new t.DesktopKeyboardManager(r),r.apps=new n.collection.List(Object),r.IsSingleton=!0,r.KeyboardManager=new t.KeyboardControllerManager(r),r._keyboardControllers=[],r.focuser=new n.basic.focuser(r.View,!0),r.defaultKeys="jtpneruosdfhgkwl",r.loadApp=o.thread.Dispatcher.cretaeJob(function(t){r.CurrentApp=t},[null],r,!1),e.call(r),null!=vt)throw"";return vt=r,r}__extends(r,i),a=r,r.prototype.WrapPage=function(t){},r.prototype.Logout=function(){this.AuthenticationApp?this.AuthenticationApp.Logout():this.CurrentApp.Logout()},r.prototype.OpenSignin=function(){this.CurrentApp=this.AuthenticationApp},r.ctor=function(){this.DPCurrentApp=n.bind.DObject.CreateField("CurrentApp",Object,null,function(t){t.__this.selectApp(t._old,t._new)}),this.DPCurrentLayout=n.bind.DObject.CreateField("CurrentLayout",c,null,this.prototype._currentLayoutChanged)},r.prototype._currentLayoutChanged=function(t){},r.prototype.selectApp=function(t,e){t&&(this.Remove(t,!1),ct=null,o.helper.TryCatch(t,t.OnDetached)),e?(i.prototype.Add.call(this,e),ct=e,this.CurrentLayout=e&&e.CurrentModal||e,o.helper.TryCatch(e,e.OnAttached)):this.CurrentLayout=this,window.sessionStorage.setItem("app",e&&e.Name)},r.__fields__=function(){return[a.DPCurrentApp,a.DPCurrentLayout]},r.prototype.AuthStatChanged=function(t){t?this.Show(this.AuthenticationApp.RedirectApp):this.Show(this.AuthenticationApp)},r.prototype.initialize=function(){var t=this;document.addEventListener("keydown",this),document.addEventListener("contextmenu",this),this.KeyCombiner.attachTo(this.View),this.KeyCombiner.OnComined.Add(this.OnKeyCombined),this.observer=new n.bind.Observer(this,["CurrentApp","CurrentModal"]),this.observer.OnPropertyChanged(n.bind.Observer.DPValue,function(e,n){t.CurrentLayout=n._new||t.CurrentApp||t})},r.prototype.mouseController=function(t){},Object.defineProperty(r.prototype,"KeyboardController",{get:function(){return this._keyboardController},set:function(t){this._keyboardController=t},enumerable:!0,configurable:!0}),r.prototype.GetKeyControl=function(t,e,n){this.KeyCombiner.pause(),this.KeyboardController={owner:t,invoke:e,params:n}},r.prototype.ReleaseKeyControl=function(){this.KeyCombiner.resume(),this.KeyboardController=null},r.prototype.handleTab=function(t,e){this.focuser.bound=e,this.focuser.focuse(!0,t.shiftKey),t.stopImmediatePropagation(),t.preventDefault()},r.prototype.OnKeyCombined=function(t,e){var n=this.CurrentApp;n&&n.OnKeyCombined(t,e)},r.prototype.OnKeyDown=function(e){(e.ctrlKey&&this.defaultKeys.indexOf(e.key&&e.key.toLowerCase())!=-1||e.altKey&&18==e.keyCode)&&e.preventDefault();var i=this.KeyboardController,r=this.CurrentApp;if(i){var o=i.params.slice();o.unshift(e);var s=i.invoke.apply(this.KeyboardController.owner,o);if((s&t.KeyboardControllerResult.Release)==t.KeyboardControllerResult.Release&&this.ReleaseKeyControl(),(s&t.KeyboardControllerResult.ByPass)!=t.KeyboardControllerResult.ByPass)return}var a=r&&r.CurrentModal;if(e.keyCode>111&&e.keyCode<124&&(e.stopPropagation(),e.preventDefault()),a)return void(a.OnKeyDown(e)?(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()):9===e.keyCode&&this.handleTab(e,a.View));if(114===e.keyCode)return e.ctrlKey?this.CurrentApp.ToggleTitle():this.CurrentApp.OnDeepSearche(),e.preventDefault(),void e.stopPropagation();if(e.keyCode===U.F5)e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),this.CurrentApp.Update();else if(e.keyCode==U.F12){if(e.ctrlKey)return this.Logout(),e.preventDefault(),
e.stopImmediatePropagation(),void e.stopPropagation();r&&r.SelectedPage instanceof t.NavPage&&r.SelectedPage.ToggleNav(),e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation()}else e.ctrlKey&&e.shiftKey&&66==e.keyCode?Date.now()-this.isReq<500?n.Api.RiseApi("Settings",{data:e,callback:function(){}}):this.isReq=Date.now():!e.ctrlKey||112!=e.keyCode&&80!==e.keyCode?(r&&e.ctrlKey&&80===e.keyCode&&this.CurrentApp.OnPrint(),r.OnKeyDown(e)):(r.OnPrint(),e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation())},r.prototype.handleEvent=function(t){switch(t.type){case"keydown":if(93!==t.keyCode)return this.OnKeyDown(t);var e=t,n=t.srcElement,i=n.clientLeft,r=n.clientTop;t={preventDefault:function(){e.preventDefault()},stopPropagation:function(){e.stopPropagation()},x:i,y:r,screenX:i,screenY:r,clientY:r,clientX:i,pageX:i,pageY:r};case"contextmenu":return this.OnContextMenu(t)}},r.prototype.OnContextMenu=function(t){t.preventDefault();var e=this.CurrentApp,n=e&&e.CurrentModal;return n?n.OnContextMenu(t):e?e.OnContextMenu(t):void 0},r.prototype.ShowStart=function(){for(var t=this.apps,e="Select app :",n=null==this.CurrentApp?null:this.CurrentApp.Name,i=0,r=t.Count;i<r;i++)null==n&&(n=t.Get(i).Name),e+="\r        "+t.Get(i).Name;for(var o=prompt(e,null==n?"":n),i=0,r=t.Count;i<r;i++)if(t.Get(i).Name.toLowerCase()==o)return void this.Show(t.Get(i))},Object.defineProperty(r,"Current",{get:function(){return vt},enumerable:!0,configurable:!0}),r.prototype.Check=function(t){return t instanceof Object},r.prototype.Show=function(t){var e=this;h?h.IsLogged(function(t,n){var i=e.CurrentApp;if(t)n=n&&n.IsAuthentication?n.RedirectApp:n;else{if(i&&i.IsAuthentication)return;n!==e.AuthenticationApp&&(e.AuthenticationApp.RedirectApp=n),n=e.AuthenticationApp}if(!n)for(var r=0;r<e.apps.Count;r++){var s=e.apps.Get(r);if(!s||!s.IsAuthentication){n=s;break}}o.thread.Dispatcher.Push(e.loadApp.Set(n))},t):o.thread.Dispatcher.Push(this.loadApp.Set(t))},r.prototype.Add=function(t){return t.IsAuthentication?this.AuthenticationApp=t:this.Register(t),this},r.prototype.Register=function(t){this.apps.IndexOf(t)===-1&&(this.apps.Add(t),t.Parent=this)},Object.defineProperty(r.prototype,"AuthenticationApp",{get:function(){return h},set:function(t){var e=this;if(h||null==t)throw"";h=t,t.OnStatStatChanged.On=function(t,n){n?e.Redirect(t):e.Show(t)}},enumerable:!0,configurable:!0}),r.prototype.Redirect=function(t){this.Show(t.RedirectApp)},r.prototype.OnUsernameChanged=function(t,e){};var a;return r=a=__decorate([s.attributes.Content({handler:a.prototype.WrapPage,type:s.attributes.ContentType.multiple}),__metadata("design:paramtypes",[])],r)}(p);t.Desktop=f;var y=function(t){function e(){return t.call(this,document.createElement("div"))||this}return __extends(e,t),e.prototype.initialize=function(){this.applyStyle("container")},e.prototype.Check=function(t){return t instanceof c},e}(p);t.Container=y;var v;(function(t){t[t.Bar=0]="Bar",t[t.Next=1]="Next",t[t.Prev=2]="Prev"})(v=t.Icons||(t.Icons={}));var g;(function(t){t[t.none=0]="none",t[t.asterisk=1]="asterisk",t[t.plus=2]="plus",t[t.eur=3]="eur",t[t.euro=4]="euro",t[t.minus=5]="minus",t[t.cloud=6]="cloud",t[t.envelope=7]="envelope",t[t.pencil=8]="pencil",t[t.glass=9]="glass",t[t.music=10]="music",t[t.search=11]="search",t[t.heart=12]="heart",t[t.star=13]="star",t[t.starEmpty=14]="starEmpty",t[t.user=15]="user",t[t.film=16]="film",t[t.thLarge=17]="thLarge",t[t.th=18]="th",t[t.thList=19]="thList",t[t.ok=20]="ok",t[t.remove=21]="remove",t[t.zoomIn=22]="zoomIn",t[t.zoomOut=23]="zoomOut",t[t.off=24]="off",t[t.signal=25]="signal",t[t.cog=26]="cog",t[t.trash=27]="trash",t[t.home=28]="home",t[t.file=29]="file",t[t.time=30]="time",t[t.road=31]="road",t[t.downloadAlt=32]="downloadAlt",t[t.download=33]="download",t[t.upload=34]="upload",t[t.inbox=35]="inbox",t[t.playCircle=36]="playCircle",t[t.repeat=37]="repeat",t[t.refresh=38]="refresh",t[t.listAlt=39]="listAlt",t[t.lock=40]="lock",t[t.flag=41]="flag",t[t.headphones=42]="headphones",t[t.volumeOff=43]="volumeOff",t[t.volumeDown=44]="volumeDown",t[t.volumeUp=45]="volumeUp",t[t.qrcode=46]="qrcode",t[t.barcode=47]="barcode",t[t.tag=48]="tag",t[t.tags=49]="tags",t[t.book=50]="book",t[t.bookmark=51]="bookmark",t[t.print=52]="print",t[t.camera=53]="camera",t[t.font=54]="font",t[t.bold=55]="bold",t[t.italic=56]="italic",t[t.textHeight=57]="textHeight",t[t.textWidth=58]="textWidth",t[t.alignLeft=59]="alignLeft",t[t.alignCenter=60]="alignCenter",t[t.alignRight=61]="alignRight",t[t.alignJustify=62]="alignJustify",t[t.list=63]="list",t[t.indentLeft=64]="indentLeft",t[t.indentRight=65]="indentRight",t[t.facetimeVideo=66]="facetimeVideo",t[t.picture=67]="picture",t[t.mapMarker=68]="mapMarker",t[t.adjust=69]="adjust",t[t.tint=70]="tint",t[t.edit=71]="edit",t[t.share=72]="share",t[t.check=73]="check",t[t.move=74]="move",t[t.stepBackward=75]="stepBackward",t[t.fastBackward=76]="fastBackward",t[t.backward=77]="backward",t[t.play=78]="play",t[t.pause=79]="pause",t[t.stop=80]="stop",t[t.forward=81]="forward",t[t.fastForward=82]="fastForward",t[t.stepForward=83]="stepForward",t[t.eject=84]="eject",t[t.chevronLeft=85]="chevronLeft",t[t.chevronRight=86]="chevronRight",t[t.plusSign=87]="plusSign",t[t.minusSign=88]="minusSign",t[t.removeSign=89]="removeSign",t[t.okSign=90]="okSign",t[t.questionSign=91]="questionSign",t[t.infoSign=92]="infoSign",t[t.screenshot=93]="screenshot",t[t.removeCircle=94]="removeCircle",t[t.okCircle=95]="okCircle",t[t.banCircle=96]="banCircle",t[t.arrowLeft=97]="arrowLeft",t[t.arrowRight=98]="arrowRight",t[t.arrowUp=99]="arrowUp",t[t.arrowDown=100]="arrowDown",t[t.shareAlt=101]="shareAlt",t[t.resizeFull=102]="resizeFull",t[t.resizeSmall=103]="resizeSmall",t[t.exclamationSign=104]="exclamationSign",t[t.gift=105]="gift",t[t.leaf=106]="leaf",t[t.fire=107]="fire",t[t.eyeOpen=108]="eyeOpen",t[t.eyeClose=109]="eyeClose",t[t.warningSign=110]="warningSign",t[t.plane=111]="plane",t[t.calendar=112]="calendar",t[t.random=113]="random",t[t.comment=114]="comment",t[t.magnet=115]="magnet",t[t.chevronUp=116]="chevronUp",t[t.chevronDown=117]="chevronDown",t[t.retweet=118]="retweet",t[t.shoppingCart=119]="shoppingCart",t[t.folderClose=120]="folderClose",t[t.folderOpen=121]="folderOpen",t[t.resizeVertical=122]="resizeVertical",t[t.resizeHorizontal=123]="resizeHorizontal",t[t.hdd=124]="hdd",t[t.bullhorn=125]="bullhorn",t[t.bell=126]="bell",t[t.certificate=127]="certificate",t[t.thumbsUp=128]="thumbsUp",t[t.thumbsDown=129]="thumbsDown",t[t.handRight=130]="handRight",t[t.handLeft=131]="handLeft",t[t.handUp=132]="handUp",t[t.handDown=133]="handDown",t[t.circleArrowRight=134]="circleArrowRight",t[t.circleArrowLeft=135]="circleArrowLeft",t[t.circleArrowUp=136]="circleArrowUp",t[t.circleArrowDown=137]="circleArrowDown",t[t.globe=138]="globe",t[t.wrench=139]="wrench",t[t.tasks=140]="tasks",t[t.filter=141]="filter",t[t.briefcase=142]="briefcase",t[t.fullscreen=143]="fullscreen",t[t.dashboard=144]="dashboard",t[t.paperclip=145]="paperclip",t[t.heartEmpty=146]="heartEmpty",t[t.link=147]="link",t[t.phone=148]="phone",t[t.pushpin=149]="pushpin",t[t.usd=150]="usd",t[t.gbp=151]="gbp",t[t.sort=152]="sort",t[t.sortByAlphabet=153]="sortByAlphabet",t[t.sortByAlphabetAlt=154]="sortByAlphabetAlt",t[t.sortByOrder=155]="sortByOrder",t[t.sortByOrderAlt=156]="sortByOrderAlt",t[t.sortByAttributes=157]="sortByAttributes",t[t.sortByAttributesAlt=158]="sortByAttributesAlt",t[t.unchecked=159]="unchecked",t[t.expand=160]="expand",t[t.collapseDown=161]="collapseDown",t[t.collapseUp=162]="collapseUp",t[t.logIn=163]="logIn",t[t.flash=164]="flash",t[t.logOut=165]="logOut",t[t.newWindow=166]="newWindow",t[t.record=167]="record",t[t.save=168]="save",t[t.open=169]="open",t[t.saved=170]="saved",t[t.import=171]="import",t[t.export=172]="export",t[t.send=173]="send",t[t.floppyDisk=174]="floppyDisk",t[t.floppySaved=175]="floppySaved",t[t.floppyRemove=176]="floppyRemove",t[t.floppySave=177]="floppySave",t[t.floppyOpen=178]="floppyOpen",t[t.creditCard=179]="creditCard",t[t.transfer=180]="transfer",t[t.cutlery=181]="cutlery",t[t.header=182]="header",t[t.compressed=183]="compressed",t[t.earphone=184]="earphone",t[t.phoneAlt=185]="phoneAlt",t[t.tower=186]="tower",t[t.stats=187]="stats",t[t.sdVideo=188]="sdVideo",t[t.hdVideo=189]="hdVideo",t[t.subtitles=190]="subtitles",t[t.soundStereo=191]="soundStereo",t[t.soundDolby=192]="soundDolby",t[t.sound$5$1=193]="sound$5$1",t[t.sound$6$1=194]="sound$6$1",t[t.sound$7$1=195]="sound$7$1",t[t.copyrightMark=196]="copyrightMark",t[t.registrationMark=197]="registrationMark",t[t.cloudDownload=198]="cloudDownload",t[t.cloudUpload=199]="cloudUpload";t[t.treeConifer=200]="treeConifer";t[t.treeDeciduous=201]="treeDeciduous",t[t.cd=202]="cd",t[t.saveFile=203]="saveFile",t[t.openFile=204]="openFile",t[t.levelUp=205]="levelUp",t[t.copy=206]="copy",t[t.paste=207]="paste",t[t.alert=208]="alert",t[t.equalizer=209]="equalizer",t[t.king=210]="king",t[t.queen=211]="queen",t[t.pawn=212]="pawn",t[t.bishop=213]="bishop",t[t.knight=214]="knight",t[t.babyFormula=215]="babyFormula",t[t.tent=216]="tent",t[t.blackboard=217]="blackboard",t[t.bed=218]="bed",t[t.apple=219]="apple",t[t.erase=220]="erase",t[t.hourglass=221]="hourglass",t[t.lamp=222]="lamp",t[t.duplicate=223]="duplicate",t[t.piggyBank=224]="piggyBank",t[t.scissors=225]="scissors",t[t.bitcoin=226]="bitcoin",t[t.btc=227]="btc",t[t.xbt=228]="xbt",t[t.yen=229]="yen",t[t.jpy=230]="jpy",t[t.ruble=231]="ruble",t[t.rub=232]="rub",t[t.scale=233]="scale",t[t.iceLolly=234]="iceLolly",t[t.iceLollyTasted=235]="iceLollyTasted",t[t.education=236]="education",t[t.optionHorizontal=237]="optionHorizontal",t[t.optionVertical=238]="optionVertical",t[t.menuHamburger=239]="menuHamburger",t[t.modalWindow=240]="modalWindow",t[t.oil=241]="oil",t[t.grain=242]="grain",t[t.sunglasses=243]="sunglasses",t[t.textSize=244]="textSize",t[t.textColor=245]="textColor",t[t.textBackground=246]="textBackground",t[t.objectAlignTop=247]="objectAlignTop",t[t.objectAlignBottom=248]="objectAlignBottom",t[t.objectAlignHorizontal=249]="objectAlignHorizontal",t[t.objectAlignLeft=250]="objectAlignLeft",t[t.objectAlignVertical=251]="objectAlignVertical",t[t.objectAlignRight=252]="objectAlignRight",t[t.triangleRight=253]="triangleRight",t[t.triangleLeft=254]="triangleLeft",t[t.triangleBottom=255]="triangleBottom",t[t.triangleTop=256]="triangleTop",t[t.console=257]="console",t[t.superscript=258]="superscript",t[t.subscript=259]="subscript",t[t.menuLeft=260]="menuLeft",t[t.menuRight=261]="menuRight",t[t.menuDown=262]="menuDown",t[t.menuUp=263]="menuUp"})(g=t.Glyphs||(t.Glyphs={}));var b=function(e){function i(t,n,i){var r=e.call(this,document.createElement("span"))||this;return r.isIcon=n,n=1==n,r.Type=t,r._view.classList.add("bgr"),r._view.title=i,r}return __extends(i,e),i.AllGlyphs=function(t){for(var e in g)isNaN(e)&&t.Add(new i(g[e],!1))},i.Test=function(){var e=(new t.Div).applyStyle("row");for(var n in g)if(isNaN(n)){var r=new i(g[n],!1).applyStyle("col");e.Add(r),r.ToolTip=n}e.Parent=t.Desktop.Current;var o=document.getElementById("51");return o.appendChild(e.View),e.View.style.fontSize="-webkit-xxx-large",e.View.style.padding="15px",e},i.CreateGlyphDom=function(t,e,n){var r=document.createElement("span");return r.classList.add("glyphicon",i.GetGlyphCSS(t),"bgr"),n&&r.classList.add(n),r.title=e,r},i.GetGlyphCSS=function(t){var e=n.css.toValidCssName(g[t]);return"glyphicon"+(null==e?"":"-"+e)},i.GetIconCSS=function(t){var e=v[t];return"icon-"+(null==e?"":e.toLowerCase())},i.prototype.getStyle=function(){return this.isIcon?i.GetIconCSS(this.v):i.GetGlyphCSS(this.v)},i.prototype.initialize=function(){},Object.defineProperty(i.prototype,"Type",{get:function(){return this.v},set:function(t){null!=this.v&&this.View.classList.remove(this.getStyle()),this.v=t,null!=t&&this.applyStyle("glyphicon",this.getStyle())},enumerable:!0,configurable:!0}),i}(c);t.Glyph=b;var m=function(t){function e(){var e=t.call(this,document.createElement("button"))||this;return e.v=0,e}return __extends(e,t),e.prototype.Focus=function(){this._view.focus()},Object.defineProperty(e.prototype,"Style",{set:function(t){this.View.classList.remove("btn-"+L[this.v].toLowerCase()),this.applyStyle("btn-"+L[t].toLowerCase()),this.v=t},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){this.applyStyle("btn","btn-default"),this.Type="button"},Object.defineProperty(e.prototype,"Text",{get:function(){return this._text&&this._text.textContent},set:function(t){if(t){if(this._text)return void(this._text.textContent=t);this._text=document.createTextNode(t)}else{if(!this._text)return;this._text=null}this.reset()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Content",{get:function(){return this._content},set:function(t){if(this._content)try{this._view.removeChild(this._content)}catch(t){}this._content=t,this.reset()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{set:function(t){this.View.type=t},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.Clear(),this._text&&this._view.appendChild(this._text),this._content&&this._view.appendChild(this._content)},e=__decorate([s.attributes.Content({type:s.attributes.ContentType.signle,IsProperty:!0,handler:"Content",selector:function(t){return t.child.Dom}}),__metadata("design:paramtypes",[])],e)}(c);t.Button=m;var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initialize=function(){this.View;this.AddGlyphs(function(){return!0},v.Bar,v.Bar,v.Bar),t.prototype.initialize.call(this)},e.prototype.AddGlyphs=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=0;i<e.length;i++)this.AddGlyph(e[i],t(i))},e.prototype.AddGlyph=function(e,n){if("number"==typeof e){var i=new b(e,n);return t.prototype.Add.call(this,i),i}return null},e.prototype.Check=function(t){return t instanceof b},Object.defineProperty(e.prototype,"CollapsedZone",{set:function(t){var e=this.View;this.applyStyle("navbar-toggle"),e.setAttribute("data-toggle","collapse"),e.setAttribute("data-target","#"+t.Id),t.applyStyle("collapse")},enumerable:!0,configurable:!0}),e}(m);t.GlyphButton=_;var C=function(t){function e(e,n){var i=t.call(this,"string"==typeof e?document.createElement(e):e)||this;if(n)for(var r=0;r<n.length;r++)i.View.classList.add(n[r]);return i}return __extends(e,t),e.prototype.initialize=function(){},e}(c);t.Dom=C;var w=function(t){function e(e,n){var i,r=t.call(this,i=document.createElement("a"))||this;return null!=n&&"#"!=n&&(i.href=n),null!=e&&(e instanceof c?r.Add(e):e instanceof HTMLElement?i.appendChild(e):"string"==typeof e&&(i.text=e)),r}return __extends(e,t),e.prototype.initialize=function(){},e.prototype.Add=function(e){return this.View.innerHTML="",t.prototype.Add.call(this,e),this},e.prototype.Remove=function(t){return!1},Object.defineProperty(e.prototype,"Text",{get:function(){return this.View.text},set:function(t){this.View.text=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Href",{get:function(){return this.View.href},set:function(t){this.View.href=t},enumerable:!0,configurable:!0}),e}(c);t.Anchore=w;var S=function(t){function e(e){var n,i=t.call(this,n=document.createElement("label"))||this;return n.textContent=e,i}return __extends(e,t),e.prototype.initialize=function(){},Object.defineProperty(e.prototype,"Text",{get:function(){return this.View.textContent},set:function(t){this.View.textContent=t},enumerable:!0,configurable:!0}),e}(c);t.Label=S;var O=function(t){function e(e){var n,i=t.call(this,n=document.createElement("div"))||this;return n.textContent=e,i}return __extends(e,t),e.prototype.initialize=function(){},Object.defineProperty(e.prototype,"Text",{get:function(){return this.View.textContent},set:function(t){this.View.textContent=t},enumerable:!0,configurable:!0}),e}(c);t.Text=O;var x=function(t){function e(e){var n,i=t.call(this,n=document.createElement("input"))||this;return n.type="search",void 0!=e&&(n.value=e),i}return __extends(e,t),e.prototype.Focus=function(){this.View.focus()},e.prototype.initialize=function(){},e.prototype.Add=function(t){return this},e.prototype.Remove=function(t){return!1},Object.defineProperty(e.prototype,"Text",{get:function(){return this.View.value},set:function(t){this.View.value=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PlaceHolder",{get:function(){return this.View.getAttribute("placeholder")},set:function(t){this.View.setAttribute("placeholder",t)},enumerable:!0,configurable:!0}),e}(c);t.Textbox=x;var P;(function(t){t[t.Ordred=0]="Ordred",t[t.UnOrdred=1]="UnOrdred"})(P=t.ListType||(t.ListType={}));var I=function(t){function e(e){var n=t.call(this,document.createElement(void 0===e?"div":0===e?"ol":"ul"))||this;return n._si=-1,n}return __extends(e,t),e.prototype.initialize=function(){var t=this;this._view.addEventListener("keydown",function(e){e.keyCode===U.Down?t.SelectedIndex++:e.keyCode===U.Up&&t.SelectedIndex--})},e.prototype.Check=function(t){return t instanceof c},Object.defineProperty(e.prototype,"HasTemplate",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.getTemplate=function(t){var e=new C("li");if(t instanceof c)e.Add(t);else if(t instanceof HTMLElement)e.View.appendChild(t);else{var n=new w(t,"#");e.Add(n)}return e},e.prototype.AddText=function(t){var e=new T;return e.View.textContent=t,this.Add(e),e},e.prototype.OnChildAdded=function(t){this._si==-1&&(this.SelectedIndex=0)},Object.defineProperty(e.prototype,"SelectedIndex",{get:function(){return this._si},set:function(t){var e=this.getChild(this._si);e&&(e.Presenter?e.Presenter.View.classList.remove("active"):e.Parent&&e.Parent.disapplyStyle("active"));var n=this.getChild(t);n&&(n.Presenter?n.Presenter.applyStyle("active"):n.Parent&&n.Parent.applyStyle("active"))},enumerable:!0,configurable:!0}),e}(p);t.List=I;var D=function(t){function e(e){return t.call(this,"string"==typeof e?document.createElement(e||"div"):e)||this}return __extends(e,t),e.prototype.initialize=function(){},e.prototype.Check=function(t){return t instanceof c},e}(p);t.DivControl=D;var T=function(t){function e(){return t.call(this,document.createElement("div"))||this}return __extends(e,t),e.prototype.initialize=function(){},e.prototype.Check=function(t){return!0},e}(p);t.Div=T;var k=function(e){function n(t,n){var i=e.call(this,document.createElement("div"))||this;return i.App=t,i.autoInitializePanels=n,i.services=[],i._services=[],i.OnClick=i.OnClick.bind(i),i.serviceNotified=i.serviceNotified.bind(i),i}return __extends(n,e),n.prototype.initialize=function(){this.autoInitializePanels&&(this.LeftTabs=this._lefttabs||new A,this.RightTabs=this._righttabs||new A,delete this.autoInitializePanels),this.applyStyle("navbar","navbar-fixed-bottom","appFoot","uncolapsed")},Object.defineProperty(n.prototype,"LeftTabs",{set:function(t){var n=this;this._lefttabs!==t&&(this._lefttabs&&(e.prototype.Remove.call(this,this._lefttabs),this._lefttabs.OnSelectedItem.Remove(this)),t&&(e.prototype.Add.call(this,t),t.OnSelectedItem.Add(function(t){n.OnPageSelected&&n.OnPageSelected(t)},this),t.Float(W.Left)),this._lefttabs=t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"RightTabs",{set:function(t){var n=this;this._righttabs!==t&&(this._righttabs&&(e.prototype.Remove.call(this,this._righttabs),this._righttabs.OnSelectedItem.Remove(this)),t&&(e.prototype.Add.call(this,t),t.OnSelectedItem.Add(function(t){n.OnPageSelected&&n.OnPageSelected(t)},this),t.Float(W.Right)),this._righttabs=t)},enumerable:!0,configurable:!0}),n.prototype.createItem=function(t){var e=new V(t);return e.OnClick=this.OnClick,e},n.prototype.OnClick=function(t){this.OnPageSelected&&this.OnPageSelected(t)},n.prototype.Add=function(t){throw"Not Allowed"},n.prototype.AddRange=function(t){throw"Not Allowed"},n.prototype.Remove=function(t){if(t===this._lefttabs)this.LeftTabs=null;else{if(t!==this._righttabs)throw"Not Allowed";this.RightTabs=null}return!0},n.prototype.serviceNotified=function(t,e){this.App===ht.CurrentApp&&(e===ft.Focuse?this.Push(t):e===ft.UnFocus&&this.Pop(t))},Object.defineProperty(n.prototype,"currentStack",{get:function(){return this.services[this.services.length-1]},enumerable:!0,configurable:!0}),n.prototype.CurrentService=function(){var t=this.services[this.services.length-1];return t?t.Current:null},n.prototype.PushGBar=function(t){this.HideCurrentService(),this.services.push(new q(t)),this.ShowCurrentService()},n.prototype.PopGBar=function(t){this.HideCurrentService(),this.services.pop(),this.Add(t.GetLeftBar())},n.prototype.ExitBar=function(){this.HideCurrentService(),this.currentStack.Exit(),this.ShowCurrentService()},n.prototype.PushBar=function(t){this.HideCurrentService(),this.currentStack.Push(t),this.ShowCurrentService()},n.prototype.PopBar=function(){this.HideCurrentService(),this.currentStack.Pop(),this.ShowCurrentService()},n.prototype.HideCurrentService=function(){var t=this.currentStack;if(t){var e=t.Current.GetLeftBar(),n=t.Current.GetRightBar();e&&(e instanceof A?this.LeftTabs=null:this.Remove(e)),n&&(n instanceof A?this.RightTabs=null:this.Remove(n))}},n.prototype.ShowCurrentService=function(){var e=this.currentStack;if(e){var n=e.Current.GetLeftBar(),i=e.Current.GetRightBar();t.MenuItem,n&&(n instanceof A?this.LeftTabs=n:this.Add(n)),i&&(i instanceof A?this.RightTabs=i:this.Add(i)),this.Visible=null!=n||null!=i}},n.prototype.Push=function(t){if(t&&t!==this.CurrentService()){this.HideCurrentService();var e=this.CurrentService();if(e&&e.ServiceType==yt.Instantany&&this.currentStack.Pop(),t.ServiceType==yt.Main)this.services.push(new q(t));else{var n=this.currentStack;null==n?this.services.push(new q(t)):this.currentStack.Push(t)}this.ShowCurrentService()}},n.prototype.Has=function(t){for(var e,n=this.services,i=n.length,r=i-1;r>=0;r--){var o=n[r];if(0!==(e=o.Has(t)))return{stack:i-r+(e===-1?0:-1),serv:e}}return null},n.prototype.Pop=function(t){if(this.HideCurrentService(),t){var e=this.Has(t);if(e){for(;e.stack>0;)this.services.pop(),e.stack--;for(var n=this.currentStack;e.serv>0;)n.Pop(),e.serv--}}else{var i=this.CurrentService();i&&(i.ServiceType===yt.Main?this.services.pop():this.currentStack.Pop())}this.ShowCurrentService()},n.prototype.Register=function(t){t.Handler&&!t.Handled()&&(t.Handler.addEventListener("pointerenter",function(e){ht.CurrentApp.Foot.Push(t)}),t.Handler.addEventListener("pointerout",function(e){ht.CurrentApp.Foot.Pop(t)})),t.Notify&&(t.Notify.On=this.serviceNotified)},n}(c);t.ServiceNavBar=k;var A=function(t){function e(){var e=t.call(this)||this;return e._items=new n.collection.ExList(Object),e.oicd={Owner:e,Invoke:e.ItemsChanged},e.selectable=!0,e.OnSelectedItem=new n.bind.EventListener(e),e}return __extends(e,t),e.prototype.initialize=function(){t.prototype.initialize.call(this),this.onClick=this.onClick.bind(this),this.applyStyle("nav","navbar-nav"),this._items.Listen=this.oicd,this.ItemsChanged(n.utils.ListEventArgs.ResetEvent)},e.prototype.ItemsChanged=function(t){if(this.IsInit!==!1){var e=this,i=this._items;switch(t.event){case n.collection.CollectionEvent.Added:e.Add(this.createItem(t.newItem));break;case n.collection.CollectionEvent.Cleared:this.CClear(e);break;case n.collection.CollectionEvent.Removed:for(var r=0,o=e.Count;r<o;r++){var s=e.getChild(r);if(s.Source==t.oldItem){e.RemoveAt(r+1,!0);break}}break;case n.collection.CollectionEvent.Replace:for(var r=0,o=e.Count;r<o;r++){var s=e.getChild(r);if(s.Source==t.oldItem){e.RemoveAt(r+1,!0);break}}e.Add(new V(t.newItem));break;case n.collection.CollectionEvent.Reset:this.CClear(e);for(var r=0,o=i.Count;r<o;r++){var s=i.Get(0);e.Add(new V(s))}}}},e.prototype.createItem=function(t){var e=new V(t);return e.OnClick=this.onClick,e},Object.defineProperty(e.prototype,"SelectedItem",{get:function(){return this._selectedItem},enumerable:!0,configurable:!0}),e.prototype.onClick=function(t,e){if(null!=this._selectedItem){var n=this._selectedItem.Presenter;n.disapplyStyle("active")}if(null!=e){var n=e.Presenter;this._selectedItem=e,n.applyStyle("active")}this.selectable||setTimeout(function(t,e){return e.Presenter.disapplyStyle("active")},500,this,e),this.OnSelectedItem.Invok(this,function(e){return e(t)})},e.prototype.Float=function(t){t==W.Right?(this.disapplyStyle("pull-left"),this.applyStyle("pull-right")):t==W.Left?(this.applyStyle("pull-left"),this.disapplyStyle("pull-right")):(this.disapplyStyle("pull-left"),this.disapplyStyle("pull-right"))},e.prototype.CClear=function(t){for(var e=2,n=t.Count;e<n;e++)t.RemoveAt(e,!0)},Object.defineProperty(e.prototype,"Items",{get:function(){return this._items},enumerable:!0,configurable:!0}),e}(I);t.Navbar=A;var E=function(t){function e(){return t.call(this,document.createElement("div"))||this}return __extends(e,t),Object.defineProperty(e.prototype,"Title",{get:function(){return this._brand.Text},set:function(t){this._brand.Text=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Brand",{get:function(){return this._brandContainer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ToggleButton",{get:function(){return this._toggleButton},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){this.View;this.applyStyle("navbar-header"),this._brand=new w("QShop","#"),this._brandContainer=new T,this._brandContainer.Add(this._brand),this._brandContainer.applyStyle("navbar-brand"),n.bind.NamedScop.Create("GlobalPatent",{});this._toggleButton=new _;this.Add(this._brandContainer),this.Add(this._toggleButton)},Object.defineProperty(e.prototype,"IsFixedTop",{set:function(t){t?this.applyStyle("navbar-fixed-top"):this.View.classList.remove("navbar-fixed-top")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsHeader",{set:function(t){t?this.applyStyle("navbar-header"):this.View.classList.remove("navbar-header")},enumerable:!0,configurable:!0}),e}(c);t.NavbarHeader=E;var V=function(t){function e(e){var n=t.call(this,e.Content,e.Url)||this;return n.Source=e,n.View.addEventListener("click",n),n}return __extends(e,t),e.prototype.propChanged=function(t,e){e.prop==K.DPTitle?this.Text=e._new:e.prop==K.DPUrl&&(this.Href=e._new)},e.prototype.handleEvent=function(t){this.OnClick&&this.OnClick(this.Source,this),this.Source.OnItemSelected(this)},e.prototype.Dispose=function(){var e=this.OnDispose();null!==e&&(this.View.removeEventListener("click",this),this.Source=null,this.OnClick=null,t.prototype.Dispose.call(this),e||(this.DisposingStat=2))},e}(w);t.MenuItem=V;var R=function(t){function e(e){return t.call(this,e||document.createElement("div"))||this}return __extends(e,t),e.prototype.initialize=function(){},Object.defineProperty(e.prototype,"Content",{get:function(){return this._content},set:function(t){this._content!=t&&(this._content&&this.Remove(this._content),this._content=t,t&&this.Add(t))},enumerable:!0,configurable:!0}),e.prototype.OnKeyDown=function(t){return this._content&&this._content.OnKeyDown(t)},e.prototype.OnContextMenu=function(t){return this._content&&this._content.OnContextMenu(t)},e=__decorate([s.attributes.Content({IsProperty:!0,selector:function(t){return t.child.Control},handler:"Content",type:s.attributes.ContentType.signle}),__metadata("design:paramtypes",[HTMLElement])],e)}(c);t.ContentControl=R;var L;(function(t){t[t.Default=0]="Default",t[t.Primary=1]="Primary",t[t.success=2]="success",t[t.Info=3]="Info",t[t.Warning=4]="Warning",t[t.Danger=5]="Danger",t[t.Link=6]="Link",t[t.Block=7]="Block"})(L=t.ButtonStyle||(t.ButtonStyle={}));var j=function(e){function n(t){return e.call(this,t||document.createElement("input"))||this}return __extends(n,e),n.prototype.Disable=function(t){for(var e=$("input",this._view),n=0;n<e.length;n++)e[n].disabled=t},n.prototype.initialize=function(){this.applyStyle("input","form-control"),this._view instanceof HTMLInputElement&&(this._view.addEventListener("focusout",this),this._view.addEventListener("focusin",this))},Object.defineProperty(n.prototype,"Placeholder",{set:function(t){this.View.placeholder=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Text",{get:function(){return this.View.value},set:function(t){this.View.value=t},enumerable:!0,configurable:!0}),n.prototype.Blur=function(){this._view&&this._view.blur()},n.prototype.handleEvent=function(t){"focusout"===t.type?this.OnFocusOut(t):"focusin"===t.type&&this.OnFocusIn(t)},n.prototype.OnFocusIn=function(e){t.Desktop.Current.GetKeyControl(this,this.OnKeyPressed,[])},n.prototype.OnKeyPressed=function(e){return 27!=e.keyCode&&13!=e.keyCode||this.Blur(),t.KeyboardControllerResult.Handled},n.prototype.OnFocusOut=function(e){t.Desktop.Current.ReleaseKeyControl()},n}(c);t.Input=j;var M;(function(t){t[t.None=0]="None",t[t.Validated=1]="Validated",t[t.Instantany=2]="Instantany",t[t.NoSearch=3]="NoSearch"})(M=t.SearchActionMode||(t.SearchActionMode={}));var N=function(t){function e(e){var i=t.call(this,document.createElement("div"))||this;return i.OnAction=new n.bind.EventListener(i.Id),i.ia=0,i.tout=-1,i.job=o.thread.Dispatcher.cretaeJob(i.txtChanged,[null],i,!0),i.ls="",i.txtInput=new j(e),i}return __extends(e,t),Object.defineProperty(e.prototype,"Box",{get:function(){return this.txtInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Icon",{get:function(){return this.btn_ok},enumerable:!0,configurable:!0}),e.prototype.Bur=function(){this.txtInput.Blur()},e.prototype.initialize=function(){this.applyStyle("csTB","input-group");var t=(new m).applyStyle("form-control","glyphicon","glyphicon-search");t.Style=L.Primary,t.Text="";var e=new C("span");e.applyStyle("input-group-btn");var n=this.txtInput;n.ToolTip="Entrer you email",n.Placeholder="Entrer you email",this.Add(n),this.Add(e),e.Add(t),this.btn_ok=t,this.txtInput=n,this.btnClicked=this.btnClicked.bind(this),t.View.addEventListener("click",this.btnClicked)},Object.defineProperty(e.prototype,"AutoAction",{get:function(){return this.ia},set:function(t){if(t!=this.ia){switch(t){case 3:case 0:this.txtInput.View.removeEventListener("change",this),this.txtInput.View.removeEventListener("keyup",this);break;case 1:this.txtInput.View.addEventListener("change",this),this.txtInput.View.removeEventListener("keyup",this);break;case 2:this.txtInput.View.removeEventListener("change",this),this.txtInput.View.addEventListener("keyup",this)}this.txtInput.View[t?"addEventListener":"removeEventListener"]("change",this);this.ia=t}},enumerable:!0,configurable:!0}),e.prototype.btnClicked=function(t){var e=this.txtInput.Text,n=this.ls;this.ls=e;var i=this;this.OnAction.Invok(this.Id,function(t){t(i,n,e)})},e.prototype.txtChanged=function(t){var e=this.txtInput.Text,n=this.ls;if(e!=n){this.ls=e;var i=this;this.OnAction.Invok(this.Id,function(t){t(i,n,e)})}},e.prototype.handleEvent=function(e){var n=this;switch(e.type){case"click":this.txtChanged(e);break;case"change":if(e.srcElement===this.txtInput.View)return this.txtChanged(e);break;case"keyup":if(e.srcElement===this.txtInput.View){if(this.isExecuting)return;return this.isExecuting=!0,void(this.tout=setTimeout(function(t,i){n.isExecuting=!1,t.txtChanged(e)},500,this,e))}default:t.prototype.handleEvent.call(this,e)}},Object.defineProperty(e.prototype,"Text",{get:function(){return this.txtInput.View.value},set:function(t){this.txtInput.View.value=t},enumerable:!0,configurable:!0}),e.prototype.Focus=function(){this.Box.View.focus()},e}(c);t.ActionText=N;var F=function(){function t(t,e,n,i){this.Tag=t,this.Content=e,this.Url=n,this.onselect=i,this.Content=new w(e)}return t.prototype.OnPropertyChanged=function(t,e){},t.prototype.OnItemSelected=function(t){this.onselect&&this.onselect.Invoke.call(this.onselect.Owner,t)},t}();t.CItem=F;var B=function(t){function e(e){var n=t.call(this,document.createElement("ul"))||this;return n.top=e,n.OnClick=n.OnClick.bind(n),n}return __extends(e,t),Object.defineProperty(e.prototype,"LeftTabs",{set:function(t){var e=this;this._lefttabs&&(this._colapsedZone.Remove(this._lefttabs,!1),
this._lefttabs.OnSelectedItem.Remove(this)),t&&(this._colapsedZone.Add(t),t.OnSelectedItem.Add(function(t){e.OnPageSelected&&e.OnPageSelected(t)},this)),this._lefttabs=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RightTabs",{set:function(t){var e=this;this._righttabs&&(this._colapsedZone.Remove(this._righttabs,!1),this._righttabs.OnSelectedItem.Remove(this)),t&&(this._colapsedZone.Add(t),t.OnSelectedItem.Add(function(t){e.OnPageSelected&&e.OnPageSelected(t)},this),t.Float(W.Right)),this._righttabs=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Header",{get:function(){return this._header},enumerable:!0,configurable:!0}),e.prototype.createItem=function(t){var e=new V(t);return e.OnClick=this.OnClick,e},e.prototype.initialize=function(){var t=this;this.bi=!0,this.applyStyle("navbar",this.top?"navbar-fixed-top":"navbar-fixed-bottom"),this._header=new E,this._container=new T,this._colapsedZone=new C("div").applyStyle("collapse","navbar-collapse"),this.Add(this._container.AddRange([this._header,this._colapsedZone])),this.bi=!1,this._header.OnInitialized=function(e){return e.ToggleButton.CollapsedZone=t._colapsedZone},this._header.ToggleButton.addEventListener("click",function(t,e,n){return n.Open()},this)},e.prototype.Open=function(t){var e=this._colapsedZone.View.classList;e[(void 0==t?e.contains("in"):!t)?"remove":"add"]("in")},e.prototype.OnClick=function(t){this.OnPageSelected&&this.OnPageSelected(t)},e.prototype.Add=function(e){return this.bi?t.prototype.Add.call(this,e):this._colapsedZone.Add(e),this},e.prototype.Remove=function(t){return this._colapsedZone.Remove(t)},e}(c);t.QBar=B;var z=function(t){function e(e){var n=t.call(this,document.createElement("ul"))||this;return n.top=e,n.OnClick=n.OnClick.bind(n),n}return __extends(e,t),Object.defineProperty(e.prototype,"Menu",{get:function(){return this._tabs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SubsMenu",{get:function(){return this._tabs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Header",{get:function(){return this._header},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Container",{get:function(){return this._container},enumerable:!0,configurable:!0}),e.prototype.createItem=function(t){var e=new V(t);return e.OnClick=this.OnClick,e},e.__fields__=function(){return[this.DPSelectedItem]},e.prototype.Clear=function(){this._tabs.Clear(),this._stabs.Clear()},e.prototype.CClear=function(t){for(var e=2,n=t.Count;e<n;e++)t.RemoveAt(e,!0)},e.prototype.initialize=function(){var t=this;this._header=new E,this._container=new T,this._colapsedZone=new C("div").applyStyle("collapse","navbar-collapse"),this._tabs=new A,this._stabs=new A,this._stabs.Float(W.Right),this._stabs.OnSelectedItem.Add(function(e){return t.SelectedItem=e},this),this._tabs.OnSelectedItem.Add(function(e){return t.SelectedItem=e},this),this.Add(this._container.AddRange([this._header,this._colapsedZone.AddRange([this._tabs])])),this._header.OnInitialized=function(e){return e.ToggleButton.CollapsedZone=t._colapsedZone},this._header.ToggleButton.addEventListener("click",function(t,e,n){var i=n._colapsedZone.View.classList;i[i.contains("in")?"remove":"add"]("in")},this)},e.prototype.OnClick=function(t){this.SelectedItem=t},e.DPSelectedItem=n.bind.DObject.CreateField("SelectedItem",Object),e}(c);t.Head=z;var G=function(t){function e(){return t.call(this,document.createElement("div"))||this}return __extends(e,t),e.prototype.initialize=function(){this.applyStyle("navbar","navbar-fixed-bottom"),this.View.style.width="100%"},e.prototype.Check=function(t){return t instanceof c},e}(c);t.Foot=G;var U;(function(t){t[t.Enter=13]="Enter",t[t.Tab=9]="Tab",t[t.Esc=27]="Esc",t[t.Escape=27]="Escape",t[t.Up=38]="Up",t[t.Down=40]="Down",t[t.Left=37]="Left",t[t.Right=39]="Right",t[t.PgDown=34]="PgDown",t[t.PageDown=34]="PageDown",t[t.PgUp=33]="PgUp",t[t.PageUp=33]="PageUp",t[t.End=35]="End",t[t.Home=36]="Home",t[t.Insert=45]="Insert",t[t.Delete=46]="Delete",t[t.Backspace=8]="Backspace",t[t.Space=32]="Space",t[t.Meta=91]="Meta",t[t.Win=91]="Win",t[t.Mac=91]="Mac",t[t.Multiply=106]="Multiply",t[t.Add=107]="Add",t[t.Subtract=109]="Subtract",t[t.Decimal=110]="Decimal",t[t.Divide=111]="Divide",t[t.Scrollock=145]="Scrollock",t[t.Pausebreak=19]="Pausebreak",t[t.Numlock=144]="Numlock",t[t["5numlocked"]=12]="5numlocked",t[t.Shift=16]="Shift",t[t.Capslock=20]="Capslock",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.AltLeft=18]="AltLeft",t[t.AltRight=18]="AltRight",t[t.ShiftLeft=18]="ShiftLeft",t[t.ShiftRight=18]="ShiftRight",t[t.ControlLeft=17]="ControlLeft",t[t.ControlRight=17]="ControlRight",t[t.MetaLeft=91]="MetaLeft",t[t.MetaRight=91]="MetaRight"})(U=t.Keys||(t.Keys={}));var H;(function(t){t[t.Alt=18]="Alt",t[t.Shift=16]="Shift",t[t.Control=17]="Control",t[t.Meta=91]="Meta"})(H=t.Controlkeys||(t.Controlkeys={}));var J=function(){function t(){}return Object.defineProperty(t.prototype,"Key",{get:function(){return this._key},set:function(t){if(void 0===U[t])throw"controls key is uncorrect";this._key=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Control",{get:function(){return this.__ctrl},set:function(t){if(void 0===H[t])throw"controls key is uncorrect";this.__ctrl=t},enumerable:!0,configurable:!0}),t.prototype.IsPressed=function(t){return this.checkKey(t)&&this.checkControl(t)},t.prototype.checkKey=function(t){var e=this.Key;return null==e||t.keyCode==e},t.prototype.checkControl=function(t){switch(this.Control){case 18:return t.altKey;case 16:return t.shiftKey;case 17:return t.ctrlKey;case 91:return t.metaKey}return!0},t}();t.HotKey=J;var K=function(t){function e(e,i,r){var o=t.call(this,document.createElement("div"))||this;return o.app=e,o.Name=r,o._fl=!0,o.ServiceType=yt.Main,o.Notify=new n.bind.EventListener(o),o._onSelected=new n.bind.EventListener(o,!1),o.Content=i,o}return __extends(e,t),e.prototype.Callback=function(t){},Object.defineProperty(e.prototype,"FloatLeft",{get:function(){return this._fl},set:function(t){this._fl=t},enumerable:!0,configurable:!0}),e.prototype.getDPTitle=function(){return e.DPTitle},e.prototype.getDPUrl=function(){return e.DPUrl},Object.defineProperty(e.prototype,"Content",{get:function(){return this.get(e.DPTitle)},set:function(t){this.set(e.DPTitle,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Url",{get:function(){return this.get(e.DPUrl)},set:function(t){this.set(e.DPUrl,t)},enumerable:!0,configurable:!0}),e.__fields__=function(){return[e.DPTitle,e.DPUrl]},e.prototype.getSuggessions=function(){return lt},e.prototype.OnSearche=function(t,e){},e.prototype.initialize=function(){},e.prototype.Update=function(){},Object.defineProperty(e.prototype,"intern",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.Check=function(t){return this.intern&&t instanceof c},e.prototype.Dispose=function(){this.Parent.Remove(this),n.bind.DObject.prototype.Dispose.call(this)},e.prototype.GetLeftBar=function(){return null},e.prototype.GetRightBar=function(){return null},e.prototype.OnItemSelected=function(t){var e=this;this.OnSelected.Invok(this,function(t){return t(e)})},Object.defineProperty(e.prototype,"OnSelected",{get:function(){return this._onSelected},enumerable:!0,configurable:!0}),e.prototype.Handled=function(){return!0},e.prototype.OnKeyCombined=function(t,e){var n=this.Content;if(n instanceof c)return n.OnKeyCombined(t,e)},e.prototype.OnKeyDown=function(t){if(this.Content instanceof c)return this.Content.OnKeyDown(t)},e.prototype.OnPrint=function(){},e.prototype.OnDeepSearche=function(){},e.prototype.OnContextMenu=function(t){if(this.Content instanceof c&&this.Content.OnContextMenu(t))return!0;if(this.ContextMenu)return this.ContextMenu.Show(t.pageX,t.pageY),!0},e.DPTitle=e.CreateField("Title",Object,"Page",function(t){t.__this}),e.DPUrl=e.CreateField("Url",String,"#"),e}(p);t.Page=K;var q=function(){function t(t){this.others=[],this._current=t}return Object.defineProperty(t.prototype,"Current",{get:function(){return 0==this.others.length?this._current:this.others[this.others.length-1]},enumerable:!0,configurable:!0}),t.prototype.Push=function(t){this.others.push(t)},t.prototype.Pop=function(){return this.others.pop()},t.prototype.Has=function(t){var e=this.others,n=e.length;if(this._current==t)return-1;for(var i=n-1;i>=0;i--){var r=e[i];if(r==t)return n-i}return 0},t.prototype.Exit=function(){this.others.length=0},t}();t.BarStack=q;var W;(function(t){t[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right"})(W=t.HorizontalAlignement||(t.HorizontalAlignement={}));var X;(function(t){t[t.Top=0]="Top",t[t.Center=1]="Center",t[t.Bottom=2]="Bottom"})(X=t.VerticalAlignement||(t.VerticalAlignement={}));var Z=function(){function t(t,e){this.x=t,this.y=e}return t}();t.Point=Z;var Q,Y=["px","%","in","em"];(function(t){t[t.Pixel=0]="Pixel",t[t.Percentage=1]="Percentage",t[t.Inch=2]="Inch",t[t.Em=3]="Em"})(Q=t.MetricType||(t.MetricType={}));var tt=function(){function t(t,e){"string"==typeof t?this.fromString(t):(this.Value=t,this.Type=e)}return t.prototype.minus=function(e){return this.Type==Q.Pixel?new t(this.Value-e,Q.Pixel):this.Type==Q.Percentage?new t(this.Value-e,Q.Percentage):this.Type==Q.Em?new t(this.Value-e,Q.Em):this.Type==Q.Inch?new t(this.Value-e,Q.Inch):void 0},t.prototype.toString=function(){return this.Value+Y[this.Type||0]},t.prototype.fromString=function(t){for(var e=0;e<Y.length;e++)if(t.endsWith(Y[e]))return this.Value=parseFloat(t),void(this.Type=e)},t}();t.Metric=tt;var et=function(t){function e(){return t.call(this,document.createElement("div"))||this}return __extends(e,t),Object.defineProperty(e.prototype,"Message",{get:function(){return this._text},set:function(t){this._text=t,this.container&&(this.container.textContent=t)},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){this.applyStyle(this.IsInfo?"webix_info":"webix_error"),this.container=document.createElement("div"),this.container.innerHTML=this._text,this._view.appendChild(this.container),this._view.addEventListener("mousedown",this)},e.prototype.handleEvent=function(e){"mousedown"==e.type?(this._view.removeEventListener("mousedown",this),this.Pop()):t.prototype.handleEvent.call(this,e)},e.prototype.Push=function(){it.Default.Add(this),this.timeout=setTimeout(function(t){t.Pop()},this.Expire||3e3,this)},e.prototype.Pop=function(){this.applyStyle("ihidden");var t={};clearTimeout(this.timeout),t.id=setTimeout(function(t,e){clearTimeout(e.id),it.Default.Remove(t),t.Dispose()},2e3,this,t)},e.prototype.Dispose=function(){this.container=null,this._text=null,t.prototype.Dispose.call(this)},e}(c);t.Error=et;var nt,it=function(t){function e(){var e=t.call(this,document.createElement("div"))||this;return e.initialize(),e}return __extends(e,t),Object.defineProperty(e,"Default",{get:function(){return nt||(nt=new e,nt.Parent=f.Current),nt},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){this.applyStyle("webix_message_area"),document.body.appendChild(this._view)},e.prototype.Check=function(t){return t instanceof et},e.push=function(t,e,n){var i=new et;i.Message=t,i.IsInfo=e,i.Expire=n,i.Push()},e}(p);t.InfoArea=it;var rt=function(){function t(t,e){"number"==typeof t||"string"==typeof t?this.w=new tt(t,0):this.w=t,"number"==typeof e||"string"==typeof e?this.h=new tt(e,0):this.h=e}return t}();t.Size=rt;var ot=function(t){function e(){return t.call(this,document.createElement("span"))||this}return __extends(e,t),e.prototype.initialize=function(){this.applyStyle("badge")},Object.defineProperty(e.prototype,"Content",{set:function(t){this.Clear(),t instanceof HTMLElement?this.Add(new D(t)):this.View.innerText=t.toString()},enumerable:!0,configurable:!0}),e}(c);t.Badge=ot;var st=function(){function t(t,e){this.handler=t,this.target=e,this.loc=new Z(0,0),this.mouseloc={x:void 0,y:void 0},this.cntloc={x:this.loc.x,y:this.loc.y},this.RelocationJob=o.thread.Dispatcher.cretaeJob(this.reLocation,[],this,!0),t.View.addEventListener("dragstart",this),this.handler.View.draggable=!0,this.View=e.View}return t.prototype.handleEvent=function(t){if("dragstart"==t.type)this.mouseloc={x:t.x,y:t.y},this.cntloc={x:this.target.View.offsetLeft,y:this.target.View.offsetTop},this.handler.View.addEventListener("dragend",this);else if("dragend"==t.type){var e=this.cntloc,n=this.mouseloc;this.Location={x:e.x+(t.x-n.x),y:Math.max(0,e.y+(t.y-n.y))},this.handler.View.removeEventListener("dragend",this)}"resize"===t.type&&o.thread.Dispatcher.Push(this.RelocationJob.Set(!0,!0))},Object.defineProperty(t.prototype,"Location",{set:function(t){this.loc=t,this.RelocationJob[0]=!0,this.RelocationJob[1]=!0,o.thread.Dispatcher.Push(this.RelocationJob.Set(!0,!0))},enumerable:!0,configurable:!0}),t.prototype.reLocation=function(t,e){var n=this.View,i=n.style,r=this.loc;window;t&&(i.left=r.x+u),e&&(i.top=r.y+u)},t}();t.DragManager=st;var at=function(t){function e(e){var n=t.call(this,e||document.createElement("div"))||this;return n.loc=new Z(0,0),n.size=new rt(window.screen.availWidth/2,window.screen.availHeight/2),n.mouseloc={x:void 0,y:void 0},n.cntloc={x:n.loc.x,y:n.loc.y},n.RelocationJob=o.thread.Dispatcher.cretaeJob(n.reLocation,[],n,!0),n}return __extends(e,t),e.prototype.initialize=function(){var e=this;window.addEventListener("resize",this),this.body=new C("div");var n=this.View.style;n.display="block",n.background="radial-gradient( #222,black)",n.position="fixed",n.border="2px gray solid",this.HorizontalAlignement=W.Center,this.VerticalAlignement=X.Center,this.Location={x:200,y:200},this.Size=new rt(new tt(90,Q.Percentage),new tt(90,Q.Percentage)),this.body.OnInitialized=function(t){e.Height;e.Height=new tt(89,Q.Percentage)},this.body.View.style.marginTop="50px",this.body.View.style.overflow="auto",t.prototype.Add.call(this,this.body)},e.prototype.Check=function(t){return t instanceof c},e.prototype.handleEvent=function(t){if("dragstart"==t.type)this.mouseloc={x:t.x,y:t.y},this.cntloc={x:this.View.offsetLeft,y:this.View.offsetTop},window.document.styleSheets.item(0);else if("dragend"==t.type){var e=this.cntloc,n=this.mouseloc;this.Location={x:e.x+(t.x-n.x),y:e.y+(t.y-n.y)}}"resize"===t.type&&o.thread.Dispatcher.Push(this.RelocationJob.Set(!0,!0))},Object.defineProperty(e.prototype,"Height",{set:function(t){var n=t.toString();this.View.style.maxHeight=n,this.View.style.minHeight=n,o.thread.Dispatcher.Push(this.RelocationJob.Set(void 0,!0)),o.thread.Dispatcher.Push(e.resizeBody,[this])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Width",{set:function(t){var n=t.toString();this.View.style.maxWidth=n,this.View.style.minWidth=n,this.body.View.style.width=t.minus(5).toString(),o.thread.Dispatcher.Push(this.RelocationJob.Set(!0,void 0)),o.thread.Dispatcher.Push(e.resizeBody,[this])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HorizontalAlignement",{set:function(t){this.ha=t||0,o.thread.Dispatcher.Push(this.RelocationJob.Set(!0,void 0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VerticalAlignement",{set:function(t){this.va=t||0,o.thread.Dispatcher.Push(this.RelocationJob.Set(void 0,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Location",{set:function(t){this.loc=t,o.thread.Dispatcher.Push(this.RelocationJob.Set(!0,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Size",{set:function(t){this.size=t,this.Width=t.w,this.Height=t.h,o.thread.Dispatcher.Push(this.RelocationJob.Set(!0,!0)),o.thread.Dispatcher.Push(e.resizeBody,[this])},enumerable:!0,configurable:!0}),e.prototype.reLocation=function(t,e){var n=this.View,i=n.style,r=this.loc,o=window,s="px";if(t)switch(this.ha){case W.Left:i.left=r.x+s;break;case W.Center:i.left=(o.innerWidth-this.View.clientWidth)/2+s;break;case W.Right:i.left=o.innerWidth-this.View.clientWidth-r.x+s}if(e)switch(this.va){case X.Top:i.top=r.y+s;break;case X.Center:i.top=(o.innerHeight-this.View.clientHeight)/2+s;break;case X.Bottom:i.top=o.innerHeight-this.View.clientHeight-r.y+s}},e.prototype.Add=function(t){return this.body.Add(t),this},e.prototype.AddRange=function(t){for(var e=0,n=t.length;e<n;e++)this.body.Add(t[e]);return this},e.resizeBody=o.thread.Dispatcher.cretaeJob(function(t){t.body.View.style.height=t.View.clientHeight+"px",t.body.View.style.width=t.View.clientWidth+"px"},[],null,!1),e}(c);t.FixedPanel=at;var ut=!1,ct=null,lt=new n.collection.List(String);lt.Freeze();var pt=function(e){function i(t){var i=e.call(this,t)||this;return i.Pages=new n.collection.List(Object),i.opcd={Owner:i,Invoke:i.PagesChanged},i.openedModal=[],i.zIndex=1e3,i._contextMenuLayer=void 0,i._currentContextMenu=void 0,i._currentContextMenuEventArgs=void 0,i._contextMenuZIndex=1e6,i.PagesChanged=i.PagesChanged.bind(i),i}return __extends(i,e),Object.defineProperty(i.prototype,"IsAuthentication",{get:function(){return!1},enumerable:!0,configurable:!0}),i.prototype.OnPageChanging=function(t){},i.prototype.OnPageChanged=function(t){var e=t._new;this.silentSelectPage(t._old,e),e&&e.OnSelected.Invoke(e,[e])},i.__fields__=function(){return[this.DPSelectedPage,this.DPCurrentModal=n.bind.DObject.CreateField("CurrentModal",bt,null,this.prototype._onCurrentModalChanged)]},i.prototype.Check=function(t){return!0},i.prototype.Logout=function(){this.Check},i.prototype.silentSelectPage=function(t,e){this.Foot.Pop(t),this.showPage(e),this.Foot.Push(e)},i.prototype.Open=function(t){this.SelectedPage=t},i.prototype.PagesChanged=function(t){t.event==n.collection.CollectionEvent.Added&&this.Foot.Register(t.newItem)},i.prototype.OpenPage=function(t){for(var e=this.Pages.AsList(),n=0,i=e.length;n<i;n++){var r=e[n];if(r.Name===t)return this.SelectedPage=r,!0}return!1},i.prototype.AddPage=function(t){null!=t&&this.Pages.Add(t)},i.prototype.SelectNaxtPage=function(){var t=this.Pages,e=t.IndexOf(this.SelectedPage),n=t.Get(e+1);n&&(this.SelectedPage=n)},i.prototype.SelectPrevPage=function(){var t=this.Pages,e=t.IndexOf(this.SelectedPage),n=t.Get(e-1);n&&(this.SelectedPage=n)},i.prototype.Update=function(){var t=this.SelectedPage;t&&t.Update()},i.prototype.OnKeyDown=function(t){var e=this.SelectedPage;e&&e.OnKeyDown(t)},i.prototype.OnKeyCombined=function(t,e){var n=this.SelectedPage;if(n)return n.OnKeyCombined(t,e)},i.prototype.OnPrint=function(){var t=this.SelectedPage;t&&t.OnPrint()},i.prototype.OnDeepSearche=function(){var t=this.SelectedPage;t&&t.OnDeepSearche()},i.prototype.OnContextMenu=function(t){var e=this.SelectedPage;e&&e.OnContextMenu(t)},i.prototype.handleEvent=function(t){},i.prototype.Show=function(){null!=ct&&document.body.removeChild(ct.View),ct=this,f.Current.Show(this)},i.prototype.initialize=function(){this.Pages.Listen=this.opcd},i.getView=function(){var t=document.createElement("app");return t.id="app-"+Date.now(),t},i.prototype.searchActioned=function(t,e,n){this.SelectedPage.OnSearche(e,n)},i.prototype.OnAttached=function(){},i.prototype.OnDetached=function(){},i.prototype.OpenModal=function(t){this.CurrentModal=t},i.prototype.CloseModal=function(t){var e=this.openedModal.indexOf(t);e!=-1&&this.openedModal.splice(e,1),this.CurrentModal=this.openedModal[this.openedModal.length-1]},i.prototype._onCurrentModalChanged=function(t){var e=t._old;e&&(e.disapplyStyle("in"),e.View.parentNode&&o.helper.TryCatch(e.View,Element.prototype.remove),e.Parent=null,e.Visible=!1),e=t._new,e?(this.openedModal.indexOf(e)==-1&&this.openedModal.push(e),e.View.parentNode&&o.helper.TryCatch(e.View,Element.prototype.remove),this._view.appendChild(e.View),e.applyStyle("in"),this.applyStyle("modal-open"),e.View.style.display="block",e.View.style.zIndex=this.zIndex++ +"",e.Visible=!0,e.Parent=this):this.disapplyStyle("modal-open")},i.prototype.OpenContextMenu=function(e,n){var i=this;if(this._contextMenuLayer){if(this._currentContextMenu&&!this.CloseContextMenu())return!1}else this._contextMenuLayer=(new t.ContentControl).applyStyle("context-menu-layer"),this._contextMenuLayer.Parent=this,this._contextMenuLayer.addEventListener("click",function(t,e,n){var r=e.target||e.srcElement;r===i._contextMenuLayer.View&&i.CloseContextMenu(void 0)},void 0,this),this._view.appendChild(this._contextMenuLayer.View);this._contextMenuLayer.disapplyStyle("hidden"),this._contextMenuLayer.View.style.zIndex=""+ ++this._contextMenuZIndex,this._contextMenuLayer.Content=e.getView(),this._currentContextMenu=e,this._currentContextMenuEventArgs=n,e.OnAttached(n)},i.prototype.CloseContextMenu=function(t){return!(this._currentContextMenuEventArgs&&(this._currentContextMenuEventArgs.cancel=!1,this._currentContextMenu&&this._currentContextMenu.OnClosed(t,this._currentContextMenuEventArgs)))&&(this._contextMenuLayer.Content=void 0,this._currentContextMenu=void 0,this._currentContextMenuEventArgs=void 0,this._contextMenuLayer.applyStyle("hidden"),!0)},i.DPSelectedPage=n.bind.DObject.CreateField("SelectedPage",Object,null,function(t){return t.__this.OnPageChanged(t)},function(t){return t.__this.OnPageChanging(t)}),i}(p);t.Layout=pt;var ht=(function(e){function n(t){var n=e.call(this,t||document.createElement("m-app"))||this;return n.applyStyle("app"),n._view.tabIndex=1,n}__extends(n,e),i=n,n._insertComponent=function(t){var e=t.child.e,n=t.parent.Control;e.Control&&n.Children.push(e.Control)},n.component=function(e){var n=new i(e.node.Dom);return t.Desktop.Current.Add(n),t.Desktop.Current.CurrentApp||(t.Desktop.Current.CurrentApp=n),e.node.e.Control=n,e.node},n.prototype.Check=function(){return!0},n.prototype.showPage=function(){},n.prototype.ShowApp=function(){},n.prototype.OnKeyDown=function(t){for(var e=0;e<this.Count;e++){var n=this.getChild(e);if(n.OnKeyDown(t))return!0}};var i;return n=i=__decorate([s.attributes.Component({name:"q-app",handler:i.component}),s.attributes.Content({handler:i._insertComponent,type:s.attributes.ContentType.multiple}),__metadata("design:paramtypes",[Element])],n)}(t.Layout),function(e){function i(t){var n=e.call(this,i.getView())||this;return n.name=t,n.intern=!0,n}return __extends(i,e),Object.defineProperty(i.prototype,"Title",{get:function(){return this.get(i.DPTitle)},set:function(t){this.set(i.DPTitle,t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Badge",{get:function(){return this.get(i.DPBadge)},set:function(t){this.set(i.DPBadge,t)},enumerable:!0,configurable:!0}),Object.defineProperty(i,"CurrentApp",{get:function(){return ct},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Name",{get:function(){return this.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"SearchBox",{get:function(){var e=this;return this._search||(this._search=new N,this._search.OnInitialized=function(n){n.Box.applyStyle("inputPage"),n.applyStyle("actionPage"),n.Box.View.style.borderWidth="0",n.Box.View.style.boxShadow="0 0 transparent",n.OnAction.Add(e.searchActioned.bind(e),"ts"),n.AutoAction=t.SearchActionMode.Instantany,n.addEventListener("focusout",function(e,n,i){var r=i._this.SelectedPage,o=r&&r.HasSearch;o==t.SearchActionMode.Instantany&&(i.wrapper.Content=i._this.slogant)},{_this:e,wrapper:e.AppTitle})}),this._search},enumerable:!0,configurable:!0}),i.prototype.createTitle=function(t){var e=this,n=new R;n.applyStyle("page_title");var i=new C("div");return n.Content=i,n.addEventListener("click",function(t,n,i){var r=e.SelectedPage,o=r&&r.HasSearch;if(o!==M.None&&null!=o){var s=i.wrapper.Content==i._this.slogant;s?(i.wrapper.Content=i._this.SearchBox,i._this.SearchBox.Focus()):i.wrapper.Content=i._this.slogant}else s||(i.wrapper.Content=i._this.slogant)},{_this:this,wrapper:n}),i.View.textContent=t,this.slogant=i,n},i.prototype.showPage=function(t){this.PageBody.Content=t},i.prototype.OnPageChanged=function(t){document.title=this.Title+"(Version D'Essaie)",this.slogant.View.textContent=t._new.GetValue(t._new.getDPTitle()),e.prototype.OnPageChanged.call(this,t)},i.prototype.initialize=function(){var t=this;e.prototype.initialize.call(this),this.applyStyle("app"),this.Head=new z(!0).applyStyle("top-navbar"),this.AppBody=new D("div").applyStyle("app-body"),this.Foot=new k(this,!1).applyStyle("bottom-navbar"),this.AppTitle=this.createTitle(this.Title).applyStyle("app-title"),this.PageBody=(new R).applyStyle("app-page"),this.AppBody.Add(this.AppTitle).Add(this.PageBody),ut=!0,this.Add(this.Head).Add(this.AppBody).Add(this.Foot),ut=!1,this.Foot.applyStyle("appFoot","app-foot"),this.PageBody.disapplyStyle("container"),this.Head.OnInitialized=function(e){return e.Header.OnInitialized=function(e){return e.Title=t.Name}},this.Head.Menu.Items.Source=this.Pages,this.Head.OnPropertyChanged(z.DPSelectedItem,function(e,n){t.SelectedPage=n._new||n._old}),1==n.basic.Settings.get("AppTitleHidden")?this.AppTitle.applyStyle("hideTitle"):this.AppTitle.disapplyStyle("hideTitle"),l.loadCss(),window.App=this},i.prototype.IsTopNavBarhidden=function(){var t=new URL(r.context.GetPath("../assets/style/bundle.css")).href;for(var e in document.styleSheets){var n=document.styleSheets[e];if(n.href&&n.href===t){for(var i,o=0;o<n.cssRules.length;o++){var s=n.cssRules[o];".app"===s.selectorText&&s.style.getPropertyValue("--top-navbar-height")&&(i=s)}if(i)return parseInt(i.style.getPropertyValue("--top-navbar-height"))<5}}},i.prototype.HideTopNavBar=function(t){var e=new URL(r.context.GetPath("../assets/style/bundle.css")).href;for(var n in document.styleSheets){var i=document.styleSheets[n];if(i.href&&i.href===e){for(var o,s=0;s<i.cssRules.length;s++){var a=i.cssRules[s];".app"===a.selectorText&&a.style.getPropertyValue("--top-navbar-height")&&(o=a)}if(o)return t?(o.style.setProperty("--top-navbar-height","0px"),this.Head.Visible=!1):(o.style.setProperty("--top-navbar-height","50px"),this.Head.Visible=!0),!0}}return!1},i.prototype.ToggleTitle=function(){this.AppTitle.View.classList.contains("hideTitle")?(n.basic.Settings.set("AppTitleHidden",!1),this.AppTitle.disapplyStyle("hideTitle")):(n.basic.Settings.set("AppTitleHidden",!0),this.AppTitle.applyStyle("hideTitle"))},i.prototype.IsTitleBringged=function(){return this.AppTitle.View.classList.contains("hideTitle")},i.prototype.Check=function(t){return t instanceof c||t instanceof B||t instanceof z||t instanceof G||t instanceof R},i.prototype.Add=function(t){return t instanceof K?this.AddPage(t):c.prototype.Add.call(this,t),this},i.__fields__=function(){return[this.DPTitle,this.DPBadge]},i.DPTitle=i.CreateField("Title",String,"App"),i.DPBadge=i.CreateField("Badge",String,null),i.Apps=new n.collection.List(i),i}(pt));t.App=ht;var dt=function(t){function e(e,i){var r=t.call(this,"Authentication")||this;if(h||!(i instanceof n.bind.EventListener))throw"";return i.On=d.bind(r),r.OnStatStatChanged=new n.bind.EventListener(e),r}return __extends(e,t),Object.defineProperty(e.prototype,"IsAuthentication",{get:function(){return!0},enumerable:!0,configurable:!0}),e}(ht);t.AuthApp=dt;var ft;(function(t){t[t.Focuse=0]="Focuse",t[t.UnFocus=1]="UnFocus"})(ft=t.NotifyType||(t.NotifyType={}));var yt;(function(t){t[t.Main=0]="Main",t[t.Stackable=1]="Stackable",t[t.Instantany=3]="Instantany"})(yt=t.ServiceType||(t.ServiceType={}));var vt=new t.Desktop,gt=function(t){function e(){var e=t.call(this)||this;return e._=[],e.map={},e}return __extends(e,t),e.prototype.Push=function(t,e){this._.push(t),void 0!==e&&(this.map[e]=t)},e.prototype.Remove=function(t){var e=this.map[t];if(void 0!==e){var n=this._.indexOf(e);n!==-1&&this._.splice(n,1),delete this.map[t]}return e},e.prototype.Create=function(){var t=function(t){function e(n,i){for(var r=t.call(this)||this,o=0;o<e._.length;o++){var s=e._[o];s.apply(n,i)}return r}return __extends(e,t),e.Push=function(t,e){this._.push(t),void 0!==e&&(this.map[e]=t)},e.Remove=function(t){var e=this.map[t];if(void 0!==e){var n=this._.indexOf(e);n!==-1&&this._.splice(n,1),delete this.map[t]}return e},e._=[],e.map={},e}(Function);return t},e}(Function);t.FunctionGroup=gt;var bt=function(e){function i(){var t=e.call(this,document.createElement("div"))||this;return t._fm=!1,t.events=[],t._onClick=new n.bind.EventListener("test"),t}return __extends(i,e),Object.defineProperty(i.prototype,"Content",{set:function(t){this._body.Content=t},enumerable:!0,configurable:!0}),i.prototype.getSearchBox=function(e){if(!this._searchBox){var n=(new t.Div).applyStyle("pull-left","flat"),i=new b(g.filter,!1,"Search"),r=n;return r.Add(i),r.Add(i),this.abonment=new t.ProxyAutoCompleteBox(new t.Input(document.createElement("input")),e),this.abonment.Box.Placeholder="Search ...",r.Add(this.abonment.Box),r.Enable=!0,this._searchBox=r,this.abonment.OnValueChanged(this,this.callBack),r}return this.abonment.DataSource=e,this._searchBox},i.prototype.callBack=function(t,e,n){this.onSearch&&this.onSearch(this,t,e,n)},i.prototype.OnSearch=function(t){this.onSearch=t},i.prototype.OkTitle=function(t){return this.createBtn(mt.ok,t)},i.prototype.AbortTitle=function(t){return this.createBtn(mt.abort,t)},i.prototype.Canceltitle=function(t){return this.createBtn(mt.cancel,t)},i.prototype.Title=function(t){return this._ts=t,this._dtitle&&(this._dtitle.View.innerHTML=t),this.asSearch=!1,this},i.prototype.Search=function(t){this._dtitle?(this._dtitle.Clear(),this._dtitle.View.innerHTML="",this._dtitle.Add(this.getSearchBox(t))):this.getSearchBox(t),this.asSearch=!0},i.prototype.SetDialog=function(t,e){this.IsInit?(this._body.Clear(),this.Title(t),this._body.Add(e)):this.OnInitialized=function(n){n._body.Clear(),n.Title(t),n._body.Content=e}},i.NextZIndex=function(){return++this.zIndex},Object.defineProperty(i.prototype,"IsOpen",{get:function(){return document.body.contains(this.View)},enumerable:!0,configurable:!0}),i.prototype.Open=function(){f.Current.CurrentApp.OpenModal(this),this.OnInitialized=function(t){var e=document.activeElement;e&&e.blur&&e.blur(),o.thread.Dispatcher.call(t.focuser,function(){o.thread.Dispatcher.OnIdle(this,this.reFocuseOn,!0)})}},i.prototype.silentClose=function(){(this.targetApp||f.Current.CurrentApp).CloseModal(this)},i.prototype.Close=function(t){var e=new _t(this,t,mt[t]);this._onClick.PInvok("test",[e],this);e.stayOpen||this.silentClose()},i.prototype.initialize=function(){this.applyStyle("modal","fade"),this.View.setAttribute("role","dialog"),this._container=new C("div").applyStyle("modal-dialog"),this._container1=new C("div").applyStyle("modal-content"),this._head=new C("div").applyStyle("modal-header"),this._body=(new R).applyStyle("modal-body"),this._foot=new C("div").applyStyle("modal-footer"),this.createHeader(this._head),this.createFoot(this._foot),this._container.Add(this._container1.AddRange([this._head,this._body,this._foot])),e.prototype.Add.call(this,this._container),this.drgmngr=new st(this._head,this._container1),this._container1.View.style.top=0+u,this.focuser=new n.basic.focuser(this._view,!1)},i.prototype.createHeader=function(t){var e=this,n=new C("div").applyStyle("close").setAttribute("data-dismiss","modal").setAttribute("aria-label","close"),i=new C("span").setAttribute("aria-hidden","true");i.View.innerHTML="&times;";var r=new C("h4").applyStyle("modal-title");this.asSearch?r.Add(this._searchBox):r.View.innerHTML=null==this._ts?"Dialog":this._ts,t.AddRange([n.Add(i),r]),n.View.onclick=function(t){return e.Close(mt.Exit)},this._dtitle=r},i.prototype.createFoot=function(t){this.createBtn(mt.ok),this.createBtn(mt.cancel)},i.prototype._setText=function(t,e){var n=this.events[t];n.btn.Visible=null!==e&&""!==e,n.btn.Text=void 0===e?mt[t].toUpperCase():null==e?"":e},i.prototype.SetVisible=function(t,e){var n=this,i=this.events[t];i?i.btn.Visible=e:this.OnInitialized=function(i){var r=n.events[t];if(r)r.btn.Visible=e;else{n.createBtn(t);var r=n.events[t];r.btn.Visible=e}}},i.prototype.createBtn=function(t,e){var n=this.events[t];return(null!==e&&""!==e||n)&&(this.IsInit?n?this._setText(t,e):this._initBtn(e,t):this.OnInitialized=function(n){
return n._initBtn(e,t)}),this},i.prototype._initBtn=function(t,e){var n=this.events[e];if(!n){if(null===t||""===t)return;this.events[e]=n={btn:(new m).applyStyle(i.casses[e]),event:null},n.event=n.btn.addEventListener("click",this._btnClicked,e,this),this._foot.Add(n.btn)}this._setText(e,t)},i.prototype._btnClicked=function(t,e,n){return this.Close(n)},i.prototype.Add=function(t){return this._body||this.initialize(),this._body.Add(t),this},i.prototype.Remove=function(t){return this._body.Remove(t)},i.prototype.Insert=function(t,e){return this._body.Insert(t,e),this},i.prototype.Dispose=function(){this.silentClose(),e.prototype.Dispose.call(this)},Object.defineProperty(i.prototype,"OnClosed",{get:function(){return this._onClick},enumerable:!0,configurable:!0}),i.prototype.OnKeyDown=function(t){var e=this._body.Content;if(e&&e.OnKeyDown&&e.OnKeyDown(t))return!0;if(27==t.keyCode)this.Close(mt.cancel);else if(13==t.keyCode){var n=this.focuser.focuse(!1,t.shiftKey);if(1==n){for(var i=1;i<4;i++){var r=this.events[i];if(r&&r.btn.View===document.activeElement)return!1}var o=this.events[1]||this.events[2]||this.events[3];return o.btn.Focus(),t.stopImmediatePropagation(),t.preventDefault(),!0}return n}},i.prototype.OnKeyCombined=function(t,e){var n=this._body.Content;if(n)return n.OnKeyCombined(t,e)},i.prototype.Clear=function(){this.Content=null,this._body.Clear()},i._ShowDialog=function(t,e,n,r,o){if(0==this.closedMessages.length)var s=new i;else s=this.closedMessages.pop();return s.OnInitialized=function(a){s.Title(null==t?"Confirm":t),s.Clear(),"string"==typeof e?s._body.View.innerHTML="<h5>"+e+"</h5>":e instanceof HTMLElement?s._body.View.appendChild(e):s._body.Content=e,s.OkTitle(null==r?"Ok":r),s.Canceltitle(void 0===o?"Cancel":o),s.OnClosed.Add(function(t){s.OnClosed.Remove(0),n&&n(t.msg,t.Modal);var e=i.closedMessages.indexOf(s);e==-1&&i.closedMessages.push(s)},0)},s.Open(),s.Close.bind(s)},i.ShowDialog=function(t,e,n,r,o,s){if(0==this.closedMessages.length)var a=new i;else a=this.closedMessages.pop();return a.OnInitialized=function(u){a.Title(null==t?"Confirm":t),a.Clear(),"string"==typeof e?a._body.View.innerHTML="<h5>"+e+"</h5>":e instanceof HTMLElement?a._body.View.appendChild(e):a._body.Content=e,a.OkTitle(null==r?"Ok":r),a.Canceltitle(void 0===o?"Cancel":o),a.AbortTitle(s),a.OnClosed.Add(function(t){if(n&&n(t),!t.stayOpen){a.OnClosed.Remove(0);var e=i.closedMessages.indexOf(a);e==-1&&i.closedMessages.push(a)}},0)},a.Open(),a},i.prototype.setStyle=function(t,e){return this._container.View.style[t]=e,this},i.prototype.setWidth=function(t){return this._container.View.style.width=t,this},i.prototype.setHeight=function(t){return this._container.View.style.height=t,this},Object.defineProperty(i.prototype,"IsMaterial",{set:function(t){t?this.applyStyle("material"):this.disapplyStyle("material")},enumerable:!0,configurable:!0}),i.prototype.OnContextMenu=function(t){var e=this.Content;if(e)return e.OnContextMenu(t)},i.zIndex=1e4,i.casses=["","btn-primary","btn-danger","btn-warning"],i.closedMessages=[],i}(c);t.Modal=bt;var mt;(function(t){t[t.Exit=0]="Exit",t[t.ok=1]="ok",t[t.cancel=2]="cancel",t[t.abort=3]="abort"})(mt=t.MessageResult||(t.MessageResult={}));var _t=function(){function t(t,e,n){this.Modal=t,this.Result=e,this.msg=n}return Object.defineProperty(t.prototype,"stayOpen",{get:function(){return this._stayOpen},enumerable:!0,configurable:!0}),t.prototype.StayOpen=function(){this._stayOpen=!0},t.prototype.Close=function(){this._stayOpen=!0},t}();t.MessageEventArgs=_t;var Ct=function(t){function e(){return t.call(this,document.createElement("img"))||this}return __extends(e,t),Object.defineProperty(e.prototype,"Source",{get:function(){return this._view.src},set:function(t){this._view.src=t},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){},e}(c);t.Image=Ct;var wt=function(t){function e(e,n){var i=t.call(this,document.createElement("div"))||this;return i.OnInitialized=function(t){if(t._image.Source=e,n instanceof HTMLElement)t._caption.View.appendChild(n);else{if("string"!=typeof n)throw"";t._caption.View.innerText=n}},i}return __extends(e,t),e.prototype.initialize=function(){this.applyStyle("item"),this._image=new Ct,this._caption=(new T).applyStyle("carousel-caption"),this.AddRange([this._image,this._caption])},Object.defineProperty(e.prototype,"Active",{set:function(t){t?this.applyStyle("active"):this.disapplyStyle("active")},enumerable:!0,configurable:!0}),e}(c);t.CarouselItem=wt;var St=function(t){function e(){var e=t.call(this,document.createElement("div"))||this;return e.opcd={Owner:e,Invoke:e.ItemsChanged},e.fromInit=!1,e.OnInitialized=function(t){return t.ItemsChanged(n.utils.ListEventArgs.ResetEvent)},e}return __extends(e,t),e.prototype.initialize=function(){this.applyStyle("carousel","slide"),this.View.setAttribute("data-ride","carousel"),this._indecators=new C("ol").applyStyle("carousel-indicators"),this._inner=(new T).applyStyle("carousel-inner"),this._items=new n.collection.List(wt),this._items.Listen=this.opcd,this.leftButton=this.createButton(!0),this.rightButton=this.createButton(!1),this.fromInit=!0,t.prototype.Add.call(this,this._indecators),t.prototype.Add.call(this,this._inner),t.prototype.Add.call(this,this.leftButton),t.prototype.Add.call(this,this.rightButton),this.fromInit=!1},e.prototype.createButton=function(t){var e=t===!0?"left":"right",n=new C("a").applyStyle(e,"carousel-control"),i=n.View;i.setAttribute("href","#"+this.Id),i.setAttribute("role","button"),i.setAttribute("data-slide",t===!0?"prev":"next");var r=document.createElement("span");return r.classList.add("glyphicon","glyphicon-chevron-"+e),i.appendChild(r),n},e.prototype.createIndecator=function(t){var e=new C("li");return e.View.setAttribute("data-target","#"+this.Id),e.View.setAttribute("data-slide-to",t+""),e},e.prototype.ItemsChanged=function(t){if(this.IsInit){var e=this._inner,i=this._indecators,r=t.newItem,o=void 0,s=void 0;switch(t.event){case n.collection.CollectionEvent.Added:o=this.createIndecator(t.startIndex),e.Add(r),i.Add(o),r.Indicator=o;case n.collection.CollectionEvent.Cleared:return void this.Clear();case n.collection.CollectionEvent.Removed:s=t.oldItem,i.Remove(s.Indicator),e.Remove(s);break;case n.collection.CollectionEvent.Replace:s=t.oldItem,i.Remove(s.Indicator),e.Remove(s),o=this.createIndecator(t.startIndex),e.Add(r),i.Add(o),r.Indicator=o;break;case n.collection.CollectionEvent.Reset:this.Clear();for(var a=0,u=this._items.Count;a<u;a++){var c=this._items.Get(0),l=c.Indicator||this.createIndecator(t.startIndex);e.Add(c),i.Add(l),c.Indicator=l}}this.selectNext()}},e.prototype.selectNext=function(){for(var t=this._items,e=0,n=t.Count;e<n;e++)if(t.Get(e).View.classList.contains("active"))return;n>0&&(t.Get(0).Active=!0)},e.prototype.Clear=function(){this._indecators.Clear(),this._inner.Clear()},e.prototype.Check=function(t){return this.fromInit||t instanceof wt},e.prototype.Add=function(e){return this.fromInit?t.prototype.Add.call(this,e):this._items.Add(e),this},e.prototype.Remove=function(t){return this._items.Remove(t),!0},e.prototype.RemoveAt=function(t){return this._items.RemoveAt(t),!0},e}(p);t.Carousel=St;var Ot=function(t){function e(e){var n=t.call(this,document.createElement("li"))||this;n.isNext=e;return n}return __extends(e,t),e.prototype.initialize=function(){var t=new w,e=new C("span"),n=new C("a");this.anchore=t,this.span=e,this.text=n,null!=this.isNext&&(t.View.setAttribute("aria-label",this.isNext?"Next":"Previous"),e.View.setAttribute("aria-hidden",this.isNext?"true":"false"),this.isNext?e.View.innerHTML="":e.View.innerHTML=""),this.View.addEventListener("click",this),this.Add(t.AddRange([e,n]))},Object.defineProperty(e.prototype,"Icon",{set:function(t){this.span.View.innerHTML=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Title",{set:function(t){this.text.View.innerHTML=t},enumerable:!0,configurable:!0}),e.prototype.handleEvent=function(t){this.OnClick&&this.OnClick(this)},e}(c);t.PaginationSurf=Ot;var xt=function(t){function e(){var e=t.call(this,document.createElement("nav"))||this;return e.isc=!1,e}return __extends(e,t),e.__fields__=function(){return[e.DPMax,e.DPIndex]},e.prototype.initialize=function(){var t=this;this.list=new C("ul").applyStyle("pager"),this.prev=new Ot(!1).applyStyle("previous"),this.next=new Ot(!0).applyStyle("next");var e=new C("li");this.actionText=(new x).applyStyle("text-center","borderless"),this.actionText.View.addEventListener("change",this),this.actionText.View.style.width="80px",this.actionText.View.style.border="0px",this.actionText.Text="0",e.Add(new w(this.actionText)),this.Add(this.list.AddRange([this.prev,e,this.next])),this.prev.Icon="<",this.prev.Title="<<<<",this.next.Icon=">",this.next.Title=">>>>",this.next.OnClick=function(){t.Index++},this.prev.OnClick=function(){t.Index--}},e.prototype.handleEvent=function(t){if(!this.isc){this.Index=parseFloat(this.actionText.Text)}},e.ctor=function(){this.DPMax=e.CreateField("Max",Number,1/0,function(t){var e=t._new;t.__this.Index>e&&(t.__this.Index=e)},function(t){t._new<0&&(t._new=0)}),this.DPIndex=e.CreateField("Index",Number,0,this.prototype._onIndexChanged,function(t){t._new<0?t._new=0:isNaN(t._new)?t._new=isNaN(t._old)?0:t._old:t._new>t.__this.Max&&(t._new=t.__this.Max)})},e.prototype._onIndexChanged=function(t){this.isc=!0,this.actionText.Text=t._new+"/"+this.Max,this.isc=!1},e}(c);t.BiPagination=xt;var Pt=function(t){function e(){var e=t.call(this,document.createElement("ul"))||this;return e.items=new n.collection.List(Ot),e.opcd={Owner:e,Invoke:e.OnItemsChanged},e}return __extends(e,t),Object.defineProperty(e.prototype,"SelectedRange",{get:function(){return this.get(e.DPRange)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Count",{get:function(){return this.get(e.DPCount)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"StartIndex",{get:function(){return this.get(e.DPStartIndex)},set:function(t){this.set(e.DPStartIndex,t)},enumerable:!0,configurable:!0}),e.prototype.OnCountChanged=function(t,e){for(var n,i=t;i<e;i++)this.items.Add(n=new Ot),n.OnClick=this.OnClick;for(var i=e;i<t;i++){n=this.items.Get(i-1);this.items.RemoveAt(i-1);n.OnClick=null}this.StartIndex=e*this.SelectedRange},e.prototype.OnRangeChanged=function(t,e){this.StartIndex=e*this.Count},e.prototype.OnStartIndexChanged=function(t){for(var e=this.Count,n=0;n<e;n++){var i=this.items.Get(n);i.Icon=n+""}},e.prototype.AddItem=function(t){},e.prototype.initialize=function(){this.applyStyle("pagination"),this.prev=new Ot(!1),this.next=new Ot(!0),this.Add(this.prev),this.Add(this.next),this.items.Listen=this.opcd;for(var t=0;t<10;t++){var e=new Ot;(function(t){return e.OnInitialized=function(e){return e.Icon=t.toString()}})(t),this.items.Add(e)}for(var t=0;t<this.items.Count;t++)this.Add(this.items.Get(t))},e.prototype.OnClick=function(t){this.sp&&this.sp.disapplyStyle("active"),this.sp=t,this.sp.applyStyle("active")},e.prototype.isInRange=function(t){var e=t-this.SelectedRange*this.Count;return e<this.Count&&e>=0},e.prototype.convert=function(t){return t-this.SelectedRange*this.Count},e.prototype.OnItemsChanged=function(t){switch(t.event){case n.collection.CollectionEvent.Added:t.newItem.OnClick=this.OnClick;var e=t.startIndex;(e<0||e>=this.Count)&&this.Insert(t.newItem,e+1);break;case n.collection.CollectionEvent.Removed:this.Remove(t.oldItem),t.oldItem.OnClick=null;break;case n.collection.CollectionEvent.Cleared:for(var i=t.collection,r=0,o=this.Count;r<o;r++){var s=i[0];this.Remove(s),s.OnClick=null}break;case n.collection.CollectionEvent.Reset:for(var a=this.items,r=0,o=this.Count;r<o;r++){var s=a.Get(0);this.Remove(s),s.OnClick=null}}},e.DPRange=e.CreateField("Range",Number,0,function(t){return t.__this.OnRangeChanged(t._old,t._new)}),e.DPStartIndex=e.CreateField("StartIndex",Number,0,function(t){return t.__this.OnStartIndexChanged(t._new)}),e.DPCount=e.CreateField("Count",Number,10,function(t){return t.__this.OnCountChanged(t._old,t._new)}),e}(c);t.Pagination=Pt;var It=function(t){function e(){var e=t.call(this,document.createElement("div"))||this;return e.f=!1,e.minValue=-Number.MAX_VALUE,e.defaultValue=0,e.maxvalue=Number.MAX_VALUE,e}return __extends(e,t),Object.defineProperty(e.prototype,"Value",{get:function(){return this.get(e.DPValue)},set:function(t){this.set(e.DPValue,t)},enumerable:!0,configurable:!0}),e.__fields__=function(){return[e.DPValue]},e.prototype._hasValue_=function(){return!0},e.prototype.initialize=function(){var t=this;this.applyStyle("input-group","input-group-lg");var e=new C("a").applyStyle("btn","btn-primary","input-group-addon","glyphicon","glyphicon-minus-sign"),n=new C("a").applyStyle("btn","btn-primary","input-group-addon","glyphicon","glyphicon-plus-sign"),i=new j;this.AddRange([this.sleft=e,this.text=i,this.sright=n]),this.text.Text="0",this.text.View.onchange=this.textChanged.bind(this),e.View.onclick=function(){t.Value--},n.View.onclick=function(){t.Value++}},e.prototype.textChanged=function(t){this.Value=parseFloat(this.text.Text)},e.prototype.Focus=function(){this.text.View.focus()},e.prototype.SelectAll=function(){var t=this.text.View;t.select()},e.DPValue=n.bind.DObject.CreateField("Value",Number,0,function(t){t.__this.text.Text=(null==t._new?0:t._new)+""},function(t){var e=t.__this,n=t._new;null!=n&&isFinite(n)?n<e.minValue?t._new=e.minValue:n>e.maxvalue&&(t._new=e.maxvalue):t._new=e.defaultValue}),e}(c);t.NumericUpDown=It;var Dt=function(t){function e(){var e=t.call(this,document.createElement("div"))||this;return e.caption=document.createElement("div"),e._view.appendChild(e.caption),e}return __extends(e,t),Object.defineProperty(e.prototype,"Caption",{set:function(t){this.caption.textContent=t},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){this.applyStyle("inavigation"),this.caption.classList.add("icaption")},e.prototype.getTemplate=function(t){return(new T).applyStyle("itab-header","sp-tooltip").Add(t)},e.prototype.Add=function(e){return t.prototype.Add.call(this,e.CaptionControl),this},e.prototype.AddRange=function(t){throw"Not Implimented"},e.prototype.Remove=function(e){return t.prototype.Remove.call(this,e.CaptionControl)},e.prototype.Insert=function(e,n){return t.prototype.Insert.call(this,e.CaptionControl,n),this},e.prototype.SetSeparator=function(){var e=new T;e.applyStyle("separator"),t.prototype.Add.call(this,e)},e}(c),Tt=function(e){function n(t,n){var i=e.call(this,document.createElement("div"))||this;return i.Name=t,i.title=(new T).applyStyle("icontent-header","hidden"),i.container=new T,i.caption=new m,i.Caption=n,i}return __extends(n,e),n.prototype.OnPrint=function(){},Object.defineProperty(n.prototype,"CaptionControl",{get:function(){return this.caption},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Title",{set:function(t){null!=t&&""!=t?("string"==typeof t?this.title.View.textContent=t:this.title.View.appendChild(t),this.title.disapplyStyle("hidden")):(this.title.View.innerHTML="",this.title.applyStyle("hidden"))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Caption",{set:function(t){this.caption.Text=t},enumerable:!0,configurable:!0}),n.prototype.initialize=function(){this.applyStyle("fitHeight"),this.container.applyStyle("fitHeight","nav-panel"),e.prototype.Add.call(this,this.title),e.prototype.Add.call(this,this.container)},Object.defineProperty(n.prototype,"ToolTip",{set:function(t){var e=document.createElement("text");e.textContent=t,e.classList.add("sp-tooltiptext"),this.caption.Content=e},enumerable:!0,configurable:!0}),n.prototype.Add=function(t){return this.container.Add(t),this},n.prototype.AddRange=function(t){return this.container.AddRange(t),this},n.prototype.Remove=function(t){return this.container.Remove(t)},n.prototype.RemoveAt=function(t,e){return this.container.RemoveAt(t,e)},n.prototype.Clear=function(){this.container.Clear()},n.prototype.Update=function(){},n.prototype.GetLeftBar=function(){return null},n.prototype.GetRightBar=function(){return null},n.prototype.Handled=function(){return!0},Object.defineProperty(n.prototype,"ServiceType",{get:function(){return yt.Instantany},enumerable:!0,configurable:!0}),n.prototype.Callback=function(){},n.prototype.OnBringIntoFront=function(){},n.prototype.OnKeyDown=function(t){},n.prototype.OnSearche=function(t,e){},n.prototype.OnDeepSearch=function(){},n.prototype.getHelp=function(e){var n=["primary","success","danger","info","warning"],i=0,r="";for(var o in e)r+='<div class="input-group" style="background:gray"> <span class="input-group-btn"> <label class="btn btn-'+n[i++%n.length]+'">'+o+'</label> </span> <label class="form-control" >'+e[o]+"</label> </div>";t.InfoArea.push(r,!0,1e4)},n}(c);t.NavPanel=Tt;var kt=function(t){function e(e){var n=t.call(this,document.createElement("div"))||this;return n.navPage=e,n}return __extends(e,t),e.prototype.initialize=function(){this.applyStyle("icontent")},e.prototype.Check=function(t){return!0},e.prototype.Add=function(t){return this._view.appendChild(t.View),t.Parent=this.navPage,this},e.prototype.Remove=function(t){return this._view.removeChild(t.View),t.Parent=null,!0},e}(c);t.IContent=kt;var At=function(e){function i(t,n,i){var r=e.call(this,t,n,i)||this;return r.con=new kt(r),r.nav=new Dt,r.caption=new m,r.children=[],r.events=[],r.panels={},r}return __extends(i,e),i.__fields__=function(){return[i.DPSelectedItem]},i.prototype._onSelectedItemChanged=function(t){var e=t._old,n=t._new;e&&(this.con.Remove(e),e.IsActive=!1,e.CaptionControl.Parent.disapplyStyle("selected"),e.disapplyStyle("selected"),this.app.Foot.Pop(e)),n&&(this.con.Add(n),n.IsActive=!0,n.CaptionControl.Parent.applyStyle("selected"),n.applyStyle("selected"),n.OnBringIntoFront(),this.app.Foot.Push(n))},Object.defineProperty(i.prototype,"Caption",{set:function(t){this.nav.Caption=t},enumerable:!0,configurable:!0}),i.prototype.initialize=function(){e.prototype.initialize.call(this),this._view.classList.add("inavPanel"),this.caption.applyStyle("icaption"),this.islocal=!0,e.prototype.Add.call(this,this.nav),e.prototype.Add.call(this,this.con),delete this.islocal},i.prototype.ToggleNav=function(){var t=this.nav.View,e=t.classList.contains("hideNav");e?t.classList.remove("hideNav"):t.classList.add("hideNav")},i.prototype.Add=function(t){throw"Not Implimented"},i.prototype.AddRange=function(t){throw"Not Implimented"},i.prototype.Check=function(t){return!!this.islocal},Object.defineProperty(i.prototype,"SelectedItem",{get:function(){return this.get(i.DPSelectedItem)},set:function(t){this.set(i.DPSelectedItem,t)},enumerable:!0,configurable:!0}),i.prototype.SetPanel=function(t){var e=this.panels[t.Name];if(e)throw"this panel exist";this.panels[t.Name]=t,this.children.push(t);this.nav.Add(t);this.events.push(t.CaptionControl.addEventListener("click",i._onItemSelected,{Item:t,List:this})),this.get(i.DPSelectedItem)||(this.SelectedItem=t)},i.prototype.GetPanelOf=function(t){for(var e in this.panels)if(this.panels[e]instanceof t)return this.panels[e]},i.prototype.GetPanelsOf=function(t){var e=[];for(var n in this.panels)this.panels[n]instanceof t&&e.push(this.panels[n]);return e},i.prototype.SetSeparator=function(){this.nav.SetSeparator()},i.prototype.OnKeyCombined=function(t,e){var n=this.SelectedItem;if(n)return n.OnKeyCombined(t,e)},i.prototype.OnKeyDown=function(e){var n=this.SelectedItem;if(e.altKey){if(e.keyCode===t.Keys.Down)return this.SelectedItem=this.children[(1+this.children.indexOf(n))%this.children.length],e.stopPropagation(),e.preventDefault();if(e.keyCode===t.Keys.Up){var i=this.children.indexOf(n);return 0==i&&(i=this.children.length),this.SelectedItem=this.children[(-1+i)%this.children.length],e.stopPropagation(),void e.preventDefault()}}n&&n.OnKeyDown(e)},i.prototype.OnContextMenu=function(t){var n=this.SelectedItem;return!(!n||!n.OnContextMenu(t))||e.prototype.OnContextMenu.call(this,t)},i.prototype.OnPrint=function(){var t=this.SelectedItem;t&&t.OnPrint()},i._onItemSelected=function(t,e,n){var i=n.List.SelectedItem;i&&(i.IsActive=!1);var r=n.Item;r&&(r.IsActive=!0),n.List.SelectedItem=n.Item},i.prototype.Select=function(t){var e=this.panels[t];return!!e&&(this.SelectedItem=e,!0)},i.prototype.GetLeftBar=function(){var t=this.SelectedItem;return t&&t.GetLeftBar()},Object.defineProperty(i.prototype,"HasSearch",{get:function(){return this.SelectedItem&&this.SelectedItem.HasSearch},set:function(t){},enumerable:!0,configurable:!0}),i.prototype.GetRightBar=function(){var t=this.SelectedItem;return t&&t.GetRightBar()},i.prototype.Update=function(){var t=this.SelectedItem;t&&t.Update()},i.prototype.OnSearche=function(t,e){var n=this.SelectedItem;n&&n.OnSearche(t,e)},i.prototype.OnDeepSearche=function(){var t=this.SelectedItem;t&&t.OnDeepSearch()},i.DPSelectedItem=n.bind.DObject.CreateField("SelectedItem",Tt,null,i.prototype._onSelectedItemChanged),i}(t.Page);t.NavPage=At}(a=e.UI||(e.UI={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.Create=function(t){var e=t instanceof n.bind.Scop,r=document.createElement("label");return r.textContent=((e?t.Value:t)||"").toString(),new i(r,e?t:new n.bind.ValueScop(t))},e}(t.JControl);t.TemplateShadow=e;var i=function(t){function e(e,n,i){var r=t.call(this,e)||this;return r.scop=n,r.cnt=new s.Controller(i||r),r.cnt.Scop=n,r}return __extends(e,t),Object.defineProperty(e.prototype,"Controller",{get:function(){return this.cnt},enumerable:!0,configurable:!0}),e.prototype.setDataContext=function(t){this.scop&&(this.scop.Value=t)},e.prototype.getDataContext=function(){return this.scop?this.scop.Value:null},e.prototype.initialize=function(){if(void 0==this.scop){var t=this._view.getAttribute("db-bind");t&&0===t.indexOf("$")&&(this.scop=n.bind.Scop.Create(t))}var e=this._view.getAttribute("db-bind");this._view.setAttribute("db-bind","~"+n.bind.AnonymouseScop.Register(this.scop)+(e&&""!=e?"."+e:"")),this.cnt.processHowEver=!0,this.cnt.Scop=this.Scop,this.cnt.View=this._view},e.prototype.Check=function(t){return!1},Object.defineProperty(e.prototype,"Scop",{get:function(){return this.scop},enumerable:!0,configurable:!0}),e.prototype.getScop=function(){return this.scop},e.prototype.Dispose=function(){stop()},e}(e);t.ScopicTemplateShadow=i;var r=function(){function t(t,e){this.control=t,this.scop=e,this.cnt=new s.Controller(t),this.initialize()}return Object.defineProperty(t.prototype,"Controller",{get:function(){return this.cnt},enumerable:!0,configurable:!0}),t.prototype.setDataContext=function(t){this.scop&&(this.scop.Value=t)},t.prototype.getDataContext=function(){return this.scop?this.scop.Value:null},t.prototype.initialize=function(){if(void 0==this.scop){var t=this.control.View.getAttribute("db-bind");t&&0===t.indexOf("$")&&(this.scop=n.bind.Scop.Create(t))}var e=this.control.View.getAttribute("db-bind");this.control.View.setAttribute("db-bind","~"+n.bind.AnonymouseScop.Register(this.scop)+(e&&""!=e?"."+e:"")),this.cnt.processHowEver=!0,this.cnt.View=this.control.View},t.prototype.Check=function(t){return!1},Object.defineProperty(t.prototype,"Scop",{get:function(){return this.scop},enumerable:!0,configurable:!0}),t.prototype.getScop=function(){return this.scop},t}();t.EScopicTemplateShadow=r;var a=function(){function t(){}return t.ToTemplate=function(e,n){if(e instanceof t||e instanceof l)return e;if(e instanceof HTMLTemplateElement)return new l(e.content.firstElementChild,!0);if(e instanceof HTMLElement)return new l(e,n);if("string"==typeof e){var i=f._getTemplate(e);if(null==i){var r="the template { "+e+" } was not found";console.error(new c(r));var o=document.createElement("error");return o.innerText=r,new l(o,!1)}return new p(i)}return new p(f._getTemplate(e))},t}();t.Template=a;var l=function(){function t(t,e){this.dom=t,t instanceof HTMLTemplateElement?(this.dom=t.content.firstElementChild,this.asTemplate=!0):this.asTemplate=!!e,Object.freeze(this)}return t.prototype.CreateShadow=function(t,e){return new i(this.asTemplate?this.dom.cloneNode(!0):this.dom,t instanceof n.bind.Scop?t:new n.bind.ValueScop(t),e)},t}();t.HtmlTemplate=l;var p=function(){function t(t){if(this.template="string"==typeof t?o.mvc.MvcDescriptor.Get(t):t,null==this.template)throw new c("the template { "+t+" } was not found")}return t.prototype.CreateShadow=function(t,e){return new i(this.template.Create(),t instanceof n.bind.Scop?t:new n.bind.ValueScop(t),e)},t}();t.ScopicTemplate=p;var h,d=function(t){function e(i,r){var o=t.call(this,null)||this;return o.data=r,o._onCompiled=new n.bind.EventListener(o,!0),o.compiled=!1,o._template=a.ToTemplate(i,!1),o.Shadow=o._template.CreateShadow(r===e.Me?o:r,o),o.Shadow.Parent=o,o._view=o.Shadow.View,o}return __extends(e,t),e.prototype.OnFullInitialized=function(){var e=this.Shadow.Controller;e&&(e.OnCompiled={Owner:this,Invoke:this._onTemplateCompiled}),t.prototype.OnFullInitialized.call(this)},e.prototype._onTemplateCompiled=function(t){this.compiled=!0,this.OnCompileEnd(t),this._onCompiled.PInvok(this,[this,t])},e.prototype.OnCompileEnd=function(t){},e.prototype.getScop=function(){return this.Shadow instanceof i?this.Shadow.Scop:null},e.prototype.initialize=function(){},Object.defineProperty(e.prototype,"OnCompiled",{set:function(t){this.compiled?t(this):this._onCompiled.On=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsCompiled",{get:function(){return this.compiled},enumerable:!0,configurable:!0}),e.prototype.OnDataChanged=function(t){this.Shadow.setDataContext(t._new)},e.Me=new Object,__decorate([n.attributes.property1(Object,{changed:e.prototype.OnDataChanged}),__metadata("design:type",Object)],e.prototype,"Data",void 0),e}(t.JControl);t.TControl=d;var f=function(i){function r(t,e,r,o){var s=i.call(this,t||document.createElement("div"),r)||this;return s.garbage=[],s.AcceptNullValue=!0,s.OnItemSelected=new n.bind.EventListener(""),s.OnItemInserted=new n.bind.EventListener(""),s.OnItemRemoved=new n.bind.EventListener(""),s.OnChildClicked=new n.bind.EventListener(""),s.sli={Owner:s,Invoke:s.OnSourceChanged},s.count=0,s.initTemplate(e,o),s}return __extends(r,i),r.prototype.instantanyInitializeParent=function(){return!0},r.__fields__=function(){return[r.DPSelectedIndex,r.DPTemplate,r.DPSource,this.DPSelectedItem]},Object.defineProperty(r.prototype,"Source",{get:function(){return this.get(r.DPSource)},set:function(t){this.set(r.DPSource,t)},enumerable:!0,configurable:!0}),r.prototype.__checkSelectedIndex=function(t){var e=this.Source,n=null==e?0:e.Count,i=isNaN(t._new)||null==t._new||t._new<0?-1:t._new;i===-1?t._new=this.AcceptNullValue||0==n?-1:0:i>=n&&(t._new=this.AcceptNullValue?n:n-1)},r.prototype.swap=function(t){var e=this.Source,n=null==e?0:e.Count,i=t;return t<0?-1:i>=n?n-1:t},Object.defineProperty(r.prototype,"SelectedIndex",{get:function(){return this.get(r.DPSelectedIndex)},set:function(t){this.set(r.DPSelectedIndex,t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"ItemStyle",{get:function(){return this.get(r.DPItemStyle)},set:function(t){this.set(r.DPItemStyle,t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Template",{get:function(){return this.get(r.DPTemplate)},set:function(t){this.set(r.DPTemplate,t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Content",{get:function(){return this._content},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"SelectedChild",{get:function(){return this._selectedItem},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"SelectedItem",{get:function(){return this._selectedItem&&this._selectedItem.getDataContext()},set:function(t){this.SelectedIndex=this.Source&&this.Source.IndexOf(t)},enumerable:!0,configurable:!0}),r.prototype.OnSelectedIndexChanged=function(t,e){var n=this._content.getChild(e),i=this._content.getChild(t),o=t;if(i&&i.disapplyStyle(this.activateClass||"active"),n&&n.applyStyle(this.activateClass||"active"),this._selectedItem=n,t!==e)return this.set(r.DPSelectedItem,n&&n.getDataContext()),this.riseItemSelectedEvent(this.SelectedIndex,n,o,i),!0},r.prototype.riseItemSelectedEvent=function(t,e,n,i){this.OnItemSelected.Invoke("",[this,t,e,n,i]);var r=e&&e.View;r&&(r.scrollIntoViewIfNeeded?r.scrollIntoViewIfNeeded():r.scrollIntoView())},r.prototype.Select=function(t){this.SelectedIndex=this._content.IndexOf(t)},r.prototype.SelectItem=function(t){var e=this.Source;e&&(this.SelectedIndex=e.IndexOf(t))},r._getTemplate=function(t){switch(typeof t){case"string":return o.mvc.MvcDescriptor.Get(t);case"function":return o.mvc.MvcDescriptor.GetByType(t).Default;default:if(t instanceof o.mvc.ITemplate)return t;var e=o.mvc.MvcDescriptor.GetByType(t);return e?e.Default:void 0}},r._getTemplateShadow=function(t){if(t instanceof HTMLElement)return t;var e=r._getTemplate(t);return void 0==e?document.createElement("div"):e.Create()},r.ctor=function(){h=[this.prototype.OnAdd,this.prototype.OnRemove,this.prototype.OnReplace,this.prototype.OnClear,this.prototype.Reset,this.prototype.OnSet]},r.prototype.initTemplate=function(e,n){var i=this._view,o=$("[db-content]",i)[0]||i,s=$("[attach-SelectedItem]",i)[0];s&&this.AttachSelectedItem(s),n&&this.getSourceFromScop(o),this._content=new t.DivControl(o);var u=i.getAttribute("item-style")||o.getAttribute("item-style");u&&(this.ItemStyle=u.split(" ")),this.Template=a.ToTemplate(e||r.getTemplate(o)||this._content.View.getAttribute("item-template")||i.getAttribute("item-template"),!0),this._content.Parent=this},r.getFirstChild=function(t){for(var e,n=t.firstChild;n;){if(n instanceof Element)return n;!e&&n instanceof Node&&(e=n),n=n.nextSibling}return e},r.getTemplate=function(t){for(var e=t.children,i=0,o=e.length;i<o;i++){var s=e[i];if(n.basic.polyfill.IsTemplate(s)){var a=r.getFirstChild(s.content);return s.remove(),a}}},r.prototype.getSourceFromScop=function(t){t.setAttribute("db-cmd",n.ScopicCommand.Register({Invoke:this.CmdExecuter,Owner:this}))},r.prototype.CmdExecuter=function(t,e,i){n.ScopicCommand.Delete(t),this._scop=i,this.Source=i.Value,this.RlSourceScop=new n.bind.TwoBind(n.bind.BindingMode.TwoWay,i,this,n.bind.Scop.DPValue,r.DPSource),this.Source=i.Value},r.prototype.AttachSelectedItem=function(t){t.setAttribute("db-cmd",n.ScopicCommand.Register({Invoke:this.CmdAttacheSelectedItemExecuter,Owner:this}))},r.prototype.CmdAttacheSelectedItemExecuter=function(t,e,i){n.ScopicCommand.Delete(t),this.OnPropertyChanged(r.DPSelectedIndex,function(t,e){this.s.Value=this.t.SelectedItem},{t:this,s:i})},r.prototype.initialize=function(){var t=this,e=this.Source;this.Content.OnInitialized=function(i){return t.Reset(e?new n.utils.ListEventArgs(null,null,null,n.collection.CollectionEvent.Reset,e.AsList()):void 0)}},r.prototype.OnSourceChanged=function(t){this.Template&&h[t.event].call(this,t)},r.prototype.ReSelect=function(){var t=this.get(r.DPSelectedIndex),e=this.swap(t);return!this.AcceptNullValue&&e<0&&this.Source&&this.Source.Count>0&&(e=0),t!==e?(this.SelectedIndex=e,!0):this.OnSelectedIndexChanged(t,e)},Object.defineProperty(r.prototype,"Scop",{get:function(){if(!this._scop){var t=i.prototype.getScop.call(this);return t?t:(this._scop=n.bind.NamedScop.Create(null,this.Source),this._scop.setParent(this),this._scop)}},enumerable:!0,configurable:!0}),r.prototype.BindTo=function(t){t&&(t.OnPropertyChanged(n.bind.Scop.DPValue,this.OnScopValueChanged,this),this.Source=t.Value)},r.prototype.OnScopValueChanged=function(t,e){this.Source=e._new},r.prototype.OnItemClicked=function(t,e,n){var i={sender:this,Event:e,index:this.Source.IndexOf(t.getDataContext()),template:t};this.OnChildClicked.PInvok("",[i],this),i.Cancel||n.Select(t)},r.prototype.getItemShadow=function(t,n){var i=this.garbage.pop();if(!i){var r=this.Template;i=null==r?e.Create(t):r.CreateShadow(t,void 0)}return i},r.prototype.disposeItemShadow=function(t,e,n){if(!(t instanceof Array&&NaN==n&&void 0==e)){if(!e)return;return this.garbage.push(e),e}this.garbage.push.apply(this.garbage,this.CloneChildren());
},r.prototype.disposeItemsShadow=function(t,e){this.garbage.push.apply(this.garbage,this.CloneChildren())},r.prototype._insert=function(t,e){var n=this;this.count++;var i=this.getItemShadow(t,e),r=i.getScop();r&&r.setParent(this.Scop),i.setDataContext(t),e?this.Insert(i,e):this.Add(i),void 0==e&&(e=this.Source.Count-1);var o=i.__events;void 0!=o&&o.Dispose(),i.__events=[i.addEventListener("click",this.OnItemClicked,this,this),i.addEventListener("contextmenu",this.OnItemClicked,this,this)];var s=i.View.classList;this.ItemStyle&&s.add.apply(s,this.ItemStyle),this.OnItemInserted.Invok("",function(r){return r(n,e,t,i)});var a=this.ReSelect();a||e!=this.SelectedIndex||this.riseItemSelectedEvent(e,i,e,this._content.getChild(e))},r.prototype._remove=function(t,e){var n=this,i=this.disposeItemShadow(t,this._content.getChild(e),e);e===this.SelectedIndex;this.count--,i.disapplyStyle(this.activateClass||"active"),this._content.RemoveAt(e,!1);for(var r=0,o=i.__events;r<o.length;r++){var s=o[r];void 0!=s&&s.Dispose()}i.__events=void 0;var a=i.View.classList;this.ItemStyle&&a.remove.apply(a,this.ItemStyle),this.OnItemRemoved.Invok("",function(r){return r(n,e,t,i)});var u=this.ReSelect();u||e!=this.SelectedIndex||this.riseItemSelectedEvent(e,this._content.getChild(e),e,i)},r.prototype.OnAdd=function(t){this._insert(t.newItem,t.startIndex)},r.prototype.OnSet=function(t){var e=this._content.getChild(t.startIndex);e&&e.setDataContext(t.newItem)},r.prototype.OnClear=function(t){if(this.SelectedIndex=-1,this.disposeItemsShadow(t&&t.collection,this.CloneChildren()),t&&t.collection&&this.count>0)for(var e=t.collection.length-1;e>=0;e--)this._remove(t.collection[e],e);this.count=0},r.prototype.OnRemove=function(t){this._remove(t.oldItem,t.startIndex)},r.prototype.OnReplace=function(t){this._content.getChild(t.startIndex).setDataContext(t.newItem)},r.prototype.Reset=function(t){var e=this,n=this.SelectedIndex,i=this.Source;if(this.OnClear(t),i)for(var r=0,s=i.Count;r<s;r++)this._insert(i.Get(r),r);o.thread.Dispatcher.call(this,function(t){e.SelectedIndex=t},n)},r.prototype.clearGarbage=function(){for(var t=0,e=this.garbage.length;t<e;t++)this.garbage[t].Dispose();this.garbage.length=0},r.prototype.Recycle=function(){this.Clear(),this.clearGarbage(),this.Reset()},r.prototype.Dispose=function(){var t=this.OnDispose();null!==t&&(this.Source.Unlisten=this.sli,this.sli=null,this.clearGarbage(),this._content.Dispose(),this._content=null,i.prototype.Dispose.call(this),t||(this.DisposingStat=2))},r.prototype.Add=function(t){return this._content.Add(t),this},r.prototype.AddRange=function(t){return this._content.AddRange(t),this},r.prototype.Remove=function(t,e){return this._content.Remove(t)},r.prototype.RemoveAt=function(t,e){return this._content.RemoveAt(t,e)},r.prototype.Clear=function(t){var e=this.Source;if(e)for(var n=this.Content.Count-1;n>=0;n--)this._remove(e.Get(n),n)},r.prototype.Insert=function(t,e){return this._content.Insert(t,e),this},r.prototype.CloneChildren=function(){return this._content.CloneChildren()},r.prototype.Check=function(t){return t instanceof e},r.prototype.OnKeyDown=function(e){if(e.keyCode==t.Keys.Down)this.SelectedIndex++;else if(e.keyCode==t.Keys.Up)this.SelectedIndex--;else if(e.keyCode==t.Keys.End)this.SelectedIndex=Number.MAX_VALUE;else{if(e.keyCode!=t.Keys.Home)return!1;this.SelectedIndex=-1}return e.preventDefault(),e.stopPropagation(),!0},r.DPSource=n.bind.DObject.CreateField("Source",n.collection.List,null,function(t){var e=t.__this;t._old&&(t._old.Unlisten=t.__this.sli),t._new&&(t._new.Listen=t.__this.sli),e.IsInit&&e.Reset(t)},function(t){t.__this.IsInit&&t.__this.Clear()}),r.DPSelectedIndex=n.bind.DObject.CreateField("SelectedIndex",Number,-2,function(t){return t.__this.OnSelectedIndexChanged(t._old,t._new)},r.prototype.__checkSelectedIndex),r.DPItemStyle=n.bind.DObject.CreateField("ItemStyle",Array,void 0,function(t){var e=t.__this._content;if(e)for(var n=t._new,i=t._old,r=0,o=e.Count;r<o;r++){var s=e.getChild(r).View.classList;i&&s.remove.apply(s,i),n&&s.add.apply(s,n)}}),r.DPTemplate=n.bind.DObject.CreateField("Template",Object,null,function(t){return t.__this.Recycle()},function(t){t._new&&"function"!=typeof t._new.CreateShadow&&(t.IsValid=!1)}),r.DPSelectedItem=n.bind.DObject.CreateField("SelectedItem",Object),r}(d);t.ListAdapter=f;var y=function(e){function n(t){var n=e.call(this,document.createElement("div"))||this;return n.isStarted=!1,n}return __extends(n,e),n.prototype.initialize=function(){this.container=document.createElement("div"),this.circle=document.createElement("div"),this.message=document.createElement("p"),this.message.textContent="Wait",this.applyStyle("full-fixedlayout"),this.container.classList.add("spinner"),this.circle.classList.add("spinner-circle"),this.message.classList.add("spinner-message"),this.container.appendChild(this.circle),this.container.appendChild(this.message),this._view.appendChild(this.container)},n.prototype.Start=function(e){var n=this;this.OnInitialized=function(t){return t.circle.classList.add("spinner-start")},this.Parent=t.Desktop.Current,this.OnInitialized=function(t){n.Message=e||"Wait",document.body.appendChild(n.View)},this.isStarted=!0},n.prototype.Pause=function(){this.isStarted&&(this.Parent=null,this.circle.classList.remove("spinner-start"),document.body.removeChild(this.View)),this.isStarted=!1},Object.defineProperty(n.prototype,"Message",{set:function(t){this.message.textContent=t},enumerable:!0,configurable:!0}),n.Default=new n(void 0),n}(t.JControl);t.Spinner=y,function(){var t=document.getElementById("spinner");t&&t.parentElement.removeChild(t),y.Default.Start("Loadding")}();var v=(Date.now(),function(e){function i(n,i,r){var o=e.call(this,document.createElement("div"))||this;return o.isOpen=!1,o._view.classList.add("full-fixedlayout1"),o._view.addEventListener("click",o),n&&(o.itemTemplate=a.ToTemplate(n,!1)),void 0===r?o.Parent=t.Desktop.Current:o.Parent=r,i&&(o.OnInitialized=function(t){return t.Data=i}),o}return __extends(i,e),i.prototype.handleEvent=function(t){this.Close(!0)},i.prototype.initialize=function(){var e=this;this.menu=(new t.Div).applyStyle("contextmenu","panel"),this.adapter=new f(document.createElement("div"),"menu.simple").applyStyle("panel-body","verticalList"),this.adapter.ItemStyle=["focusable"],this.adapter.AcceptNullValue=!0,this.Add(this.menu.Add(this.adapter)),this.menu.View.style.backgroundColor="#333",this.menu.View.style.color="white",this.adapter.OnItemSelected.On=function(t,n,i){n!=-1&&e.isOpen&&(e.Close(!0),e.i&&i&&e.i.Invoke.call(e.i.Owner,e,i.getDataContext()))},this.menu.addEventListener("mouseleave",function(t,e,n){n.Close(!1)},this),this.menu.addEventListener("mouseenter",function(t,e,n){clearTimeout(n.timeout)},this),this._view.style.zIndex="2000000"},i.prototype.toInt=function(t){return t===!1?0:null==t?-.5:-1},i.prototype.Open=function(t,e,n,i){var r=this;if(1!=this.isOpen){this.adapter.SelectedIndex=-1,this.menu.disapplyStyle("chide");var o=this.menu.View,s=this.menu.View.style;t={x:t.x,y:t.y},this.adapter.SelectedIndex=-1,document.body.appendChild(this._view),this.i=e,this.isOpen=!0,this.adapter.OnInitialized=function(e){return setTimeout(function(){var e=r.toInt(n)*o.clientWidth+t.x,a=r.toInt(i)*o.clientHeight+t.y;s.left=(e<0?0:e)+u,s.top=(a<0?0:a)+u},200)}}},i.prototype.Close=function(t){var e=this;0!=this.isOpen&&(t?(this.isOpen=null,this.menu.applyStyle("chide"),setTimeout(function(){e.isOpen=!1,e._view.remove()},500),this.adapter.SelectedIndex=-1):this.timeout=setTimeout(function(t){return t.Close(!0)},1500,this))},Object.defineProperty(i.prototype,"Data",{set:function(t){var e=this.adapter;e.Source?(e.Source.Clear(),e.Source.AddRange(t)):e.Source=new n.collection.List(Object,t)},enumerable:!0,configurable:!0}),i}(t.JControl));t.RichMenu=v,window.rm=v,window.rmt=function(){var e=new v;e.Parent=t.Desktop.Current,e.OnInitialized=function(t){t.Data=["File","Save","Close","Discart"],document.addEventListener("click",function(e){r=(r+1)%n.length,t.Open(e,{Owner:null,Invoke:function(t,e){}},n[r],i[r]),e.stopPropagation(),e.preventDefault()})};var n=[null,null,null,!0,!0,!0,!1,!1,!1],i=[null,!0,!1,null,!0,!1,null,!0,!1],r=0};var g;(function(t){t[t.Left=1]="Left",t[t.Top=2]="Top",t[t.Right=4]="Right",t[t.Bottom=8]="Bottom",t[t.HCenter=5]="HCenter",t[t.VCenter=10]="VCenter",t[t.Center=15]="Center",t[t.TopLeft=3]="TopLeft"})(g=t.Location||(t.Location={}));var b=function(e){function i(i){var r=e.call(this,document.createElement("div"))||this;return r.dic=new n.collection.Dictionary(""),r.list=new t.ListAdapter("templates.contextmenu",void 0,r,!0),r.OnAction=new n.bind.EventListener("",!1),r.location=g.TopLeft,r.Items=new n.collection.List(Object,i),r}return __extends(i,e),i.__fields__=function(){return[this.DPTitle,this.DPItems]},Object.defineProperty(i,"NextZIndex",{get:function(){return++this.zIndex},enumerable:!0,configurable:!0}),i.prototype.initialize=function(){this.applyStyle("fit"),this.list.OnItemSelected.Add(this.OnItemSelected.bind(this)),this.list.OnItemInserted.Add(this.OnItemInserted.bind(this)),this.list.OnItemRemoved.Add(this.OnItemRemoved.bind(this)),this.list.applyStyle("shadow"),this._view.addEventListener("mousedown",this),this.Add(this.list)},i.prototype.OnItemSelected=function(t,e,n,i,r){},i.prototype.OnItemInserted=function(t,e,n,i){var r={p:this,cnt:i,data:n,handleEvent:function(t){this.p.Action(this.cnt,this.data,t)}};this.dic.Set(i,r),i.applyStyle("focusable"),i.View.addEventListener("click",r)},i.prototype.OnItemRemoved=function(t,e,n,i){var r=this.dic.Get(i),o=i.View;o.removeEventListener("click",r),this.dic.Remove(i)},i.prototype.Action=function(t,e,n){n.stopPropagation(),n.preventDefault(),this.OnAction.PInvok("",[this,e]),this.Close()},i.prototype.ShowForTarget=function(){var e=this.target;if(e=e instanceof HTMLElement?e:e instanceof t.JControl?e.View:null,null!=e){var n=e.offsetLeft+e.offsetWidth,i=e.offsetTop+e.offsetHeight;this.Show(n,i+7)}},i.prototype.Show=function(e,n){var r=this;this.list.SelectedIndex=-1;this.list;this.disapplyStyle("hidden"),this._view.style.zIndex=i.NextZIndex.toString(),this.parent||(this.Parent=t.Desktop.Current),document.body.appendChild(this._view),this.OnInitialized=function(t){return o.thread.Dispatcher.call(t,function(){var t=r.list.View,i=r.HorizontalFraction*t.clientWidth+e,o=r.VerticalFraction*t.clientHeight+n,s=r.list.View.style,a=r.list.View,c={w:r.View.clientWidth,h:r.View.clientHeight};i=i<0?0:i,o=o<0?0:o,i=i+a.clientWidth>c.w?c.w-a.clientWidth:i,o=o+a.clientHeight>c.h?c.h-a.clientHeight:o,s.left=i+u,s.top=o+u})}},i.prototype.toInt=function(t){return t===!1?0:null==t?-.5:-1},Object.defineProperty(i.prototype,"HorizontalFraction",{get:function(){var t=this.location;return(t&g.HCenter)==g.HCenter?-.5:(t&g.Left)==g.Left?0:-1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"VerticalFraction",{get:function(){var t=this.location;return(t&g.VCenter)==g.VCenter?-.5:(t&g.Top)==g.Top?0:-1},enumerable:!0,configurable:!0}),i.prototype.handleEvent=function(e){switch(e.type){case"mousedown":return void(e.srcElement==this._view&&this.Close());case"contextmenu":return void this._OnContextMenu(this.target instanceof t.JControl?this.target:null,this.target instanceof HTMLElement?this.target:this.target.View,e)}},i.prototype._OnContextMenu=function(t,e,n){this.Show(n.x,n.y),n.preventDefault(),n.stopPropagation()},i.prototype.Close=function(){this.applyStyle("hidden"),this._view.remove()},Object.defineProperty(i.prototype,"Target",{set:function(t){if(this.target){var e=this.target instanceof HTMLElement?this.target:this.target.View;e.removeEventListener("contextmenu",this),this.target=null}if(t){var n=t instanceof HTMLElement?t:t.View;n.addEventListener("contextmenu",this),this.target=t}},enumerable:!0,configurable:!0}),i.DPTitle=n.bind.DObject.CreateField("Title",String,"Menu"),i.DPItems=n.bind.DObject.CreateField("Items",n.collection.List),i.zIndex=2e4,i}(t.JControl);t.ExContextMenu=b;var m=function(e){function i(i){var r=e.call(this,document.createElement("div"))||this;if(r.dic=new n.collection.Dictionary(""),r.itemChangedDlg={Invoke:r.SourceChanged,Owner:r},r.OnItemSelected=function(t){this.OnMenuItemSelected.Invoke(this.OnItemSelected,[this,t])}.bind(r),r.OnMenuItemSelected=new n.bind.EventListener(r.OnItemSelected),i)for(var o=0;o<i.length;o++){var s=i[o];if(!(s instanceof t.MenuItem)){var a=i[o]=new t.CItem(s,s,"#",null);a.Content.applyStyle("col-xs-12")}}return r.Items=new n.collection.List(t.CItem,i),r}return __extends(i,e),i.prototype.initialize=function(){this.applyStyle("contextmenu"),this.reset(),this.Items.Listen=this.itemChangedDlg},i.prototype.SourceChanged=function(t){switch(t.event){case n.collection.CollectionEvent.Added:this.add(t.newItem);break;case n.collection.CollectionEvent.Replace:this.replace(t.oldItem,t.newItem);break;case n.collection.CollectionEvent.Removed:this.remove(t.oldItem);break;case n.collection.CollectionEvent.Cleared:this.clear();break;case n.collection.CollectionEvent.Reset:this.clear(),this.reset()}},i.prototype.add=function(n){var i=new t.MenuItem(n).applyStyle("row");e.prototype.Add.call(this,i),this.dic.Set(n,i),n.OnItemSelected=this.OnItemSelected},i.prototype.remove=function(t){e.prototype.Remove.call(this,this.dic.Remove(t),!0)},i.prototype.replace=function(t,e){throw"not implimented"},i.prototype.clear=function(){for(var t=this.dic,n=t.Count-1;n>=0;n--)e.prototype.Remove.call(this,this.dic.RemoveAt(n).Value,!0)},i.prototype.reset=function(){for(var t=0,e=this.Items.Count;t<e;t++){var n=this.Items.Get(t);this.add(n)}},i.prototype.Add=function(t){throw""},i.prototype.AddRange=function(t){throw""},i.prototype.Remove=function(t,e){return!1},i.prototype.Show=function(e,n){this.disapplyStyle("hidden");var i=this._view.style;i.left=e+"px",i.top=n+"px",this._view.addEventListener("mouseout",this),this._view.addEventListener("mousein",this),this.parent||(this.Parent=t.Desktop.Current),document.body.appendChild(this._view)},i.prototype.handleEvent=function(t){switch(t.type){case"mouseout":break;case"mousein":clearTimeout(this.thrid);break;case"contextmenu":this._OnContextMenu(this.target,this.target instanceof HTMLElement?this.target:this.target.View,t)}},i.prototype._OnContextMenu=function(t,e,n){this.Show(n.x,n.y),n.preventDefault(),n.stopPropagation()},i.prototype.timeout=function(t){t.applyStyle("hidden"),t._view.remove()},Object.defineProperty(i.prototype,"Target",{set:function(t){if(this.target){var e=this.target instanceof HTMLElement?this.target:this.target.View;e.removeEventListener("contextmenu",this),this.target=null}if(t){var n=t instanceof HTMLElement?t:t.View;n.addEventListener("contextmenu",this),this.target=t}},enumerable:!0,configurable:!0}),i}(t.JControl);t.ContextMenu=m;var _=function(){function t(){}return t.prototype.initialize=function(){},t.deg2str=function(t,e){return e*(2*Math.PI*t)/360},t.createDashArray=function(t,e){for(var n="",i=2*Math.PI*t/360,r=0;r<e.length;r++)n+=(0!==r?",":"")+i*e[r]+"px"},t}();t.Gage=_;var C=function(t){function e(e,n){var i=t.call(this,e)||this;return i.data=n,i.setDataContext(i.data),i}return __extends(e,t),e.prototype.setDataContext=function(t){this.data=t,this._view.textContent=this._view.label=t?t.toString():""},e.prototype.getDataContext=function(){return this.data},e.prototype.initialize=function(){this.setDataContext(this.data)},e.prototype.getScop=function(){return this.data instanceof n.bind.Scop?this.data:null},e}(e);t.CostumizedShadow=C;var w=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.CreateShadow=function(t){return new C(document.createElement("option"),t)},e}(a);t.CostumizedTemplate=w;var S=function(t){function e(e,n){var i=t.call(this,e||document.createElement("select"),new w)||this;return i.Source=n,i}return __extends(e,t),e}(f);t.ComboBox=S;var O=function(t){function e(e,n){var i=t.call(this,document.createElement("select"))||this;return i.tree=e,i.getString=n,i}return __extends(e,t),e.prototype.initialize=function(){this.Reset()},e.prototype.Reset=function(){var t=this.tree;t.Reset();for(var e=t.getBases(),n=0;n<e.length;n++)this.add(this._view,e[n]);this._view.innerHTML=this._view.innerHTML},e.prototype.add=function(t,e){if(0===e.children.length){var n=document.createElement("option");return n.label=this.getString(e.Value),n.textContent=n.label,e.param=n,void t.appendChild(n)}var i=document.createElement("optgroup");i.label=this.getString(e.Value);var n=document.createElement("option");n.label=this.getString(e.Value),n.textContent=n.label,e.param=[i,n];for(var r=0;r<e.children.length;r++)this.add(i,e.children[r]);t.appendChild(i)},e}(t.JControl);t.TreeComboBox=O;var x;(function(t){function e(t,e,n){for(var r=0;r<e.length;r++){var o=e[r];"string"==typeof o.Header&&(o.Header={Content:o.Header});var s=i(o.Header,"th");if(n&&o.Header&&o.Header.OrderBy){var a={handleEvent:function(t){this.method.Invoke.apply(this.method.Owner,[this.method.Owner,this.col.Header.OrderBy,this.col,this.view])},method:n,col:clone(o),view:s};s.addEventListener("click",a)}t.appendChild(s)}return t}function n(t,e){e=e||document.createElement("tr");for(var n=0;n<t.length;n++){var r=t[n];"string"==typeof r.Header&&(r.Header={Content:r.Header}),e.appendChild(i(r.Cell,"td"))}return e}function i(t,e){var n,i=HTMLTableCellElement;return null==t.Content&&(t.Content=""),t.Content instanceof i?n=t.Content:t.Content instanceof Node?(n=document.createElement(e),n.appendChild(t.Content)):(n=document.createElement(e),t.ContentAsHtml?n.innerHTML=String(t.Content):n.innerText=String(t.Content)),t.Attributes&&r(n,t.Attributes),n}function r(t,e){for(var n in e){var i=e[n];if("object"==typeof i)if(t.hasAttribute(n)){var r=i.values.slice();r.unshift(t.getAttribute(n)),t.setAttribute(n,r.join(i.spliter))}else t.setAttribute(n,i.values.join(i.spliter));else t.setAttribute(n,i)}}t.createHeader=e,t.createTemplate=n,t.generateCell=i})(x=t.help||(t.help={}));var P=function(){function e(){t.Grid}return e}();t._Grid=P}(a=e.UI||(e.UI={})),function(t){(function(t){function e(e){var n=t.call(this,document.createElement("div"))||this;return n.target=e,n}return __extends(e,t),e.prototype.initialize=function(){},e.prototype.Close=function(t){this.applyStyle("ihide")},e.prototype.Open=function(t){if(!this._isOpen){this._isOpen=!1;var e=this._view;e.classList.remove("ihide");var n=t.View.getBoundingClientRect();e.style.left=n.left+"px",e.style.top=n.top+n.height+"px",e.style.width=n.width+"px",t.Box.Text=(t.Value||"").toString(),t.IsChanged=!1}},e})(t.JControl)}(a=e.UI||(e.UI={})),function(t){function e(){O.SelectedIndex--;var t=O.SelectedChild;t&&t.View.scrollIntoView(!1)}function r(){O.SelectedIndex++;var t=O.SelectedChild;t&&t.View.scrollIntoView(!1)}function s(t,e){O.SelectedIndex-=4;var n=O.SelectedChild;n&&n.View.scrollIntoView(!1)}function a(t,e){O.SelectedIndex+=4;var n=O.SelectedChild;n&&n.View.scrollIntoView(!1)}function u(){V.next()}function c(){V.previouse()}function l(t){return F?void(t.shiftKey&&(M.Value=null,S(!0))):f(t)}function p(){if(!F)return D=!1,S(!0)}function h(){D=!1,S(!1)}function d(t){return 8!==t&&(t<32||t>126&&t<160)}function f(t){if(!d(t.keyCode)){Date.now();A||(setTimeout(function(){o.helper.TryCatch(x,function(t){this.Filter.Patent=new t.list.StringPatent(M.Box.Text||"")},null,[i.filters]),A=!1,V.update()},200),A=!0)}}function y(){var e=document.createElement("ul");e.classList.add("popup","ihide"),O=new t.ListAdapter(e,k),O.OnInitialized=function(t){return t.Source=V.List},O.Parent=t.Desktop.Current,document.body.appendChild(O.View)}function v(e){clearTimeout(R),t.Desktop.Current.GetKeyControl(null,C,[e]),M!==e&&g(e)}function g(e){e.IsChanged=!1,M=e,x.Source=e.DataSource,o.thread.Dispatcher.call(null,function(){x.Filter.Patent=new i.filters.list.StringPatent(e.Box.Text)}),L&&L.Dispose(),j&&j.Dispose(),T=Date.now(),A=!1,t.Desktop.Current.GetKeyControl(null,C,[e]),j=M.Box.addEventListener("focusout",m,null)}function b(t){var e=O.View,n=t.View.getBoundingClientRect();e.style.left=n.left+"px",e.style.top=n.top+n.height+"px",e.style.width=n.width+"px"}function m(t,e,n){clearTimeout(R),R=setTimeout(_,500,!1),D=!1}function _(e){t.Desktop.Current.ReleaseKeyControl(),S(e)}function C(e,n){b(n);var i=e.keyCode;return F?9===i||13===i?n.View.hasAttribute("handleClose")?t.KeyboardControllerResult.Handled:t.KeyboardControllerResult.Release||t.KeyboardControllerResult.ByPass:27===i?(n.View.blur(),t.KeyboardControllerResult.Release):i===t.Keys.Delete?l(e):d(i)?t.KeyboardControllerResult.Handled:w(n,!0):9==i?(D=!1,S(!1),t.KeyboardControllerResult.Release):(N[e.keyCode]||f)(e,n)||t.KeyboardControllerResult.Handled}function w(e,n){if(v(e),e.AutoPopup||n){F=!1,O.Template=e.Template||k;try{O.SelectedIndex=0}catch(t){}var i=O.View;i.classList.remove("ihide"),b(e)}return t.KeyboardControllerResult.Handled}function S(e){return D?void(D=!1):(F=!0,O.applyStyle("ihide"),1==e&&(M.Value=O.SelectedItem),e?M.Box.Text=(M.Value||"").toString():null!=M.Value?M.Box.Text=M.Value.toString():M.Box.Text="",M.View.hasAttribute("handleClose")?t.KeyboardControllerResult.Handled:t.KeyboardControllerResult.ByPass)}var O,x,P=(function(){function e(){}return e.prototype.IsOpen=function(t){console.log("popup "+(t?"open":"close")),this._isopen=t},e.prototype.invoke=function(t){document.title="A"!==document.title?"A":"B"},e.prototype.onResume=function(t){return console.log("Resume"),!0},e.prototype.onPause=function(t){return console.log("Pause"),!0},e.prototype.onStop=function(t){return console.log("Stop"),!0},e.prototype.FocuseOn=function(e){this.box=e,t.Desktop.Current.KeyboardManager.GetController(this)},e.prototype.Blur=function(){t.Desktop.Current.KeyboardManager.Release(this)},e.prototype.del=function(t){t.shiftKey&&(M.Value=null,S(!0))},e.prototype.Close=function(t){},e.prototype.Open=function(t){},e}(),new i.filters.list.LStringFilter),I=document.createElement("li");I.innerHTML='<div db-job="tostring"></div>';var D,T,k=t.Template.ToTemplate(I,!0),A=!1,E=Date.now();x=new n.collection.ExList(null),x.Filter=P;var V=i.filters.list.indexdFilter(x,15);y(),O.OnItemSelected.On=function(t,e,n){e!=-1&&(D=!0,o.thread.Dispatcher.call(M.Box.View,M.Box.View.focus))},O.Content.addEventListener("click",function(t,e,n){D=!0,E-(E=Date.now())<-500||(E=0,M.Value=O.SelectedItem||M.Value,D=!1,S(!1))},O),O.Content.View.addEventListener("pointerenter",function(){return clearTimeout(R)}),O.Content.View.onmouseleave=function(t){D||(R=setTimeout(S,500,t)),D=!1};var R,L,j,M,N={40:r,38:e,37:s,39:a,13:p,27:h,33:c,34:u},F=!0,B=function(t){function e(e){var i=t.call(this,e)||this;return i.dataSource=new n.collection.List(Object),e.setAttribute("autocomplete","off"),i}return __extends(e,t),Object.defineProperty(e.prototype,"DataSource",{get:function(){return this.dataSource},set:function(t){t!==this.dataSource&&(this.IsChanged,this.dataSource.Clear(),t&&this.dataSource.AddRange(t.AsList()))},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){var e=this;t.prototype.initialize.call(this),this.Box.View.addEventListener("focusin",function(t){return v(e)})},e.prototype.Blur=function(){},e}(t.ActionText);t.AutoCompleteBox=B;var z=function(){function t(t,e){this.Box=t,this.callback=[],t.View.setAttribute("autocomplete","off"),this.DataSource=e}return t.prototype.Blur=function(){this.Box.Blur()},t.prototype.OnValueChanged=function(t,e){this.callback.push({Invoke:e,Owner:t})},Object.defineProperty(t.prototype,"View",{get:function(){return this.Box.View},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Value",{get:function(){return this._value},set:function(t){var e=this._value;if(t!=e){this._value=t,this.Box.Text=t?t.toString():"";for(var n=0,i=this.callback;n<i.length;n++){var r=i[n];r.Invoke.call(r.Owner,this,e,t)}}},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){var t=this;return this.Box.View.addEventListener("focusin",function(e){return v(t)}),this},t}();t.ProxyAutoCompleteBox=z}(a=e.UI||(e.UI={})),function(t){var e=function(e){function r(t,o,s){var a=e.call(this,o||document.createElement("div"))||this;if(a.countPerPage=t,a.full=s,a.paginationFilter=new i.filters.list.SubListFilter,a.paginationFilter.Patent=new i.filters.list.SubListPatent(0,a.countPerPage-1),s){var u=new n.collection.ExList(Object);u.Filter=a.paginationFilter,a.set(r.DPOutput,u)}return a}return __extends(r,e),Object.defineProperty(r.prototype,"Filter",{get:function(){return this.paginationFilter},enumerable:!0,configurable:!0}),r.prototype.initialize=function(){this.applyStyle("paginator"),e.prototype.Add.call(this,this.content=(new t.Div).applyStyle("fitHeight")),e.prototype.Add.call(this,this.paginator=new t.BiPagination),this.paginator.OnPropertyChanged(t.BiPagination.DPIndex,this.whenIndexChanged,this),this.paginationFilter.Patent=new i.filters.list.SubListPatent(0,this.countPerPage-1)},r.prototype.Refresh=function(){},Object.defineProperty(r.prototype,"Content",{set:function(t){this._cnt&&this.content.Remove(this._cnt,!0),this._cnt=t,t&&this.content.Add(t)},enumerable:!0,configurable:!0}),r.prototype.whenIndexChanged=function(t,e){this.paginationFilter.Patent=new i.filters.list.SubListPatent(e._new*this.countPerPage,(e._new+1)*this.countPerPage-1)},r.prototype.OnIndexChanged=function(e){return this.paginator.OnPropertyChanged(t.BiPagination.DPIndex,e,this)},r.prototype.OffIndexChanged=function(e){return this.paginator.removeEvent(t.BiPagination.DPIndex,e)},Object.defineProperty(r.prototype,"Max",{get:function(){return this.paginator.Max},set:function(t){this.paginator.Max=t},enumerable:!0,configurable:!0}),r.prototype.BindMaxToSourceCount=function(t){this.bm2sc=t.OnPropertyChanged(n.collection.ExList.DPCount,function(t,e){this.paginator.Max=Math.floor(e._new/this.countPerPage)},this),this.paginator.Max=Math.floor(t.Count/this.countPerPage)},r.prototype.UnbindMaxFromSourceCount=function(t){this.bm2sc&&t.removeEvent(n.collection.List.DPCount,this.bm2sc)},r.prototype.Next=function(){this.paginator.Index++},r.prototype.Previous=function(){this.paginator.Index--},r.prototype.OnKeyCombined=function(t,e){var n=this.Content;if(n)return n.OnKeyCombined(t,e)},r.prototype.OnKeyDown=function(n){var i=this._cnt;if(i&&i.OnKeyDown(n))return!0;switch(n.keyCode){case t.Keys.Left:return this.Previous(),!0;case t.Keys.Right:return this.Next(),!0}return e.prototype.OnKeyDown.call(this,n)},Object.defineProperty(r.prototype,"Output",{get:function(){return this.get(r.DPOutput)},enumerable:!0,configurable:!0}),r.prototype.OnInputChanged=function(t){t._old&&this.bindInputToMax&&t._old.removeEvent(n.collection.List.DPCount,this.bindInputToMax),this.bindInputToMax=null,this.Output.Source=t._new,t._new&&(this.bindInputToMax=t._new.OnPropertyChanged(n.collection.ExList.DPCount,function(t,e){this.paginator.Max=Math.floor(e._new/this.countPerPage)},this),this.paginator.Max=Math.floor(t._new.Count/this.countPerPage))},Object.defineProperty(r.prototype,"InputScop",{set:function(t){var e=this;this.bindInputToMax&&(this.bindScopToInput.Owner.removeEvent(n.bind.Scop.DPValue,this.bindScopToInput),this.bindScopToInput=null),this.bindScopToInput=t.OnPropertyChanged(n.bind.Scop.DPValue,function(t,n){e.Input=n._new},t),this.Input=t.Value},enumerable:!0,configurable:!0}),r.__fields__=function(){return[this.DPInput,this.DPOutput]},r.createPaginator=function(e,n,i){void 0===i&&(i=10);var r=new t.Paginator(i,void 0,!0);return r.OnInitialized=function(t){e.OnInitialized=function(e){t.Input=n,e.Source=t.Output},r.Content=e},r.OnPropertyChanged(this.DPOutput,function(t,n){e.Source=n._new}),r},r.DPInput=n.bind.DObject.CreateField("Input",n.collection.List,null,r.prototype.OnInputChanged),r.DPOutput=n.bind.DObject.CreateField("Output",n.collection.ExList),r}(t.JControl);t.Paginator=e}(a=e.UI||(e.UI={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initialize=function(){this._view.classList.add("grid")},e.prototype.createRule=function(){document.styleSheets.item(document.styleSheets.length-1)},e}(t.JControl);t.Grid=e}(a=e.UI||(e.UI={})),function(t){function e(t){n.basic.Settings.set("show-sp-tooltips",t),t?document.body.classList.add("sp-show"):document.body.classList.remove("sp-show")}var i=function(t){function e(e){var n=t.call(this)||this;return n.Title=e,n}return __extends(e,t),e.__fields__=function(){return[this.DPTitle,this.DPIcon]},e.DPTitle=n.bind.DObject.CreateField("Title",String,null),e.DPIcon=n.bind.DObject.CreateField("Icon",String,null),e}(n.bind.DObject);t.StrechyButtonItemData=i;var r=function(t){function e(e){var n=t.call(this,"controls.StretchyButton","controls.StretchyButtonItem")||this;return n.__data=e,n}return __extends(e,t),e.prototype.initialize=function(){this.triggerButton=$(".cd-nav-trigger",this._view)[0],this.triggerButton.addEventListener("click",this),this.Source=this.__data},e.RegisterEvents=function(t){this.EventCloseIsRegistered!=t&&(t?document.addEventListener("click",this.handleEvent):document.removeEventListener("click",this.handleEvent),this.EventCloseIsRegistered=t)},e.CloseAll=function(t){for(var n=0;n<e.OpenedStrechyButtons.length;n++){var i=e.OpenedStrechyButtons[n];i.simpleClose()}e.OpenedStrechyButtons=[],this.RegisterEvents(t)},e.prototype.Open=function(){e.CloseAll(!0),e.OpenedStrechyButtons=[this],this.simpleOpen()},e.prototype.Close=function(){e.CloseAll(!1)},e.prototype.simpleClose=function(){this.IsOpen=!1,this._view.classList.remove("nav-is-visible"),this._view.classList.add("cd-stretchy-nav-collapsed")},e.prototype.simpleOpen=function(){this.IsOpen=!0,this._view.classList.add("nav-is-visible"),this._view.classList.remove("cd-stretchy-nav-collapsed")},e.handleEvent=function(t){var n=t.target,i=n.classList;i.contains("cd-nav-trigger")||i.contains("cd-nav-trigger")||"SPAN"===n.tagName||e.CloseAll(!1)},e.prototype.handleEvent=function(t){t.preventDefault(),this.IsOpen?this.Close():this.Open()},e.OpenedStrechyButtons=[],e}(t.ListAdapter);t.StrechyButton=r;var o=function(t){function e(e){var n=t.call(this,e)||this;return n.inputEl=e.querySelector("form > input.sb-search-input"),n}return __extends(e,t),e.prototype.initialize=function(){var t=this,e=function(e){return t.validate(e)};this._view.addEventListener("click",e),this._view.addEventListener("touchstart",e),this.inputEl.addEventListener("click",function(t){t.stopPropagation()}),this.inputEl.addEventListener("touchstart",function(t){t.stopPropagation()}),this.inputEl.addEventListener("keydown",this)},e.prototype.handleEvent=function(t){13==t.keyCode?this.validate(t):27==t.keyCode&&(""==this.inputEl.value?this.close():(this.inputEl.value="",t.stopImmediatePropagation(),t.preventDefault()))},e.prototype.validate=function(t){t.stopPropagation(),this.inputEl.value=this.inputEl.value.trim(),this._view.classList.contains("sb-search-open")?/^\s*$/.test(this.inputEl.value)?(t.preventDefault(),this.close()):this.OnSearch&&this.OnSearch(this.inputEl.value):(t.preventDefault(),this.open())},e.prototype.open=function(){var t=this;this.applyStyle("sb-search-open"),this.IsOpen=!0,this.inputEl.focus&&this.inputEl.focus();var e=function(n){t.close(),this.removeEventListener("click",e),this.removeEventListener("touchstart",e)};document.addEventListener("click",e),document.addEventListener("touchstart",e)},e.prototype.close=function(){this.inputEl.blur(),this.disapplyStyle("sb-search-open"),this.IsOpen=!1},e}(t.JControl);t.UISearch=o,t.showSPTooltips=e,e(n.basic.Settings.get("show-sp-tooltips"))}(a=e.UI||(e.UI={})),function(t){var e;(function(e){function i(t,e,n,i,r){var o=document.createElement(t);o.classList.add("btn","btn-"+i,"glyphicon","glyphicon-"+e),o.textContent="  "+n;for(var s in r)o.setAttribute(s,r[s]);return o}e.CreateGlyph=i;var r=function(){function t(){}return t}();e.ModalEditorEventArgs=r;var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scop=new n.bind.ValueScop(null,3),e}return __extends(e,t),
e.__fields__=function(){return[this.DPIsEditable]},Object.defineProperty(e.prototype,"Data",{get:function(){return this.scop.Value},set:function(t){this.scop.Value=t},enumerable:!0,configurable:!0}),e.prototype.OnKeyDown=function(e){return this.Content&&this.Content.OnKeyDown(e)||t.prototype.OnKeyDown.call(this,e)},e.DPIsEditable=n.bind.DObject.CreateField("IsEditable",Boolean,!0),e}(t.Modal);e.BasicModalEditor=s;var a=function(e){function i(t,n){var i=e.call(this)||this;return i.templateName=t,i.allowEditNullVaue=n,i}return __extends(i,e),i.prototype.initialize=function(){e.prototype.initialize.call(this),this.Content=new t.TControl(this.templateName,this.scop)},i.prototype.edit=function(n,i,r,o){if(void 0===o&&(o=!0),n||this.allowEditNullVaue){if(this.IsOpen||this._isOpen)throw new c("The editor is Open. Close it first .");this._isOpen=!0,this.IsNew=i,void 0!==n&&(this.scop.Value=n),this.backupData=n&&n.CreateBackup(),this.action=r,this.IsEditable=o,e.prototype.Open.call(this),this.SetVisible(t.MessageResult.ok,o)}},i.prototype.Open=function(){this.edit(this.scop.Value,this.IsNew,this.action)},i.prototype.Close=function(e){var i=new t.MessageEventArgs(this,e,t.MessageResult[e]),r=this.scop.Value,s={Data:r,BackupData:this.backupData,E:i,Editor:this,IsDataChanged:r&&r.IsPropertiesChanged(this.backupData),IsNew:this.IsNew,Error:n.basic.DataStat.None};o.reflection.Invoke(this.action,this,[this,s]),r&&this.backupData&&!s.CommitOrBackupHandled&&("ok"==i.msg&&this.IsEditable?r.Commit(s.BackupData):r.Rollback(s.BackupData));this.OnClosed.PInvok("test",[i],this);i.stayOpen||this.silentClose()},i.prototype.NativeClose=function(e,n){var i=new t.MessageEventArgs(this,e,t.MessageResult[e]),r=this.scop.Value;r&&(this.backupData&&n?r.Commit(this.backupData):r.Rollback(this.backupData)),this.OnClosed.PInvok("test",[i],this),i.stayOpen||this.silentClose()},i.prototype.silentClose=function(){this._isOpen=!1,e.prototype.silentClose.call(this)},i}(s);e.EModalEditer=a;var u=function(e){function n(t){var n=e.call(this)||this;return n.templateName=t,n}return __extends(n,e),n.prototype.initialize=function(){var n=this;e.prototype.initialize.call(this),this.Content=new t.TControl(this.templateName,this.scop),this.OnClosed.On=function(t){var e=n.scop.Value,i=!1;return"ok"===t.msg&&n.IsEditable===!0&&(n.ChangedStatControled||e.IsPropertiesChanged(n.backupData))?(n.Action.OnSuccess&&(i=n.Action.OnSuccess.Invoke.call(n.Action.OnSuccess.Owner,e,n.IsNew,t)),i||e.Commit(n.backupData),void(n.IsNew=!1)):(n.Action.OnError&&(i=n.Action.OnError.Invoke.call(n.Action.OnError.Owner,e,n.IsNew,t)),void(i||e.Rollback(n.backupData)))}},n.prototype.edit=function(n,i,r,o){void 0===o&&(o=!0),n&&(this.IsNew=i,void 0!==n&&(this.scop.Value=n),this.backupData=n.CreateBackup(),this.Action=r||l,this.IsEditable=o,e.prototype.Open.call(this),this.SetVisible(t.MessageResult.ok,o))},n.prototype.Open=function(){this.edit(this.scop.Value,this.IsNew,this.Action)},n}(s);e.ModalEditer=u;var l={},p=function(){function t(t,e){this.proxyAction=t,this.callback=e,this.OnSuccess={Owner:this,Invoke:this.onSuccess},this.OnError={Owner:this,Invoke:this.onError}}return t.prototype.invoke=function(t,e,n){if(t&&t.Invoke)return t.Invoke.call(t.Owner,e,n,this.callback)},t.prototype.onSuccess=function(t,e){return this.invoke(this.proxyAction.OnSuccess,t,e)},t.prototype.onError=function(t,e){return this.invoke(this.proxyAction.OnError,t,e)},t.prototype.Clone=function(e){return new t(this.proxyAction,e)},t.Create=function(e,n,i,r){if(n||i){var o={};return n&&(o.OnSuccess={Owner:e,Invoke:n}),i&&(o.OnError={Owner:e,Invoke:i}),new t(o,r)}},t}();e.EditorAction=p})(e=t.Modals||(t.Modals={}))}(a=e.UI||(e.UI={})),function(t){var e;(function(e){var r=function(e){function r(t,n,i,r,o,s){var a=e.call(this)||this;return a.source=t,a.tableTmplate=n,a.itemTemplate=i,a.datas=r,a.asScopic=o,a.isMatch=s,a}return __extends(r,e),r.IsMatch=function(t,e){return t.Check(e)},Object.defineProperty(r.prototype,"IsMatch",{get:function(){return this.isMatch},set:function(t){if(this._exList){var e=this._exList.Filter;if(e._isMatch===t)return;e._isMatch=t,this._exList.Reset()}this.isMatch=t},enumerable:!0,configurable:!0}),r.prototype.initialize=function(){var o=this;e.prototype.initialize.call(this);var s,a=this.Datacontext=new t.ListAdapter(this.tableTmplate,this.itemTemplate,this.datas,this.asScopic);a.AcceptNullValue=!0,this.isMatch&&this.createFilter();var u=(new t.Div).applyStyle("row"),c=(new t.Div).applyStyle("row"),l=new t.ActionText;l.AutoAction=t.SearchActionMode.Instantany;var p=(new t.Div).applyStyle("col-md-12","col-xs-12","col-sm-12");l.View.style.maxWidth="none",l.View.style.width="100%",p.View.style.padding="0",p.Add(l),u.Add(p),this.asScopic?c.Add(a):(this._exList=n.collection.ExList.New(this.source,new i.filters.list.BoundStringFilter),this.paginator=s=r.createPaginator(a,this._exList),c.Add(s)),this.Add(u),this.Add(c),l.OnAction.On=function(t,e,n){o._exList.Filter.Patent=new i.filters.list.StringPatent(n)},a.OnItemSelected.On=function(t,e,n){return o.SelectedItem=n&&n.getDataContext()}},r.createPaginator=function(e,n){var i=new t.Paginator(12,void 0,!0);return n=n||e.Source,i.OnInitialized=function(t){e.OnInitialized=function(n){return e.Source=t.Output},i.Content=e,i.Input=n},i},Object.defineProperty(r.prototype,"SelectedItem",{get:function(){return this.Datacontext&&this.Datacontext.SelectedItem},set:function(t){this.Datacontext&&this.Datacontext.SelectItem(t)},enumerable:!0,configurable:!0}),r.prototype.show=function(t,n){var i=this;n&&(this.OnInitialized=function(t){return i._exList.Source=n}),this.onc=t,e.prototype.Open.call(this)},Object.defineProperty(r.prototype,"Source",{set:function(t){this.OnInitialized=function(e){return e._exList.Source=t}},enumerable:!0,configurable:!0}),r.prototype.Open=function(){},r.prototype.OnKeyCombined=function(t,e){return this.paginator.OnKeyCombined(t,e)},r.prototype.OnKeyDown=function(t){if(!this.paginator.OnKeyDown(t))return e.prototype.OnKeyDown.call(this,t)},r.prototype.Close=function(t){var n=this.onc,i=this.SelectedItem;this.onc=null,e.prototype.Close.call(this,t);try{this.Datacontext.SelectedIndex=-1}catch(t){}n&&n.call(this,this,i,t)},r.prototype.createFilter=function(){var t=this,e=this.Datacontext.Content.View;this._exList=new n.collection.ExList(Object),this._exList.Filter=new n.utils.CostumeFilter(this.IsMatch);var r=n.basic.New()+"";e.setAttribute("db-filter",r),n.bind.RegisterFilter({Name:r,BindingMode:1,CreateNew:function(e,n,r){return new i.filters.scopic.ListFilter(e,null,t._exList)}})},r}(t.Modal);e.ModalList=r})(e=t.Modals||(t.Modals={}))}(a=e.UI||(e.UI={})),function(t){var e=function(e){function i(t,i,r){var o=e.call(this,t,i)||this;return o.Items=new n.collection.List(Object,r),o}return __extends(i,e),i.__fields__=function(){return[this.DPItems,this.DPSelectedItem,this.DPTabContent,this.DPTabNav]},i.prototype.initialize=function(){var n=this;e.prototype.initialize.call(this),this.TabNav=new t.ListAdapter("tabcontrol.navTabsItem",void 0),this.TabContent=(new t.ContentControl).applyStyle("tab-content"),this.TabNav.AcceptNullValue=!1,e.prototype.Add.call(this,this.TabNav),e.prototype.Add.call(this,this.TabContent),this.TabNav.OnItemSelected.On=function(t,e,i,r,o){return n.onSelectedTabChanged(e,r,i,o)},this.TabNav.OnInitialized=function(t){t.Source=n.Items,o.thread.Dispatcher.call(n,function(){this.SelectedIndex=0})}},i.prototype.OnBringIntoFront=function(){this.TabNav.SelectedIndex=0},i.prototype.onSelectedTabChanged=function(t,e,n,i){var r=this.Items.Get(t);r?(this.TabContent.Content=r.Content,r.OnSelected&&r.OnSelected(this,r)):this.TabContent.Content=null,this.SelectedItem=r},i.prototype.Reslect=function(){var t=this.TabNav.SelectedItem;t?(this.TabContent.Content=t.Content,t.OnSelected&&t.OnSelected(this,t)):this.TabContent.Content=null,this.SelectedItem=t},i.prototype.OnKeyCombined=function(t,e){var n=this.SelectedItem;if(n)return n.Content&&n.Content.OnKeyCombined(t,e)},i.prototype.OnKeyDown=function(e){var n=this.SelectedItem;if(e.ctrlKey){var i=e.shiftKey?1:-1;switch(e.keyCode){case t.Keys.Left:return this.TabNav.SelectedIndex+=i,!0;case t.Keys.Right:return this.TabNav.SelectedIndex-=i,!0}}if(n&&n.Content)return n.Content.OnKeyDown(e)},i.prototype.CloseTab=function(t,e,n,i){var r=e.controller.MainControll.getDataContext();r&&this.Items.Remove(r)},i.DPItems=n.bind.DObject.CreateField("Items",n.collection.List),i.DPTabNav=n.bind.DObject.CreateField("TabNav",t.ListAdapter),i.DPTabContent=n.bind.DObject.CreateField("TabContent",t.ContentControl),i.DPSelectedItem=n.bind.DObject.CreateField("SelectedItem",Object,null,function(t){t.__this.TabNav.SelectedIndex=t.__this.Items.IndexOf(t._new)}),i}(t.NavPanel);t.TabControl=e;var i=function(e){function i(t,i,r,o,s){var a=e.call(this,t,i)||this;return a.content=o,a.onSelectedItemChanged=s,a.OnTabSelected=new n.bind.EventListener(0),a.OnTabClosed=new n.bind.EventListener(0),a.Items=r,a}return __extends(i,e),i.__fields__=function(){return[this.DPItems,this.DPSelectedItem,this.DPTabContent,this.DPTabNav]},i.prototype.initialize=function(){var i=this;e.prototype.initialize.call(this),this.TabNav=new t.ListAdapter("unitabcontrol.navTabsItem",void 0),this.TabContent=(new t.ContentControl).applyStyle("tab-content"),this.TabNav.AcceptNullValue=!1,e.prototype.Add.call(this,this.TabNav),e.prototype.Add.call(this,this.TabContent),this.TabNav.OnItemSelected.On=function(t,e,n,r,o){return i.onSelectedTabChanged(e,r,n,o)},this.TabNav.OnInitialized=function(t){t.Source=i.Items,t.SelectedIndex=0},this.TabContent.Content=this.content,this.Items.Listen=function(t){if(t.event==n.collection.CollectionEvent.Removed){var e={Sender:i,Cancel:!1,Stat:"closed",Target:t.newItem};i.OnTabClosed.PInvok(0,[e])}}},i.prototype.onSelectedTabChanged=function(t,e,n,i){var r=this.Items.Get(t);r&&this.content?(this.content.Visible=!0,this.TabContent.Content=this.content,r.Title=this.onSelectedItemChanged(this,this.content,r),r.OnSelected&&r.OnSelected(this,r)):this.TabContent.Content=null,this.SelectedItem=r},i.prototype.OnKeyCombined=function(e,n){var i=this.SelectedItem;if(i=i.Content,i instanceof t.JControl)return i.OnKeyCombined(e,n)},i.prototype.OnKeyDown=function(e){this.SelectedItem;if(e.ctrlKey){var n=e.shiftKey?1:-1;switch(e.keyCode){case t.Keys.Left:return this.TabNav.SelectedIndex+=n,!0;case t.Keys.Right:return this.TabNav.SelectedIndex-=n,!0}}if(this.content)return this.content.OnKeyDown(e)},i.prototype.CloseTab=function(t,e,n,i){var r=e.controller.MainControll.getDataContext();if(r){var o={Sender:this,Cancel:!1,Stat:"closing",Target:r};if(this.OnTabClosed.PInvok(0,[o]),o.Cancel)return;this.Items.Remove(r),r.Dispose&&r.Dispose(!0)}},i.prototype.GetLeftBar=function(){if(this.content.GetLeftBar)return this.content.GetLeftBar()},i.prototype.GetRightBar=function(){if(this.content.GetRightBar)return this.content.GetRightBar()},i.prototype.OnPrint=function(){return this.content.OnPrint?this.content.OnPrint():void e.prototype.OnPrint.call(this)},i.prototype.Update=function(){return this.content.Update?this.content.Update():void e.prototype.Update.call(this)},i.prototype.OnSearche=function(t,e){if(this.content.OnSearche)return this.content.OnSearche(t,e)},i.prototype.OnDeepSearch=function(){if(this.content.OnDeepSearch)return this.content.OnDeepSearch()},Object.defineProperty(i.prototype,"HasSearch",{get:function(){var t=this.content.HasSearch;if(void 0!=t)return t},enumerable:!0,configurable:!0}),i.DPItems=n.bind.DObject.CreateField("Items",n.collection.List),i.DPTabNav=n.bind.DObject.CreateField("TabNav",t.ListAdapter),i.DPTabContent=n.bind.DObject.CreateField("TabContent",t.ContentControl),i.DPSelectedItem=n.bind.DObject.CreateField("SelectedItem",Object,null,function(t){t.__this.TabNav.SelectedIndex=t.__this.Items.IndexOf(t._new)}),i}(t.NavPanel);t.UniTabControl=i;var r=function(t){function e(e,n){var i=t.call(this)||this;return i.Title=e,i.Content=n,i}return __extends(e,t),e.__fields__=function(){return[this.DPContent,this.DPTitle]},e.DPTitle=n.bind.DObject.CreateField("Title",String),e.DPContent=n.bind.DObject.CreateField("Content",Object),e}(n.bind.DObject);t.TabControlItem=r}(a=e.UI||(e.UI={}));var l;(function(e){function i(t){if(t.dom.hasAttribute("as-pager"))return t.dom.removeAttribute("as-pager"),s(t);var e=new a.ListAdapter(t.dom,void 0,t.parentScop);return e.BindTo(t.currentScop),t.Result=e,e}function s(t){var e=t.dom;e.hasAttribute("as-pager")&&e.removeAttribute("as-pager"),e.setAttribute("compiled","");var i=e.getAttribute("count-per-page");i=i?parseInt(i)||24:24;var r=new a.Paginator(i,e,!0);r.Parent=t.parentControl||a.Desktop.Current,r.InputScop=t.currentScop;var o=$("[db-content]",e)[0];if(o&&o!==e){e.removeAttribute("db-content");var s=n.bind.Scop.Create("Output",r,n.bind.BindingMode.TwoWay,t.controller);o.hasAttribute("db-foreach")||o.setAttribute("db-foreach","");var u=t.controller.CompileChild(o,s,r),c=u.Control;c||(c=new a.Dom(u.Dom||o)),r.Content=c}return r}function u(){}function c(t,e,n){o.thread.Dispatcher.InIdle()&&o.thread.Dispatcher.call(null,u),h.push({A:t,B:e,C:n})}function l(){for(var t=h.splice(0),e=0;e<t.length;e++){var n=t[e];n.C?n.A.classList.remove.apply(n.A.classList,n.B):n.A.classList.add.apply(n.A.classList,n.B)}0!==h.length&&l()}function p(e,n){for(var i=["../assets/style/bundle.css"],o=0,s=i;o<s.length;o++){var a=s[o];t("style|"+a,e,n,r.context)}}var h=[];n.ScopicControl.register("foreach",i),n.ScopicControl.register("pager",s),n.ScopicControl.register("adapter",i),e.RegisterLayout=c,o.thread.Dispatcher.OnIdle(null,l),e.loadCss=p})(l||(l={})),e.LoadDefaultCSS=function(t,e){l.loadCss(t,e)}}),define("sys/System",["require","exports","sys/Corelib","context"],function(t,e,n,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,o,s={},a=new n.collection.Dictionary("Apis",!1);(function(t){function e(t){Object.freeze(t),Object.defineProperty(s,t.Name,{configurable:!1,enumerable:!1,value:t,writable:!1})}function i(t){return t}t.Register=e,t.decorator=i;var o=function(){function t(t){this._methodsShema={},a.Set(this.GetType(),this)}return t.prototype.Register=function(t){t.Name=t.Name.toUpperCase(),"string"==typeof t.ParamsFormat&&(t.ParamsFormat=n.basic.CompileString(t.ParamsFormat)),this._methodsShema[t.Name]=t},t.prototype.ERegister=function(t,e,i,r){this.Register({Method:t,Name:e,ParamsFormat:i&&n.basic.CompileString(i),SendData:r})},t.prototype.GetMethodShema=function(t){if("string"==typeof t)return this._methodsShema[t.toUpperCase()];if("number"!=typeof t){if(t&&!t.Name)return t;for(var e in this._methodsShema)return this._methodsShema[e]}else{var i=this._methodsShema[n.net.WebRequestMethod[t].toUpperCase()];if(null!=i)return i;for(var e in this._methodsShema){var r=this._methodsShema[e];if(r.Method===t)return r}}},t}();t.Api=o;var u=function(t){function e(e,n,i){var r=t.call(this)||this;return r._type=e,r._getRequest=n,r._onResponse=i,r}return __extends(e,t),e.prototype.GetType=function(){return this._type},e.prototype.GetRequest=function(t){return this._getRequest(t)},e.prototype.OnResponse=function(t,e){return this._onResponse(t,e)},e}(o);t.CostumeApi=u;var c=function(t){function e(e,n,i,r,o,s){var a=t.call(this,null,e,!0)||this;return a.param=n,a.api=i,a.context=r,a.callBack=o,a.method=s,a}return __extends(e,t),e.parse=function(t){if(null==t||""==t.trim())return null;try{return JSON.parse(t)}catch(t){return null}},e.prototype.Callback=function(t,i){var r=!0;try{var o=t.Request.IsSuccess?e.parse(i.Response):null;if(o&&o.hasOwnProperty("__service__")){var a=o;if(a.__service__){var u=s[a.__service__];if(u&&u.OnResponse(this,t,a),a.dropRequest)return}r=a.iss,o=a.rdata}this.api&&this.api.OnResponse(o,this.data,this.context||n.encoding.SerializationContext.GlobalContext)}catch(t){r=!1}this.callBack&&this.callBack(this,o,r&&this.IsSuccess,i)},e.prototype.OutputData=function(){if("string"==typeof this.data)return this.data;if(this.data instanceof ArrayBuffer)return this.data;var t=null==this.context,e=t?new n.encoding.SerializationContext(!0):this.context.reset(),i=e.ToJson(this.data);return t&&e.Dispose(),JSON.stringify(i)},e}(n.net.RequestParams);t.ProxyCallback=c;var l=function(){function t(t,e){if(this.quee=[],null!=r)throw null;this.http=new n.net.QueeDownloader(t),this.apis=e?new n.collection.Dictionary("Apis",!1):a}return t.prototype.SetAuth=function(t,e){this.http.Uid=t,this.http.Pwd=e},Object.defineProperty(t.prototype,"Crypto",{set:function(t){this.http.Crypto=t},enumerable:!0,configurable:!0}),t.prototype.Register=function(t){this.apis.Set(t.GetType(),t)},t.getMethod=function(t,e){if("number"==typeof e)return e;if("string"==typeof e){var i=t.GetMethodShema(e);return i?i.Method:0}return i.Name?n.net.WebRequestMethod[e.Name]||0:0},t.prototype.Costume=function(t,e,i,r,o){return this.http.Push(t,new c(e,o,void 0,n.encoding.SerializationContext.GlobalContext,r),i)},t.prototype.Request=function(e,i,r,o,s,a,u,l){var p=this.apis.Get(null!=e?e:r.constructor),h=new c(r,l,p,n.encoding.SerializationContext.GlobalContext,s,t.getMethod(p,i)),d=p.GetRequest(r,i,o);d.beforRequest=u,a&&a(d,h),this.http.Push(d,h,null)},t.prototype.Push=function(t,e,i,r,o,s,a,u,l){var p=this.apis.Get(null!=t?t:e.constructor),h=new c(e,i,p,a||new n.encoding.SerializationContext(!0)||n.encoding.SerializationContext.GlobalContext,r),d=p.GetRequest(e,null,l);d.HasBody=!0,d.beforRequest=u,void 0!=o&&(d.Method=o),s&&s(d,h),this.http.Push(d,h,l)},t.prototype.Post=function(t,e,i,r,o,s,a){var u=this.apis.Get(null!=t?t:e.constructor),l=new c(e,i,u,s||n.encoding.SerializationContext.GlobalContext,r),p=u.GetRequest(e,null,a);p.HasBody=!0,p.Method=n.net.WebRequestMethod.Post,o&&o(p,l),this.http.Push(p,l,a)},t.prototype.Put=function(t,e,i,r,o,s,a){var u=this.apis.Get(null!=t?t:e.constructor),l=new c(e,i,u,s||n.encoding.SerializationContext.GlobalContext,r),p=u.GetRequest(e,null,a);p.HasBody=!0,p.Method=n.net.WebRequestMethod.Put,o&&o(p,l),this.http.Push(p,l,a)},t.prototype.Get=function(t,e,i,r,o,s,a){var u=this.apis.Get(null!=t?t:e.constructor),l=new c(e,i,u,s||n.encoding.SerializationContext.GlobalContext,r),p=u.GetRequest(e,null,a);p.Method=n.net.WebRequestMethod.Get,o&&o(p,l),this.http.Push(p,l,a)},t.prototype.Delete=function(t,e,i,r,o,s,a){var u=this.apis.Get(null!=t?t:e.constructor),l=new c(e,i,u,s||n.encoding.SerializationContext.GlobalContext,r),p=u.GetRequest(e,null,a);return p.Method=n.net.WebRequestMethod.Delete,o&&o(p,l),this.http.Push(p,l,a),p},Object.defineProperty(t,"Default",{get:function(){return r||(r=new t(n.basic.Crypto,!1))},enumerable:!0,configurable:!0}),t}();t.ProxyData=l})(o=e.Controller||(e.Controller={}));var u;(function(t){var e;(function(t){t[t.IsNew=0]="IsNew",t[t.Modified=1]="Modified",t[t.Saved=2]="Saved",t[t.Updating=4]="Updating",t[t.Uploading=8]="Uploading",t[t.Updated=16]="Updated",t[t.Frozed=32]="Frozed"})(e=t.DataStat||(t.DataStat={}));var r=new n.collection.Dictionary("sd"),s=function(t){function s(e){var n=t.call(this)||this,i=n.getStore();if(e&&i){if(null!=i.Get(e))return i.Get(e);n.set(s.DPId,e)}return n}return __extends(s,t),Object.defineProperty(s.prototype,"Stat",{get:function(){return this.get(s.DPStat)},set:function(t){this.set(s.DPStat,t)},enumerable:!0,configurable:!0}),s.CreateFromJson=function(t,e,n){if(n)return null;var i="number"==typeof t?t:t.Id;if(!n&&"number"==typeof i)var o=e.getById(i,e);if(!o){var s=r.Get(e);s&&(o=s.CreateNew(i)),o||(o=new e(i))}return o},s.prototype.OnIdChanged=function(t,e){var n=this.getStore();t&&n.Remove(t),e&&n.Set(e,this)},Object.defineProperty(s.prototype,"Id",{get:function(){return this.get(s.DPId)},set:function(t){this.set(s.DPId,t)},enumerable:!0,configurable:!0}),s.__fields__=function(){return[s.DPId,this.DPLastModified,s.DPStat]},s.getById=function(t,e){},s.prototype.FromJson=function(n,i,r){var a=this;if("number"==typeof n){if(this.Stat>=e.Updating)return this;this.Id=n,this.set(s.DPStat,e.Updating),o.ProxyData.Default.Request(this.constructor,"UPDATE",this,this,function(){return!(a.Stat>e.Updating)})}else this.set(s.DPStat,e.Updated),t.prototype.FromJson.call(this,n,i,r),null!=n&&1==n.IsFrozen&&this.Freeze();return this},Object.defineProperty(s.prototype,"TableName",{get:function(){return i.context.NameOf(this.constructor).replace("models.","")},enumerable:!0,configurable:!0}),s.DPId=n.bind.DObject.CreateField("Id",Number,0,function(t){t.__this.OnIdChanged(t._old,t._new)},function(t){null!=t._new&&0!==t._new||(t._new=n.basic.New())},n.bind.PropertyAttribute.IsKey),s.DPStat=n.bind.DObject.CreateField("Stat",Number,0,null,null,n.bind.PropertyAttribute.Private|n.bind.PropertyAttribute.NonSerializable),s.DPLastModified=n.bind.DObject.CreateField("LastModified",Date),s}(n.bind.DObject);t.DataRow=s;var a=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.__fields__=function(){return[]},e.prototype.GenType=function(){return e},Object.defineProperty(e,"QueryApi",{get:function(){return this._QueryApi},enumerable:!0,configurable:!0}),e.prototype.Update=function(){},e.prototype.Upload=function(){},e}(t.DataRow);t.QShopRow=a;var u=function(i){function r(t,e,n,r){var o=i.call(this,e,r)||this;return o._parent=t,o.ctor=n,o.Owner=t,o}return __extends(r,i),r.__fields__=function(){return[r.DPOwner]},Object.defineProperty(r.prototype,"Owner",{get:function(){return this.get(r.DPOwner)},set:function(t){this.set(r.DPOwner,t)},enumerable:!0,configurable:!0}),r.prototype.CreateNewItem=function(t){return s.getById(t,this.ArgType)||this.ctor(t)},r.prototype.FromJson=function(n,o,s,a){if(this.Stat!=t.DataStat.Frozed){this.set(r.DPStat,e.Updating);i.prototype.FromJson.call(this,n,o,s,a);return this.set(r.DPStat,e.Updated),null==n?this:(null!=n&&1==n.IsFrozen&&this.Freeze(),this)}},r.prototype.GetById=function(t){for(var e=this.AsList(),n=s.DPId,i=0,r=e.length;i<r;i++)if(e[i].GetValue(n)===t)return e[i]},r.prototype.Update=function(){},r.prototype.Upload=function(){},r.prototype.Add=function(t){return this._list.indexOf(t)==-1?i.prototype.Add.call(this,t):this},r.prototype.FromCsv=function(t,e,i){var r=new n.encoding.CSV(t,!0,!0),o=r.ColumnIndex("Id");o==-1&&(o=void 0),e=e||n.encoding.SerializationContext.GlobalContext;for(var s=[];r.Next(i);){var a=r.Current,u=this.CreateNewItem(void 0===o?n.basic.New():a.Id||n.basic.New());s.push(u.FromJson(a,e))}this.AddRange(s)},r.DPOwner=r.CreateField("Owner",s,null,null,null,n.bind.PropertyAttribute.SerializeAsId),r.DPStat=n.bind.DObject.CreateField("Stat",Number,0,null,null,n.bind.PropertyAttribute.Private),r}(n.collection.List);t.DataTable=u})(u=e.sdata||(e.sdata={}));var c;(function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"From",{get:function(){return this.get(e.DPFrom)},set:function(t){this.set(e.DPFrom,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"To",{get:function(){return this.get(e.DPTo)},set:function(t){this.set(e.DPTo,t)},enumerable:!0,configurable:!0}),e.__fields__=function(){return[e.DPFrom,e.DPTo]},e.prototype.Check=function(t){if(!u)return!0;var e=this.From,n=this.To,i=t.getTime();return(null==e||e.getTime()<=i)&&(null==n||n.getTime()>=i)},e.DPFrom=n.bind.DObject.CreateField("From",Date),e.DPTo=n.bind.DObject.CreateField("To",Date),e}(n.bind.DObject);t.DateVecteur=e;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"From",{get:function(){return this.get(e.DPFrom)},set:function(t){this.set(e.DPFrom,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"To",{get:function(){return this.get(e.DPTo)},set:function(t){this.set(e.DPTo,t)},enumerable:!0,configurable:!0}),e.__fields__=function(){return[e.DPFrom,e.DPTo]},e.prototype.Check=function(t){return!t||(null==this.From||this.From<=t)&&(null==this.To||this.To>=t)},e.DPFrom=n.bind.DObject.CreateField("From",Number),e.DPTo=n.bind.DObject.CreateField("To",Number),e}(n.bind.DObject);t.NumberVecteur=i})(c=e.base||(e.base={}))}),define("sys/QModel",["require","exports","sys/System","sys/Corelib"],function(t,e,n,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r;(function(t){var e;(function(t){t[t.Info=0]="Info",t[t.Error=1]="Error",t[t.Command=2]="Command",t[t.Confirm=3]="Confirm"})(e=t.MessageType||(t.MessageType={}));var r=function(){function t(){}return t}();t.CallBackMessage=r;var o=function(t){function n(e,n){var r=t.call(this,e||i.basic.New())||this;return r.Content=n,r}return __extends(n,t),n.getById=function(t,e){return n.pstore.Get(t)},n.prototype.getStore=function(){return n.pstore},n.pstore=new i.collection.Dictionary("Messages",!0),__decorate([i.attributes.property1(Object),__metadata("design:type",String)],n.prototype,"Data",void 0),__decorate([i.attributes.property1(String,{attribute:i.bind.PropertyAttribute.NonSerializable,defaultValue:""}),__metadata("design:type",String)],n.prototype,"Content",void 0),__decorate([i.attributes.property1(String,{attribute:i.bind.PropertyAttribute.NonSerializable,defaultValue:""}),__metadata("design:type",String)],n.prototype,"Title",void 0),__decorate([i.attributes.property1(String,{attribute:i.bind.PropertyAttribute.NonSerializable}),__metadata("design:type",String)],n.prototype,"OKText",void 0),__decorate([i.attributes.property1(Number,{attribute:i.bind.PropertyAttribute.NonSerializable,defaultValue:e.Info}),__metadata("design:type",Number)],n.prototype,"Type",void 0),__decorate([i.attributes.property1(String),__metadata("design:type",String)],n.prototype,"Action",void 0),__decorate([i.attributes.property1(String,{attribute:i.bind.PropertyAttribute.NonSerializable}),__metadata("design:type",String)],n.prototype,"AbortText",void 0),__decorate([i.attributes.property1(String,{attribute:i.bind.PropertyAttribute.NonSerializable}),__metadata("design:type",String)],n.prototype,"CancelText",void 0),n}(n.sdata.QShopRow);t.Message=o})(r=e.models||(e.models={}))}),define("sys/Syntaxer",["require","exports"],function(t,e){"use strict";function n(t){return t.tokon<=i.CToken.string}Object.defineProperty(e,"__esModule",{value:!0});var i;(function(t){function e(t){return t.isComplex=!0,t}function n(t,e){var n=t.current;if(!n)return null;for(var i=n.char,r=e[i];"object"==typeof r;){n=t.getToken(i.length);var o=r[n.char];o?(i+=n.char,r=o):r=r[""]}return r?(t.JumpBy(i.length),{oper:i,fn:r}):null}t._unaire__={"!":{"":function(t){return!t},"!":function(t){return!!t}},"-":{"":function(t){return-t},"-":function(t){return--t},"+":function(t){return-+t}},"+":{"":function(t){return+t},"+":function(t){return++t},"-":function(t){return+-t}}},t._oper_={"+":{"":function(t,e){return t+e},"=":e(function(t,e){var n=t.Value+e.Value;return t.Value=n,n})},"-":{"":function(t,e){return t-e},"=":e(function(t,e){return t.Value-=e.Value,t.Value})},"*":{"":function(t,e){return t*e},"=":e(function(t,e){return t.Value*=e.Value,t.Value}),"*":function(t,e){try{if(null==t)return-1;var n=(typeof t)[0];return"n"==n||"b"==n?t=String(t):"o"===n&&"indexOf"in t||(t=String(t)),t.indexOf(e)}catch(t){return-1}}},"/":{"":function(t,e){return t/e},"=":e(function(t,e){return t.Value/=e.Value,t.Value})},"|":{"":function(t,e){return t|e},"|":function(t,e){return t||e},"=":e(function(t,e){return t.Value|=e.Value,t.Value})},"&":{"":function(t,e){return t&e},"&":function(t,e){return t&&e},"=":e(function(t,e){return t.Value&=e.Value,t.Value})},"!":{"=":{"":function(t,e){return t!=e},"=":function(t,e){return t!==e}}},">":{"":function(t,e){return t>e},"=":function(t,e){return t>=e}},"=":{"":e(function(t,e){return t.Value=e.Value,t.Value}),"=":{"":function(t,e){return t==e},"=":function(t,e){return t===e}}},"<":{"":function(t,e){return t<e},"=":function(t,e){return t<=e}},"?":{"?":function(t,e){return t||e}},"%":function(t,e){return t%e}},t.getOperation=n})(i=e.Parser||(e.Parser={})),function(t){function e(e,n){e.exec(t.parsers.whitespace,!0);var i=e.exec(v.expression,!0);if(!i.success)return!1;e.exec(t.parsers.whitespace,!0);var r=t.getOperation(e,t._oper_);if(!r)return!1;e.exec(v.whitespace,!0);var o=e.exec(v.expression,!0);return!!o.success&&(n.resut={a:i,o:r,b:o},n.tokon=h.biCompute,!0)}function i(e,n){e.exec(v.whitespace,!0);var i=t.getOperation(e,t._unaire__);if(!i)return!1;e.exec(v.whitespace,!0);var r=e.exec(v.expression,!0);return!!r.success&&(n.resut={a:r,o:i},n.tokon=h.uniCompute,!0)}function r(t){return function(e,n){for(var i=0;i<t.length;i++){var r=t[i];if(!e.exec(r).success)return!1}return!0}}function o(t){return function(e,n){for(var i=0;i<t.length;i++)if(e.exec(t[i]).success)return!0;return!1}}function s(t){return function(e,n){for(var i=0;i<t.length;i++){var r=t[i],o=e.exec(r,!0);if(o.success)return a(o,n)}return!1}}function a(t,e){return e.tokon=t.tokon,e.resut=t.resut,e.msg=t.msg,e.children=t.children,!0}function u(e){return l(e,t.parsers.composedPath)}function c(e){return l(e,t.parsers.expression)}function l(e,n){var i=g.get(n);if(i&&(i=i.get(e)))return i;var r=new t.syntaxer(e),o=r.exec(n);return i||g.set(n,i=new Map),i.set(e,o),o}t.bi_compute=e,t.uni_compute=i;var p;(function(t){t[t.uknown=0]="uknown",t[t.alpha=1]="alpha",t[t.num=2]="num",t[t.prnt=4]="prnt",t[t.brkt=8]="brkt",t[t.dot=16]="dot",t[t.prefix=32]="prefix",t[t.filter=64]="filter",t[t.whites=128]="whites",t[t.alphanum=3]="alphanum"})(p=t.TokenType||(t.TokenType={}));var h;(function(t){t[t.whitespace=0]="whitespace",t[t.undefined=1]="undefined",t[t.boolean=2]="boolean",t[t.number=3]="number",t[t.string=4]="string",t[t.word=5]="word",t[t.keyword=6]="keyword",t[t.path=7]="path",t[t.functionCall=8]="functionCall",t[t.arrayCall=9]="arrayCall",t[t.condition=10]="condition",t[t.biCompute=11]="biCompute",t[t.uniCompute=12]="uniCompute"})(h=t.CToken||(t.CToken={})),t.ands=r,t.ors=o,t._ors=s;var d;(function(t){t[t.or=0]="or",t[t.and=1]="and",t[t.xor=2]="xor",t[t.eq=3]="eq",t[t.neq=4]="neq",t[t.dot=5]="dot"})(d=t.oper||(t.oper={}));var f=function(){function t(t){this.token=t,this.terms=[]}return t.prototype.and=function(t,e){return this.terms.push({oper:d.and,parser:t,neq:e}),this},t.prototype.set=function(t,e){return this.terms.push({oper:d.dot,parser:t,neq:e}),this},t.prototype.$open=function(e,n,i){var r=new t(e);return r.parent=this,this.terms.push({oper:n,neq:i,parser:r.Parser}),r},t.prototype.$close=function(){return this.parent},t.prototype.or=function(t,e){return this.terms.push({oper:d.or,parser:t,neq:e}),this},t.prototype.xor=function(t,e){return this.terms.push({oper:d.xor,parser:t,neq:e}),this},t.prototype.eq=function(t,e){return this.terms.push({oper:d.eq,parser:t,neq:e}),this},t.prototype.neq=function(t,e){return this.terms.push({oper:d.neq,parser:t,neq:e}),this},Object.defineProperty(t.prototype,"Parser",{get:function(){var t=this;return this._parser?this._parser:function(e,n){if(n.tokon=t.token,0==t.terms.length)return!0;for(var i=t.exect(t.terms[0],e),r=1;r<t.terms.length;r++){var o=t.terms[r];switch(o.oper){case d.and:i=i&&t.exect(o,e);break;case d.or:i=i||t.exect(o,e);break;case d.eq:i=i==t.exect(o,e);break;case d.neq:case d.xor:i=i!=t.exect(o,e);break;case d.dot:i=t.exect(o,e);break;default:throw""}}return!0}},enumerable:!0,configurable:!0}),t.prototype.exect=function(t,e){var n=e.exec(t.parser).success;return t.neq&&(n=!n),n},t}();t.parserBuilder=f;var y=function(){function t(e){this.src=e,this.stack=[],this.index=-1,this._cache_={};for(var n=new Array(e.length),i=0;i<e.length;i++){var r=e[i];n[i]={index:i,char:r,code:r.charCodeAt(0),type:t.getToken(r)}}this.Tokens=n,this.currentNode={success:null,children:[],start:n[0],end:n[n.length-1],tokon:"prg",parent:null},this.index=0}return Object.defineProperty(t.prototype,"CurrentString",{get:function(){return this.src.substring(this.currentNode.start.index,this.index)},enumerable:!0,configurable:!0}),t.prototype.getCurrentString=function(t,e){return this.src.substring(this.currentNode.start.index+t,this.index-e)},Object.defineProperty(t.prototype,"ShiftIndex",{
get:function(){return this.index-this.currentNode.start.index},enumerable:!0,configurable:!0}),t.prototype.validate=function(t){if(!t)return this.stack.pop(),!0;var e=this.stack.indexOf(t);if(e!=-1)return this.stack.splice(e,this.stack.length-e),!0},t.prototype.save=function(){var t={index:this.index};return this.stack.push(t),t},t.prototype.restore=function(t){var e=t?this.stack.indexOf(t):this.stack.length-1;if(e!=-1)return this.stack.splice(e,this.stack.length-e),this.index=t.index,!1},Object.defineProperty(t.prototype,"current",{get:function(){return this.Tokens[this.index]},enumerable:!0,configurable:!0}),t.prototype.getToken=function(t){return this.Tokens[this.index+t]},Object.defineProperty(t.prototype,"previous",{get:function(){return this.Tokens[this.index-1]},enumerable:!0,configurable:!0}),t.prototype.next=function(){return this.index<this.Tokens.length?(this.index++,this.Tokens[this.index]):null},t.prototype.back=function(){return this.index>0?(this.index--,this.Tokens[this.index]):null},t.prototype.shift=function(){return this.index++,!0},t.prototype.unshift=function(){return this.index--,!0},t.prototype.JumpBy=function(t){this.index+=t,this.index=this.index<-1?-1:this.index>this.src.length?this.src.length:this.index},t.prototype.JumpTo=function(t){this.index=t},t.getToken=function(e){var n=e.charCodeAt(0);return n>64&&n<91||95===n||n>96&&n<123?p.alpha:n>47&&n<58?p.num:t.opers.indexOf(n)!=-1?p.prefix:91==n||93==n?p.brkt:124==n?p.filter:46===n?p.dot:t.whites.indexOf(n)!=-1?p.whites:40===n||41===n?p.prnt:p.uknown},t.prototype.getFromCache=function(t,e){var n=this._cache_[this.index];if(n){var i=n.get(t);if(i)return i.success?(this.index=i.end?i.end.index+1:0,!e&&this.currentNode&&this.currentNode.children.push(i),i):i}},t.prototype.setIntoCache=function(t,e){var n=this._cache_[e.start.index];return n||(this._cache_[e.start.index]=n=new Map),n.set(t,e),e},t.prototype.exec=function(t,e){var n=this.getFromCache(t,e);if(void 0!==n)return n;var i=this.save(),r=this.currentNode,n={success:!1,start:this.current,parent:this.currentNode,children:[]};try{if(!this.current)return n;this.currentNode=n,this.setIntoCache(t,n),n.success=t(this,n),n.end=this.previous,n.success?(this.validate(i),e||r.children.push(n)):this.restore(i)}catch(t){this.restore(i)}return this.currentNode=r,n},t.prototype.fastExec=function(t,e,n){var i=this.save();try{if(!this.current)return!1;var r=t.apply(e||this,n);if(r)return!0;this.restore(i)}catch(t){this.restore(i)}return!1},t.prototype.getChar=function(){var t=this.Tokens[this.index];return t&&t.char||""},t.prototype.testChar=function(t){var e=this.Tokens[this.index],n=!!e&&e.char==t;return n&&this.index++,n},t.prototype.getNextChar=function(t){var e=this.index;t&&this.index++;var n=this.Tokens[e+1];return n?n.char:""},t.prototype.get=function(t){var e=this.Tokens[this.index+t];return e&&e.char},t.IsDigit=function(t){return"0"<=t&&t<="9"},t.prototype.ScanString=function(t){var e=this.index-1,n=this.current;if(!n)return!1;do{if(n.char==t)return this.shift(),this.src.substr(e,this.index-e);"\\"==n.char&&this.shift()}while(n=this.next());return this.index=e+1,null},t.prototype.isChar=function(t){return!!t.type&&((t.type&p.alphanum)==t.type||36==t.code||95==t.code)},t.opers=[36,38,42,43,45,58,60,61,62,63,64,94,126],t.whites=[0,9,10,10,13,32],t}();t.syntaxer=y;var v;(function(t){function o(t){return!!t.type&&((t.type&p.alphanum)==t.type||36==t.code||95==t.code)}function u(t,e,n,i){var r=t.current;n.tokon=void 0===i?"keyword":i;for(var o=0,o=0;o<e.length&&r;o++){if(r.char!==e[o])return!1;if(r=t.next(),!r)return o===e.length-1}return n.resut=e,!0}function c(t,e){e.tokon=h.whitespace;var n=t.current;do if(n.type!=p.whites)break;while(n=t.next());return!0}function l(t){return j[t]?j[t]:j[t]=function(e,n){return u(e,t,n)}}function d(t,e){e.tokon=h.undefined;var n;if(t.exec(l("null"),!0).success)n=null;else{if(!t.exec(l("undefined"),!0).success)return!1;n=void 0}return e.resut=n,!0}function f(t,e){e.tokon=h.boolean;var n=null;if(t.exec(l("true"),!0).success)n=!0;else{if(!t.exec(l("false"),!0).success)return!1;n=!1}return e.resut=n,!0}function y(t,e){var n=t.current;e.tokon=h.string;var i=n.char;if("'"===i||'"'===i)for(;n=t.next();){if(n.char==i)return t.shift(),e.resut=t.getCurrentString(1,1),!0;"\\"==n.char&&t.shift()}return!1}function v(t,e){return e.tokon=h.number,!!t.exec(b).success&&(t.exec(r([l("e"),b]),!0),e.resut=parseFloat(t.CurrentString),!0)}function g(t,e){var n=t.exec(y,!0);return!!(n.success||(n=t.exec(v,!0)).success||(n=t.exec(f,!0)).success||(n=t.exec(d,!0)).success)&&a(n,e)}function b(t,e){var n=t.current;e.tokon=h.number;for(var i=0,r=!1;"-"===n.char||"+"===n.char;)n=t.next();for(;n;){if("."===n.char){if(i)return i===t.ShiftIndex+1?(t.unshift(),r):(e.resut=parseFloat(t.CurrentString),!0);i=t.ShiftIndex}else{if(n.char<"0"||n.char>"9")return!!r&&(e.resut=parseFloat(t.CurrentString),!0);r===!1&&(r=!0)}n=t.next()}return!1}function m(t,e){for(var n=t.current,i=n.char;n=t.next();){if(n.char==i)return t.shift(),e.resut=t.CurrentString,!0;"\\"==n.char&&t.shift()}return!1}function _(t,e){var n=t.current;if(e.tokon=h.word,"'"==n.char||'"'==n.char)return m(t,e);if(n.type===p.num||!o(n))return!1;for(;(n=t.next())&&o(n););return e.resut=t.CurrentString,!0}function C(t,e){var n=t.current;e.tokon="pint";var i=n.char;if("+"!=i&&"-"!=i||"-"==i&&t.shift(),n.type!=p.num)return!1;for(;(n=t.next())&&n.type==p.num;);return e.resut=parseInt(t.CurrentString),!0}function w(t,e){var n=t.current;if(e.tokon="anonymousscop","~"==n.char&&t.next()){var i=t.exec(C,!0);return e.resut=i.resut,i.success}return!1}function S(t,e){var n=t.current;if(e.tokon="namedscop","$"==n.char&&t.next()){var i=t.exec(_,!0);return e.resut=i.resut,i.success}return!1}function O(t,e){var n=t.current;if(e.tokon="subscop","*"==n.char&&t.next()){var i=t.exec(_,!0);return e.resut=i.resut,i.success}return!1}function x(t,e){var n=t.current;e.tokon="typedscope";var i,r;if("["!==n.char)return!1;if(!(n=t.next()))return!1;":"==n.char?(i=n.char,t.next()):"="==n.char&&(i=n.char,t.next());var o=(r=t.exec(I)).success&&t.current&&"]"==t.current.char&&t.shift();return o&&(e.resut={type:i,path:r.resut}),o}function P(t,e){e.tokon="bindscope",t.exec(c,!0);var n=t.exec(_,!0);if(!n.success)return!1;for(e.resut=[n.resut];t.current&&t.current.type==p.dot;){t.next();var n=t.exec(_,!0);if(!n.success)return t.unshift();e.resut.push(n.resut)}return!0}function I(t,e){t.exec(c,!0);var n=t.exec(_,!0);if(!n.success)return!1;for(;t.current&&t.current.type==p.dot;)if(t.next(),!t.exec(_,!0))return t.unshift();return e.resut=t.CurrentString,!0}function D(t,e){var n=t.current;e.tokon="parentscop",e.resut=0;do{if("^"!=n.char)break;e.resut++}while(n=t.next());return!!e.resut}function T(t,e){t.exec(c,!0);var n=[],i=!0,r=t.exec(M,!0),i=!r.success;for(!i&&n.push(r);(i?(i=!1,!0):t.exec(l("."),!0).success)&&(r=t.exec(N,!0)).success;)n.push(r);return 1==n.length?a(n[0],e):(e.tokon=h.path,e.resut=n,!!n.length)}function k(e,n){var i;return!!(e.exec(l("("),!0).success&&(i=e.exec(t._parent1,!0)).success&&e.exec(l(")"),!0).success)&&a(i,n)}function A(t,e){var i=t.exec(E,!0);if(!i.success)return!1;if(!t.exec(l("?"),!1).success)return!1;var r=t.exec(E,!0);if(!r.success)return!1;if(!t.exec(l(":"),!1).success)return!1;var o=t.exec(E,!0);return!!o.success&&(n(i)?a(i.resut?r:o,e):(e.resut={condition:i,success:r,fail:o},e.tokon=h.condition,!0))}function E(t,e){var n;return!!(n=t.exec(F,!0)).success&&a(n,e)}function V(t,e){t.exec(c,!0),e.tokon=h.functionCall;var n,i={args:[],caller:void 0};if(e.resut,(n=t.exec(T,!0)).success&&t.exec(l("("),!0).success){if(i.caller=n,n=t.exec(E,!0),n.success)for(i.args.push(n);t.exec(l(","),!0).success&&(n=t.exec(E,!0)).success;)i.args.push(n);if(t.exec(l(")"),!1).success)return e.resut=i,!0}return!1}function R(t,e){t.exec(c,!0),e.tokon=h.arrayCall;var n,i=E;if((n=t.exec(T,!0)).success&&t.exec(l("["),!0).success){var r={index:void 0,caller:n};if((n=t.exec(i,!0)).success&&t.exec(l("]")).success)return r.index=n,e.resut=r,!0}return!1}var L,j={},M=s([l("this"),l("data"),l("window"),w,S,D]),N=s([k,O,x,P]);(function(t){function e(t,e){var n=t.current.char;return!(u.indexOf(n)==-1||!t.next()||t.current.char!=n)&&(t.next(),e.resut=n+n,e.tokon="suffix_inc",!0)}function n(t,e){var n=t.current.char;if(e.tokon="suffix_inc",u.indexOf(n)!=-1){if("!"!==n){if(!t.next()||t.current.char!=n)return!1;e.resut=n+n}else e.resut=n;return!0}return!1}function i(t,i){var r,o=t.exec(n,!1);if(!r.success)return!1;var s=t.exec(e,!1);return i.tokon="term",i.resut={pre:o,exp:r,suff:s},!0}function r(t,e){return"("==t.current.char&&void t.exec(s)}function o(){}function s(t,e){return!1}function a(t){}var u="+-";t.Term=i,t.parent=r,t.Expre=o,t.chain=a})(L=t.expr||(t.expr={})),t._keyword=u,t.whitespace=c,t.keyword=l,t.undefined=d,t.boolean=f,t.string=y,t.number=v,t.constant=g,t.digit=b,t.word=_,t.pint=C,t.anonymouseScop=w,t.namedScop=S,t.subScop=O,t.typedScop=x,t.bindscope=P,t.stringChainedScop=I,t.composedPath=T,t._parent1=s([A,e,i,E]),t.parent=k,t.condtion=A;var F=s([k,V,R,g,T]);t.expression=E,t.functionCall=V,t.arrayCall=R;var B;(function(t){t[t.bindscope=0]="bindscope",t[t.typedscope=1]="typedscope",t[t.subscop=2]="subscop",t[t.parentscop=3]="parentscop",t[t.namedscop=4]="namedscop",t[t.anonymousscop=5]="anonymousscop",t[t.thisscope=6]="thisscope",t[t.keyword=7]="keyword"})(B=t.coPathType||(t.coPathType={}))})(v=t.parsers||(t.parsers={}));var g=new Map;t.parseComposePath=u,t.parseExpression=c,t.Execute=l}(i=e.Parser||(e.Parser={})),function(t){var e=function(){function t(){this.stack=[],this.pcurs=0,this.isCode=!1}return Object.defineProperty(t.prototype,"currentChar",{get:function(){return this.code[this.curs]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextChar",{get:function(){return this.code[this.curs+1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MoveNext",{get:function(){return this.curs++,this.curs<this.len},enumerable:!0,configurable:!0}),t.prototype.init=function(t){this.code=t,this.curs=-1,this.len=t.length,this.stack=[],this.pcurs=0,this.isCode=!1},t.prototype.getString=function(){for(var t=this.currentChar,e=this.curs+1,n="\0";this.MoveNext;)if("\\"!==n&&(n=this.currentChar,n===t))return this.code.substr(e,this.curs-e);throw"Error"},t.prototype._toStack=function(){var t=this.curs-this.pcurs;if(0!=t){var e=this.code.substr(this.pcurs,t);this.stack.push(this.isCode?{Code:e}:e)}return this.curs<this.len?(this.curs+=1,this.pcurs=this.curs+1,this.isCode=!this.isCode):this.isCode=!1,this.stack},t.prototype.Compile=function(t){for("="!==t[0]?this.init(t):this.init(t.substr(1));this.MoveNext;){var e=this.currentChar;this.isCode?'"'===e?this.getString():"'"===e?this.getString():"}"===e&&"}"===this.nextChar&&this._toStack():"{"===e&&"{"===this.nextChar&&this._toStack()}return this._toStack()},t.Compile=function(t){return this.default.Compile(t)},t.GenearteString=function(t){for(var e=new Array(t.length),n=0;n<t.length;n++){var i=t[n];"string"==typeof i?e[n]=i:e[n]=i.result}return e.join("")},t.default=new t,t}();t.StringTemplate=e}(i=e.Parser||(e.Parser={}))}),define("sys/Corelib",["require","exports","context","sys/Syntaxer","sys/runtime"],function(t,e,n,i,r){"use strict";function o(t){return y.$$(t)}Object.defineProperty(e,"__esModule",{value:!0});var s;(function(e){function i(t,e,n,i){return r.helper.TryCatch(Object,Object.defineProperty,i,[t,e,n])||!1}function o(t,e){i(t.prototype,e.Name,{get:function(){return this.get(e)},set:function(t){this.set(e,t)},configurable:!1,enumerable:!1})}var s=t("plugin|template"),a=t("plugin|json");s&&s.addEventListener(ModuleStat.Executed,function(t){return r.mvc.Initializer.Register(t)},null),a&&a.addEventListener(ModuleStat.Executed,function(t){var e=O.SerializationContext.GlobalContext.reset(),i=t.exports.value,r=i.__type__;i.__name__,e.FromJson(i,n.context.GetType(r)||Object,new O.Path(t,"data"))},null),e.key=[234,23,196,234,69,238,92,244,50,110,70,181,109,139,252,209,146,174,40,140,129,41,58,89,102,193,99,194,178,192,239,152],e.$defineProperty=i,e.setProperty=o,function(t){!t||!t.prototype||"childElementCount"in t.prototype||Object.defineProperty(t.prototype,"childElementCount",{get:function(){for(var t,e=0,n=0,i=this.childNodes;t=i[e++];)1===t.nodeType&&n++;return n}})}(window.Node||window.Element),e.max=0x8000000000000000})(s||(s={}));var a;(function(t){t.Message=null,t.Math=t.Math;var e=function(){function t(){}return t}();t.RichMenu=e})(a=e.Common||(e.Common={}));var u;(function(t){function e(){}t.RichMenu=e})(u=e.TemplateTypes||(e.TemplateTypes={}));var c;(function(t){t._c=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],t._cnts=[7,11,15,19,32],t.names_scop_fromIn=!1})(c||(c={}));var l;(function(t){function e(t){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstElementChild}function n(t){var e=t.parentNode&&t.parentNode.childNodes;if(e)for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}function i(t,e){var n=t.parentNode;return n?(n.insertBefore(e,t),n.removeChild(t),e):null}function r(e,n){return t.replace(e,n).appendChild(e),n}t.fromText=e,t.indexOf=n,t.replace=i,t.wrap=r})(l=e.html||(e.html={}));var p;(function(t){function e(){var t;t=document;for(var e=t.styleSheets,n=0;n<e.length;n++)for(var i=e.item(n),r=i.cssRules,o=0;o<r.length;o++){var a=r[o];new s(a,null)}}function n(t){}function i(t){if("string"!=typeof t)return t;for(var e=0;e<t.length;e++){var n=t.charCodeAt(e);n>64&&n<91?(t=t.substring(0,e)+"-"+String.fromCharCode(n+32)+t.substring(e+1),e++):36===n?t=t.substring(0,e)+"-"+t.substring(++e):95===n&&(t=t.substring(0,e)+"--"+t.substring(++e))}return t}function r(t){if("string"!=typeof t)return t;for(var e=0;e<t.length;e++){var n=t.charCodeAt(e);if(n>=65&&n<=90)throw"InvalidCssName";var i=t.charCodeAt(e+1);if(45===n)if(i>=97&&i<=122)t=t.substring(0,e)+String.fromCharCode(i-32)+t.substring(e+2);else{if(45===t.charCodeAt(e+1)){t=t.substring(0,e)+"_"+t.substring(e+2);continue}t=t.substring(0,e)+"$"+t.substring(e+1),e+=1}}return t}function o(t,e,n){var i=new XMLHttpRequest;i.open("POST","/css-to-less.php"),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.setRequestHeader("Access-Control-Allow-Origin","true"),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.send(encodeURIComponent("data")+"="+encodeURIComponent("body{display:none}")),i.onload=function(t){stop()}}t.cssRules=[];var s=function(){function e(n,i){var r;if(r=this,n instanceof CSSMediaRule){for(var o=n,s=o.cssRules,a=0;a<s.length;a++){var u=s[a];u instanceof CSSMediaRule&&new e(u,this)}r.IsMedia=!0}i&&(r.Parent=i,i.children?i.children.push(this):i.children=[this]),t.cssRules.push(this),r.Rule=n}return e.prototype.Dispose=function(){var e=t.cssRules.indexOf(this);e!=-1&&t.cssRules.splice(e,1)},Object.defineProperty(e.prototype,"Selectors",{get:function(){var t=null;t=this;var e=t.Rule;return t.IsMedia?[]:(t._selectors=e.selectorText.split(","),t._selectors)},enumerable:!0,configurable:!0}),e.prototype.IsMatch=function(t){for(var e=this.Selectors,n=0;e.length;n++);},e}();t.CSSRule=s,t.collectCss=e,t.getVar=n,t.toValidCssName=i,t.toValidEnumName=r,t.Css2Less=o;var a;(function(t){function e(t){return i(t),t.start=performance.now(),t.cursor=0,t.onstart&&t.onstart(t),t.thread=setInterval(function(){var e=performance.now();t.cursor=(e-t.start)/t.timespan,t.cursor>=1&&(clearInterval(t.thread),t.cursor=1);for(var n=0;n<t.props.length;n++)t.props[n].animate(t);if(1==t.cursor){t.oncomplete&&t.oncomplete(t);for(var i,n=0;n<t.props.length;n++)(i=t.props[n]).oncomplete&&i.oncomplete(t)}},t.interval),t}function n(t){var e=performance.now();r(t),t.thread=setInterval(function(){var n=t.animations,i=performance.now(),r=(i-e)/t.timespan;r>=1&&(clearInterval(t.thread),r=1),r=1-(1-r)*(1-r);for(var s=0;s<n.length;s++){var a=n[s];a.cursor=r;for(var u=0;u<a.props.length;u++)a.props[u].animate(a)}1==r&&o(n)},t.interval);for(var n=t.animations,i=0;i<n.length;i++){var s=n[i];s.start=e,s.cursor=0,s.onstart&&s.onstart(s)}return t}function i(t){if(t.thread)return clearInterval(t.thread),o([t]),t}function r(t){if(t.thread)return clearInterval(t.thread),o(t.animations),t}function o(t){for(var e=0;e<t.length;e++){var n=t[e];n.thread=0,n.oncomplete&&n.oncomplete(n);for(var i,r=0;r<n.props.length;r++)(i=n.props[r]).oncomplete&&i.oncomplete(n)}}function s(t,e,n,i,r){return void 0===i&&(i=""),void 0===r&&(r="px"),{name:t,def:n-e,from:e,fnl:i,suffx:r||"px",animate:function(t){t.dom.style[this.name]=this.from+this.def*t.cursor+r},oncomplete:function(t){t.dom.style[this.name]=this.fnl}}}t.animate=e,t.animates=n,t.stopAnimation=i,t.stopAnimations=r,t.trigger=s;var a;(function(t){t.hideOpacity={name:"opacity",animate:function(t){t.dom.style.opacity=String(1-t.cursor)},oncomplete:function(t){t.dom.style[this.name]=""}},t.showOpacity={name:"opacity",animate:function(t){t.dom.style.opacity=String(t.cursor)}}})(a=t.constats||(t.constats={}))})(a=t.animation||(t.animation={}))})(p=e.css||(e.css={}));var h;(function(t){function e(t,e){var n=t+"",i=n.indexOf("."),r=n.indexOf("e");i===-1&&(i=n.length);var o=0;if(r!==-1){if(i>r)return n;if(o=parseFloat(n.substring(r+1)),o<e-1)return"0";n=n.substring(0,r)}var s=n.length;if(0!==o&&i+o>1){var a=n.substr(0,i),u=n.substring(i+1),c=s-i<=o?s-i:o;if(c--,o-=c,i+=c,c>0){n=a+u.substr(0,c);var l=u.substring(c);l.length>0&&(n+=l),i=n.indexOf(".")}i===-1&&(i=n.length),s=n.length}var p=0==e?i:i+e+1,h=p-s;if(h>0&&(p=s),n=n.substr(0,p),h>0)for(i==s&&(n+=".",h--);h>0;h--)n+="0";return n=0!==o?n+"e"+o:n}function n(t,e){var n=t+"",i=n.indexOf("."),r=n.indexOf("e");i===-1&&(i=r===-1?n.length:r);var o=0;if(r!==-1)if(i<=r){if(o=parseFloat(n.substring(r+1)),o<e-1)return"0";n=n.substring(0,r)}else o=parseFloat(n.substring(r+1)),n=n.substring(0,r);var s=n.length;if(0!==o&&i+o>1){var a=n.substr(0,i),u=n.substring(i+1),c=s-i<=o?s-i:o;if(c=Math.abs(c+c===0?0:c<0?1:-1),o-=c,i+=c,c>0){n=a+u.substr(0,c);var l=u.substring(c);l.length>0&&(n+=l),i=n.indexOf(".")}i===-1&&(i=n.length),s=n.length}var p=0==e?i:i+e+1,h=e-(n.length-i);if(h>0&&(p=s),n=n.substr(0,p),h>0)for(i==s&&(n+=".",h--);h>=0;h--)n+="0";return n=0!==o?n+"e"+o:n}t.round1=e,t.round=n})(h=e.math||(e.math={}));var d;(function(t){function e(t,e){var n=8==t||9==t||13==t||27==t,i=19==t||20==t||45==t||46==t||144==t||145==t||t>32&&t<41||t>111&&t<124;return!(n||0==e&&i)}t.IsPrintable=e})(d=e.string||(e.string={}));var f;(function(t){function e(t){return t||(t=document.location.origin),t.endsWith("/")&&(t=t.substr(0,t.length-1)),t}function o(t,e){S=t,O=e}function a(){if(null==S||S>=O){var t=1e5*Date.now()+Math.floor(775823*Math.random());return t<s.max?t:1e4*Date.now()/1e4|771*Math.random()}return S>=O-300&&x.update(),S++}function u(t){for(var e=document.activeElement;e;){if(e==t)return!0;e=e.parentElement}return!1}function l(t){return D.bound=t,D.focuseNext(!0)}function p(t){return D.bound=t,D.focusOn()}function h(t){try{if(t.focus(),document.activeElement==t)return t.select&&t.select(),t}catch(t){}}function d(t){for(var e;t&&!(e=t.nextElementSibling);)t=t.parentElement;return e}function f(t,e){if(!t)return!1;if(e.indexOf(t)!=-1)return!1;if(e.push(t),t===document.activeElement){if(t=d(t),!t)return!0;e.push(t)}var n;if(t instanceof HTMLInputElement&&h(t))return t;if(t instanceof HTMLElement&&(n=f(t.firstElementChild,e)))return n;var i=d(t);return!i||f(i,e)}function y(t){return f(t||document.activeElement,[])}function v(t,e){var i;if("string"!=typeof t)throw"the Path Inspecified";if(i=R[t]||e||n.context.GetEnum(t),!(i instanceof _.List&&i.IsFrozen())){if(null==i)return;if(i.constructor!==Object)throw"Error Parsing Enum";R[t]=i=new _.List(V,g(i)),i.Freeze()}return i}function g(e){var n=[];for(var i in e)isNaN(parseFloat(i))&&n.push(new t.EnumValue(i,e[i]));return n}function b(t,e,n){return F.Compile(t,e,n)}var m;(function(t){function e(t){return i[t]}function n(t,e){i[t]=e,e=r.helper.TryCatch(JSON,JSON.stringify,void 0,[e]),localStorage.setItem(t,e||"null")}var i={};t.get=e,t.set=n,function(){for(var t=new Array(1),e=0;e<localStorage.length;e++){var n=localStorage.key(e);t[0]=localStorage.getItem(n),t[0]&&"undefined"!==t[0]||(i[n]=void 0),i[n]=r.helper.TryCatch(JSON,JSON.parse,void 0,t)}}()})(m=t.Settings||(t.Settings={}));var C;(function(t){t[t.Fail=0]="Fail",t[t.Success=1]="Success",t[t.OperationCanceled=2]="OperationCanceled",t[t.UnknownStat=3]="UnknownStat",t[t.DataCheckError=4]="DataCheckError",t[t.DataWasChanged=16]="DataWasChanged",t[t.None=5]="None"})(C=t.DataStat||(t.DataStat={}));var w;(function(t){function e(e){return t.supportTemplate?e instanceof HTMLTemplateElement:e instanceof HTMLUnknownElement&&"TEMPLATE"===e.tagName}t.supportTemplate="content"in document.createElement("template"),t.IsTemplate=e,t.supportTemplate||s.$defineProperty(HTMLUnknownElement.prototype,"content",{get:function(){return"TEMPLATE"===this.tagName?this:void 0}})})(w=t.polyfill||(t.polyfill={})),t.host=e(null),t.Crypto={Decrypt:function(t){return t},Encrypt:function(t){return t},SEncrypt:function(t){return t},SDecrypt:function(t){return t}};var S=null,O=null;t.setGuidRange=o,t.New=a;var x=function(){function t(t){this.vars=t}return Object.defineProperty(t,"current",{get:function(){return S},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isValid",{get:function(){return 0!==S&&S<O},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Next",{get:function(){return++S},enumerable:!0,configurable:!0}),t.New=function(t,e){0!==S&&S<O?t(++S,e):this.update(t,e)},t.update=function(e,n){null==this.t&&(this.t=new P.WebRequest(null),this.t.Download({Url:"/~Guid",HasBody:!1,Method:P.WebRequestMethod.Get},e),this.t.OnComplete.On=function(i){t.t.Dispose(),t.t=null,e&&e(++S,n)})},t}();t.GuidManager=x,t.isFocused=u;var I=function(){function t(t,e){this.bound=t,this.andButton=e}return t.prototype.focuse=function(t,e){return this[e?"focusePrev":"focuseNext"](t)},t.prototype._focuseOn=function(t){try{if(t.focus(),document.activeElement==t)return t.select&&t.select(),t}catch(t){}},t.prototype.getNext=function(t){for(var e;t&&!(e=t.nextElementSibling);){if(!this.bound.contains(t))return null;t=t.parentElement}return e},t.prototype._focuseNext=function(t,e){if(!t)return!1;if(e.indexOf(t)!==-1)return!1;if(e.push(t),t===document.activeElement){if(t=this.getNext(t),!t)return!0;e.push(t)}var n;if(t.tabIndex>=0&&"function"==typeof t.focus&&(this.andButton||t.constructor!==HTMLButtonElement)&&this._focuseOn(t))return t;if(t instanceof HTMLElement&&(n=this._focuseNext(t.firstElementChild,e)))return n;var i=this.getNext(t);return!i||this._focuseNext(i,e)},t.prototype.getPrev=function(t){for(var e;t&&!(e=t.previousElementSibling);){if(!this.bound.contains(t))return null;t=t.parentElement}return e},t.prototype._focusePrev=function(t,e){if(!t)return!1;if(e.indexOf(t)!==-1)return!1;if(e.push(t),t===document.activeElement){if(t=this.getPrev(t),!t)return!0;e.push(t)}var n;if(t.tabIndex>=0&&"function"==typeof t.focus&&this._focuseOn(t))return t;if(t instanceof HTMLElement&&(n=this._focusePrev(t.lastElementChild,e)))return n;var i=this.getPrev(t);return!i||this._focusePrev(i,e)},t.prototype.focusePrev=function(t){if(this.bound.contains(document.activeElement))var e=this._focusePrev(document.activeElement,[]);else e=!0;return t&&1==e?this._focusePrev(this.bound,[]):e},t.prototype.focuseNext=function(t){if(this.bound.contains(document.activeElement))var e=this._focuseNext(document.activeElement,[]);else e=!0;return t&&1==e?this._focuseNext(this.bound,[]):e},t.prototype.reFocuseOn=function(){return this._focuseNext(this.bound,[])},t.prototype.focusOn=function(){if(!this.bound.contains(document.activeElement))return this._focuseNext(this.bound,[])},t}();t.focuser=I;var D=new I(null,!1);t.focuseOn=l,t._focuseOn=p,t.focuseNext=y;var T=function(){function t(t,e,n,i){this.Owner=t,this.Invoke=e,this._dispose=n,this.objectStat=i}return t.prototype.handleEvent=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.Invoke.apply(this.Owner,t)},t.prototype.Dispose=function(){this._dispose(this),this.Owner=null,this._dispose=null,this.Invoke=null},t}();t.Delegate=T;var k=function(){function t(){this._onchanged=[],Object.freeze(this),Object.preventExtensions(this)}return Object.defineProperty(t.prototype,"Left",{get:function(){return this._x},set:function(t){this._x=t,this.OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Top",{get:function(){return this._y},set:function(t){this._y=t,this.OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Width",{get:function(){return this._w},set:function(t){this._w=t,this.OnChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Height",{get:function(){return this._h},set:function(t){this._h=t,this.OnChanged()},enumerable:!0,configurable:!0}),t.prototype.OnChanged=function(){for(var t=0;t<this._onchanged.length;t++){var e=this._onchanged[t];e(this)}},t.prototype.Set=function(t,e,n,i){this._x=t,this._y=e,this._w=n,this._h=i,this.OnChanged()},t}();t.Rectangle=k;var A=function(){function t(e){t.parse(e)}return Object.defineProperty(t.prototype,"Data",{get:function(){return t.Id},enumerable:!0,configurable:!0}),t.parse=function(e){if(null!=e)for(var n=t.Id,i=0,i=0;i<16;i++){var r=e.substr(2*i,2);if(""===r)break;n[i]=parseInt(r,16)}},t.Id=new Array(16),t}();t.SessionId=A;var E=function(){function t(t){this._id=t.toUpperCase()}return Object.defineProperty(t.prototype,"Id",{get:function(){return this._id},enumerable:!0,configurable:!0}),t.prototype.Equals=function(e){return e instanceof t&&this._id==e._id},t.prototype.toString=function(){return this._id.toString()},t.FromNumber=function(e){for(var n=c._c,i=c._cnts,r=0,o="",s=0;s<32;){var a,u;if(0!==e){var a=e/16,u=Math.floor(e%16);e=Math.floor(a)}else u=Math.floor(16*Math.random());o+=n[u],s==i[r]&&(o+="-",r++),s++}return new t(o)},Object.defineProperty(t,"New",{get:function(){return t.FromNumber(Date.now())},enumerable:!0,configurable:!0}),t.Empty=new t("00000000-0000-0000-0000-000000000000"),t}();t.iGuid=E;var V=function(){function t(t,e){this.Name=t,this.Value=e,Object.freeze(this)}return t.prototype.toString=function(){return this.Name},t.GetValue=function(t,e){var n=t.AsList();if("number"==typeof e){for(var i=0;i<n.length;i++)if(n[i].Value===e)return n[i]}else for(var i=0;i<n.length;i++)if(n[i].Name===e)return n[i]},t}();t.EnumValue=V;var R={};t.getEnum=v;var L=/@([a-zA-Z][a-zA-Z\d\.]*)/gim;t.CompileString=b;var j=function(){function t(){this.script=[],this.OnFnSuccess=this.OnFnSuccess.bind(this)}return t.prototype.toRegString=function(t){for(var e="",n=0;n<t.length;n++){var i=t[n];e+='"'===i||"'"===i?"\\"+i:i}return e},t.prototype.generateFn=function(e,n){for(var i=new Array(e.length),r=!1,o=0;o<e.length;o++){var s=e[o];"string"==typeof s?i[o]='"'+this.toRegString(s)+'"':(r=!0,i[o]=s.Code)}var a=i.join(" + ");n||(a="return "+a);var u=N.getExpression(a,t.params,this.OnFnSuccess,this,!0);return this.script.push(u),u.IsString=!r,u},t.prototype._push=function(t){var e=!0;return"="===t[0]&&(e=!1,t=t.substr(1)),this.generateFn(i.Parser.StringTemplate.Compile(t),e)},t.prototype.push=function(t){if("string"==typeof t)return this._push(t);for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=this._push(t[n]);return e},t.prototype.Compile=function(){for(var t=new Array(this.script.length),e=0;e<t.length;e++)t[e]=this.script[e].code;M.Compile(t.join("\r\n"),this._onload,this._onerror,this)},t.prototype.reset=function(){this.script.length=0},t.prototype._onload=function(t){t.onload&&t.onload(t)},t.prototype._onerror=function(t){t.onerror&&t.onerror(t)},t.prototype.OnFnSuccess=function(t,e){r.helper.TryCatch(this,this.onFnLoad,void 0,[t,e])},t.prototype.remove=function(t){var e=this.script.indexOf(t);e!==-1&&this.script.splice(e,1)},t.params=["$ovalue","$value","$scope","$dom","$job","$fn"],t}();t.CodeCompiler=j;var M=function(){function t(){}return t.Compile=function(t,e,n,i){var r=new Blob([t],{type:"text/javascript"}),o=document.createElement("script");o.src=URL.createObjectURL(r,{oneTimeOnly:!0}),o.addEventListener("load",function(){"msClose"in r&&r.msClose(),document.head.removeChild(o),e&&e(i)}),o.addEventListener("error",function(t){"msClose"in r&&r.msClose(),document.head.removeChild(o),n&&n(i)}),document.head.appendChild(o)},t.CompileExpression=function(t,e,n,i,r){var o=N.getExpression(t,e,n,i,r),s=new Blob([o.code],{type:"text/javascript"}),a=URL.createObjectURL(s,{oneTimeOnly:!0}),u=document.createElement("script");u.src=a,u.addEventListener("load",function(){"msClose"in s&&s.msClose(),document.head.removeChild(u)}),document.head.appendChild(u)},t}();t.EvalCode=M;var N;(function(t){function e(t){r[t.name]&&console.error("Duplicated ExprFn Occurred {}"),r[t.name]=t}function n(t,e){var n=r[t];delete r[t],n.evalCode=e,n.callback&&n.callback(e,n)}function i(t,n,i,r,s){var a="$$__exprFn__"+o++,u=n.join(","),c="window.defineExpression('"+a+"', function ("+u+") { "+(s?"":" return ")+t+"; });",l={name:a,callback:i,stat:r,code:c};return e(l),l}var r={},o=0;t.getExpression=i,s.$defineProperty(window,"defineExpression",{get:function(){return n},set:function(){},configurable:!1,enumerable:!1})})(N||(N={}));var F=function(){function t(t,e,n){this.indexer=t,this.getString=e,this.params=n,this.onDataChanged=this.onDataChanged.bind(this)}return t.generateIndexer=function(t,e){for(var n=[],i=0,r=0;r<e.length;r++){var o=e[r],s=o.Index-i;s>0&&n.push(t.substr(i,s)),n.push(o),i=o.Index+o.Name.length+1}return s=t.length-i,s>0&&n.push(t.substr(i,s)),n},t.Compile=function(e,n,i){for(var r,o=[];r=L.exec(e);)o.push({Name:r[1],Index:r.index});return new t(this.generateIndexer(e,o),n,i)},t.prototype.apply=function(t){for(var e=this.indexer.slice(),n=0;n<e.length;n++){var i=e[n];"string"!=typeof i&&(e[n]=this.getString?this.getString(i.Name,t[i.Name]):String(t[i.Name]))}return String.prototype.concat.apply("",e)},t.prototype.bind=function(t){var e=this.data;return e&&e.removeListener(this.onDataChanged),t&&t.addListener(this.onDataChanged),this.data=t,this.onDataChanged(null)},t.prototype.onDataChanged=function(t){for(var e=this.indexer.slice(),n=0;n<e.length;n++){var i=e[n];"string"!=typeof i&&(e[n]=this.data[i.Name]||"")}return this.Value=String.prototype.concat.apply("",e)},t}();t.StringCompile=F;var B=function(){function t(){this.index=-1,this.stats=[]}return t.prototype.Push=function(t){this.stats.splice(this.index+1,0,t)},t.prototype.goBack=function(){var t=this.Current;t.Back(),this.Index--;var t=this.Current;t&&t.Go()},t.prototype.goForward=function(){var t=this.Current;t&&t.Forward(),this.Index++;var t=this.Current;t&&t.Go()},Object.defineProperty(t.prototype,"Current",{get:function(){return this.stats[this.index]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Index",{get:function(){return this.index},set:function(t){t<0?this.index=-1:t>=this.stats.length?this.index=this.stats.length-1:this.index=t},enumerable:!0,configurable:!0}),t}();t.History=B;var z;(function(t){var e;(function(t){function e(e,i,r){t.supported?n.dispatch(r)&&t.pushState(e,i,r):t.fallback&&(window.location.hash="#"+r)}function i(e){var i=!t.initial.popped&&location.href==t.initial.URL;t.initial.popped=!0,i||n.dispatch(document.location.pathname)}function r(e){if(t.supported=!(!window.history||!window.history.pushState),t.fallback=e,t.supported)t.initial.popped="state"in window.history,t.initial.URL=location.href,window.onpopstate=t.popState;else if(t.fallback){for(var i in n.routes.defined)"#"!=i.charAt(0)&&(n.routes.defined["#"+i]=n.routes.defined[i],n.routes.defined["#"+i].path="#"+i);n.listen()}}t.supported=!(!window.history||!window.history.pushState),t.initial={popped:null,URL:null},t.pushState=e,t.popState=i,t.listen=r})(e=t.history||(t.history={}));var n;(function(t){function e(e){return t.routes.defined.hasOwnProperty(e)?t.routes.defined[e]:new t.core.route(e)}function n(e){t.routes.root=e;
}function i(e){t.routes.rescue=e}function r(e,n){var i,r,o,s,a,u={},c=null;for(c in t.routes.defined)if(null!==c&&void 0!==c)for(c=t.routes.defined[c],i=c.partition(),s=0;s<i.length;s++){if(r=i[s],a=e,r.search(/:/)>0)for(o=0;o<r.split("/").length;o++)o<a.split("/").length&&":"===r.split("/")[o].charAt(0)&&(u[r.split("/")[o].replace(/:/,"")]=a.split("/")[o],a=a.replace(a.split("/")[o],r.split("/")[o]));if(r===a)return n&&(c.params=u),c}return null}function o(e){var n,i;if(t.routes.current!==e){if(t.routes.previous=t.routes.current,t.routes.current=e,i=t.match(e,!0),t.routes.previous&&(n=t.match(t.routes.previous),null!==n&&null!==n.do_exit&&n.do_exit()),null!==i)return i.run(),!0;null!==t.routes.rescue&&t.routes.rescue()}}function a(){var e=function(){t.dispatch(location.hash)};if(""===location.hash&&null!==t.routes.root&&(location.hash=t.routes.root),"onhashchange"in window&&(!document.documentMode||document.documentMode>=8)){var n=Object.getOwnPropertyDescriptor(window,"onhashchange");s.$defineProperty(window,"onhashchange",{set:function(t){n.set.call(this,e)},get:function(){return e},configurable:!1,enumerable:!1});var n=Object.getOwnPropertyDescriptor(window,"onpopstate");s.$defineProperty(window,"onpopstate",{set:function(t){n.set.call(this,e)},get:function(){return e},configurable:!1,enumerable:!1})}else setInterval(e,50);""!==location.hash&&t.dispatch(location.hash)}t.map=e,t.root=n,t.rescue=i,t.match=r,t.dispatch=o,t.listen=a;var u;(function(e){var n=function(){function e(e){this.path=e,this.action=null,this.do_enter=[],this.do_exit=null,this.params={},t.routes.defined[e]=this}return e.prototype.to=function(t){return this.action=t,this},e.prototype.enter=function(t){return t instanceof Array?this.do_enter=this.do_enter.concat(t):this.do_enter.push(t),this},e.prototype.exit=function(t){return this.do_exit=t,this},e.prototype.partition=function(){for(var t,e,n=[],i=[],r=/\(([^}]+?)\)/g;t=r.exec(this.path);)n.push(t[1]);for(i.push(this.path.split("(")[0]),e=0;e<n.length;e++)i.push(i[i.length-1]+n[e]);return i},e.prototype.run=function(){var e,n,i=!1;if(t.routes.defined[this.path].hasOwnProperty("do_enter")&&t.routes.defined[this.path].do_enter.length>0)for(e=0;e<t.routes.defined[this.path].do_enter.length;e++)if(n=t.routes.defined[this.path].do_enter[e].apply(this,null),n===!1){i=!0;break}i||t.routes.defined[this.path].action()},e}();e.route=n})(u=t.core||(t.core={})),t.routes={current:null,root:null,rescue:null,previous:null,defined:{}}})(n=t.Path||(t.Path={}))})(z=t.Routing||(t.Routing={}));var G=function(){function t(t){t&&this.init(t)}return t.prototype.getEName=function(t){if(this.IsFolder)return"";var t=this.ext?this.ext:this.moduleType>=0?ModuleExt[this.moduleType]||t:t,e=this.moduleName;return t&&(e+="."+t),this.params&&(e+="?"+this.params),e},t.prototype.toString=function(){var t="";return this.IsExternal&&(t=this.host),t+="/",this.path.length>0&&(t+=this.path.join("/")+"/"),t+=this.getEName()},t.prototype.init=function(e){var n,i;e=e.toLowerCase().trim();var r=e.indexOf("|");r!==-1&&(this.moduleType=ModuleType[e.substr(0,r)],e=e.substr(r+1)),0===e.indexOf("//")?(n=t.getHost(e=e.substr(2)),this.host=n[0],this.path=n[1]):(i=t.getFullHost(e),this.host=i[0],this.path=i[1]);var o=this.path.pop();if(o){this.IsFolder=!1;var s=o.indexOf("?"),a=s===-1?o:o.substr(0,s);s==-1?this.params="":this.params=o.substr(s+1),s=s===-1?o.length-1:r;var u=a.lastIndexOf(".");u!==-1?(this.ext=a.substr(u+1),this.moduleName=a.substr(0,u)):this.moduleName=a}else this.IsFolder=!0,this.moduleType=ModuleType.folder;return void 0==this.moduleType&&(this.moduleType=this.ext?ModuleType[ModuleType[ModuleExt[this.ext]]]:ModuleType.code),void 0===this.moduleType&&this.ext&&(this.moduleType=ModuleType.uknown),this},t.getHost=function(e){var n=e.indexOf("://"),i=e.indexOf("/");if(i<n)return s=e.split("/"),0===i&&(s.shift(),o=t.rootUrl.host),[o,s];if(n===-1)throw" Invalid Url ";var r=e.indexOf("/",n+3),o=r===-1?e:e.substr(0,r),s=r===-1?[""]:e.substr(r+1).split("/");return[o,s]},t.getFullHost=function(e){var n=e.indexOf("://"),i=e.indexOf("/");if(n===-1||i<n)s=e.split("/"),0===i&&(s.shift(),o=t.rootUrl.host);else var r=e.indexOf("/",n+3),o=r===-1?e:e.substr(0,r),s=r===-1?[""]:e.substr(r+1).split("/");return[o,s]},t.prototype.Combine=function(e){var n="string"==typeof e?new t(e):e;if(n.IsExternal)return n;var i=new t;return i.host=this.host,i.path=null==this.path?n.path:null==n.path?null:this.path.concat(n.path),i.moduleType=n.moduleType,i.moduleName=n.moduleName,i.ext=n.ext,i.params=n.params,i},Object.defineProperty(t.prototype,"IsExternal",{get:function(){return null!=this.host&&""!=this.host},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAsset",{get:function(){return this.moduleType!==ModuleType.code},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._path},set:function(e){t.RevalidatePath(e,this.IsExternal),this._path=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FullPath",{get:function(){return this.toString()},enumerable:!0,configurable:!0}),t.prototype.SameHostAs=function(e){var n=this.IsExternal?this.host:t.rootUrl.host,i=e.IsExternal?e.host:t.rootUrl.host;return n===i},t.RevalidatePath=function(t,e){if(t){var n,i;for(n=0;n<t.length;n++)if(i=t[n],"."===i)t.splice(n,1),n-=1;else if(".."===i)if(e)0==n?(t.splice(n,1),n-=1):(t.splice(n-1,2),n-=2);else{if(0===n||1===n&&".."===t[2]||".."===t[n-1])continue;n>0&&(t.splice(n-1,2),n-=2)}}},t.prototype.intersect=function(e){if(!this.SameHostAs(e))return null;var n=new t;return n.host=this.host,n},Object.defineProperty(t.prototype,"IsInternal",{get:function(){return!this.IsExternal||t.rootUrl.SameHostAs(this)},enumerable:!0,configurable:!0}),t.rootUrl=new t(document.location.href),t}();t.Url=G})(f=e.basic||(e.basic={}));var y;(function(t){function e(t,e,n){return e instanceof Element&&e.classList.contains(n)}function n(t,e,n){return e instanceof Element&&e.tagName===n.toUpperCase()}function i(t,e){var n=e.nextSibling;n?e.parentNode.insertBefore(t,n):e.parentNode.appendChild(t)}function r(t){return t instanceof Array?new o(t):new s(t)}t.hasClass=e,t.hasTag=n;var o=function(){function t(t){this.dom=t}return t.prototype.eq=function(t){var e=t<0?this.dom[this.dom.length-t]:this.dom[t];return e?new s(e):new a},t.prototype.removeClass=function(t){for(var e=0;e<this.dom.length;e++){var n=this.dom[e];n instanceof Element&&n.classList.remove(t)}return this},t.prototype.addClass=function(t){for(var e=0;e<this.dom.length;e++){var n=this.dom[e];n instanceof Element&&n.classList.add(t)}return this},t.prototype.hasClass=function(t){for(var e=0;e<this.dom.length;e++){var n=this.dom[e];if(n instanceof Element&&n.classList.contains(t))return!0}return!1},t.prototype.parent=function(t,e){if(1==this.dom.length)return new s(this.dom[0]).parent(t,e);if(0===this.dom.length)return new a;throw null},t.prototype.submit=function(){for(var t=0;t<this.dom.length;t++){var e=this.dom[t];e instanceof HTMLFormElement&&e.submit()}},t.prototype.siblings=function(t,e){throw new Error("Method not implemented.")},t.prototype.appendTo=function(t){throw new Error("Method not implemented.")},Object.defineProperty(t.prototype,"length",{get:function(){return this.dom.length},enumerable:!0,configurable:!0}),t.prototype.detach=function(){for(var t=0;t<this.dom.length;t++){var e=this.dom[t];e.parentNode.removeChild(e)}return this},t.prototype.insertBefore=function(t){for(var e=0;e<this.dom.length;e++){var n=this.dom[e];null!=n&&n.parentNode.removeChild(n),t.parentElement.insertBefore(n,t)}return this},t.prototype.insertAfter=function(t){for(var e=0;e<this.dom.length;e++){var n=this.dom[e];null!=n&&n.parentNode.removeChild(n),i(n,t)}return this},t.prototype.find=function(e,n){for(var i=[],r=0;r<this.dom.length;r++)for(var o=this.dom[r],s=document.createTreeWalker(o,NodeFilter.SHOW_ALL,{param:n,this:this,acceptNode:function(t){return e(this.this,t,this.param)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}},!1);s.nextNode();)i.push(s.currentNode);return new t(i)},t.prototype.children=function(e,n){for(var i=[],r=0;r<this.dom.length;r++){var o=this.dom[r];if(o instanceof Element)for(var r=0;r<o.children.length;r++){var s=o.children[r];e(this,s,n)&&i.push(s)}}return new t(i)},t.prototype.removeChildren=function(t,e){for(var n=0;n<this.dom.length;n++){var i=this.dom[n];if(i instanceof Element)for(var n=0;n<i.children.length;n++){var r=i.children[n];t(this,r,e)&&(i.removeChild(r),n--)}}return this},t.prototype.add=function(t){if(t instanceof Array)for(var e=0;e<t.length;e++)this.dom.push(t[e]);else this.dom.push(t);return this},t.prototype.toggleClass=function(t){for(var e=this.dom,n=0;n<e.length;n++){var i=e[n];i instanceof Element&&(i.classList.contains(t)?i.classList.remove(t):i.classList.add(t))}return this},t.prototype.toArray=function(){return this.dom},t}();t.__=o;var s=function(){function t(t){this.dom=t}return t.prototype.eq=function(t){return 0===t||t===-1?this:new a},t.prototype.hasClass=function(t){var e=this.dom;return!!(e instanceof Element&&e.classList.contains(t))},t.prototype.parent=function(e,n){for(var i=this.dom.parentNode;i!=document;){if(e(this,i,n))return new t(i);i=i.parentNode}return new a},Object.defineProperty(t.prototype,"length",{get:function(){return 1},enumerable:!0,configurable:!0}),t.prototype.submit=function(){var t=this.dom;t instanceof HTMLFormElement&&t.submit()},t.prototype.siblings=function(t,e){for(var n=this.dom;n.previousSibling;)n=n.previousSibling;var i=[];do t(this,n,e)&&i.push(n),n=n.nextSibling;while(n);return new o(i)},t.prototype.detach=function(){return null!=this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this},t.prototype.add=function(t){var e;return t instanceof Array?(e=t.slice(),e.unshift(this.dom)):e=[this.dom,t],new o(e)},t.prototype.toggleClass=function(t){var e=this.dom;e instanceof Element&&(e.classList.contains(t)?e.classList.remove(t):e.classList.add(t))},t.prototype.insertBefore=function(t){return null!=this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),t.parentElement.insertBefore(this.dom,t),this},t.prototype.insertAfter=function(t){return null!=this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),i(this.dom,t),this},t.prototype.children=function(t,e){var n=[],i=this.dom;if(i instanceof HTMLElement)for(var r=0;r<i.children.length;r++){var s=i.children[r];t(this,s,e)&&n.push(s)}return new o(n)},t.prototype.removeChildren=function(t,e){var n=this.dom;if(n instanceof HTMLElement)for(var i=0;i<n.children.length;i++){var r=n.children[i];t(this,r,e)&&(n.removeChild(r),i--)}return this},t.prototype.appendTo=function(t){this.detach(),t.appendChild(this.dom)},t.prototype.find=function(t,e){for(var n=[],i=document.createTreeWalker(this.dom,NodeFilter.SHOW_ALL,{param:e,this:this,acceptNode:function(e){return t(this.this,e,this.param)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}},!1);i.nextNode();)n.push(i.currentNode);return new o(n)},t.prototype.removeClass=function(t){var e=this.dom;return e instanceof Element&&e.classList.remove(t),this},t.prototype.addClass=function(t){var e=this.dom;return e instanceof Element&&e.classList.add(t),this},t.prototype.toArray=function(){return[this.dom]},t}();t._=s;var a=function(){function e(){}return e.prototype.eq=function(t){return this},e.prototype.removeClass=function(t){return this},e.prototype.addClass=function(t){return this},e.prototype.hasClass=function(t){return!1},e.prototype.detach=function(){return this},e.prototype.insertBefore=function(t){return this},e.prototype.insertAfter=function(t){return this},e.prototype.children=function(t,e){return new o([])},e.prototype.removeChildren=function(t,e){return this},e.prototype.find=function(t,e){return new o([])},e.prototype.add=function(e){return t.$$(e)},e.prototype.toggleClass=function(t){return this},e.prototype.siblings=function(t,e){return new o([])},e.prototype.appendTo=function(t){return this},Object.defineProperty(e.prototype,"length",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.submit=function(){return this},e.prototype.parent=function(t,e){return this},e.prototype.toArray=function(){return[]},e}();t.$$=r})(y=e.query||(e.query={})),e.$$=o;var v;(function(t){var e=function(){function t(t,e,n){this.name=t,this.event=e,this.delegate=n}return t}();t.__data=e})(v||(v={}));var g;(function(t){function e(t){var e=u.get(t);return"undefined"==typeof e&&u.set(t,e=[]),e}function n(t,e,n){Object.defineProperty(t,e,{value:n,configurable:!1,enumerable:!1,writable:!1})}function i(t,i,o,s,a,u,c){return function(l,p,h){if(!r.reflection.IsPrototype(l))throw"Invalid Implimentation of property Attribute";var d=e(l.constructor),f=b.DObject.CreateField(o||p,t,i,s,a,u);void 0===c&&(c="DP"+(o||p)),c&&n(l.constructor,c,f),d.push(f),t=void 0,i=void 0,s=void 0,a=void 0}}function o(t,i){return function(o,s,a){if(!r.reflection.IsPrototype(o))throw"Invalid Implimentation of property Attribute";i||(i={});var u=e(o.constructor),c=b.DObject.CreateField(i.Name||s,t,i.defaultValue,i.changed,i.check,i.attribute);n(o.constructor,i.StaticName||"DP"+(i.Name||s),c),u.push(c),i=void 0}}function s(t){return t=r.reflection.IsClass(t)?t:t.constructor,e(t)}function a(t){return u.delete(t)}var u=new Map;t.property=i,t.property1=o,t.getProperties=s,t.Delete=a})(g=e.attributes||(e.attributes={}));var b;(function(t){function e(t){var e=i[t];return null==e?n(new o(t,null,null,null,null,null)):e}function n(t,e){var n=i[t.Name];return null!=n?e?(i[t.Name]=t,t):n:i[t.Name]=t}var i={},o=function(){function t(t,e,n,r,o,s){this.Name=t,this.Todo=e,this.Check=n,this.OnError=r,this.OnInitialize=o,this.OnScopDisposing=s,i[t]=this}return t}();t.Job=o;var s=function(){function t(t){this.Name=t,i[t]=this}return t.prototype.Todo=function(t,e){},t.prototype.Check=function(t,e){},t.prototype.OnError=function(t,e){},t.prototype.OnInitialize=function(t,e){},t.prototype.OnScopDisposing=function(t,e){},t.prototype.push=function(t){},t}();t.Jobs=s;var a=function(){function e(e,n,i){this.Scop=e,this.job=n,this.dom=i,this._events=[],this._store={},this.propb=e.OnPropertyChanged(t.Scop.DPValue,this.ValueChanged,this)}return e.prototype.addEventListener=function(t,e,n){this._events.push(new v.__data(t,e,n)),this.dom.addEventListener(e,n)},e.prototype.removeEventListener=function(t){for(var e=this._events,n=e.length-1;n>=0;n--){var i=e[n];if(i.name==t)return this.dom.removeEventListener(i.event,i.delegate),void e.splice(n,1)}},e.prototype.getEvent=function(t){for(var e=this._events,n=e.length;n>=0;n--){var i=e[n];if(i.name==t)return i.delegate}return null},e.prototype.ValueChanged=function(t,e){r.PaintThread.Push(this,e,t)},e.prototype.Dispose=function(){var e=this.job.OnScopDisposing;null!=e&&e(this,null);for(var n=this._events,i=n.length-1;i>=0;i--){var r=n[i];this.dom.removeEventListener(r.event,r.delegate),n[i]=null}this._events.splice(0),this._events=null,this._store=null,this.Checker=null,this.dom=null,this.Handle=null,this.job=null,this.Scop.removeEvent(t.Scop.DPValue,this.propb),this.Scop=null,this.propb.Dispose(),this.propb=null,this.IsDisposed=!0},e.prototype.addValue=function(t,e){this._store[t]=e},e.prototype.getValue=function(t){return this._store[t]},e.prototype.handleEvent=function(t){this.Handle&&this.Handle(this,t)},e}();t.JobInstance=a,t.GetJob=e,t.Register=n})(b=e.bind||(e.bind={})),function(t){var e=function(){function t(t,e,n,i,o,s){this.Attribute=t,this.Name=e,this.Type=n,this.DefaultValue=i,this.Changed=o,this.Check=s,n instanceof r.reflection.GenericType&&(this.GType=n),this.RedifineChecker()}return Object.defineProperty(t.prototype,"IsKey",{get:function(){return(this.Attribute&p.IsKey)===p.IsKey},enumerable:!0,configurable:!0}),t.prototype.RedifineChecker=function(){switch(this.Type){case r.reflection.GenericType:this.checkType=this.isGenerictype;break;case Object:this.checkType=t.isObject;break;case String:this.checkType=t.isString;break;case Number:this.checkType=t.isNumber;break;case Boolean:this.checkType=t.isBoolean;break;case r.reflection.DelayedType:break;default:if(this.Type.constructor==r.reflection.DelayedType)break;this.Type.constructor===r.reflection.GenericType?this.checkType=this.isGenerictype:this.checkType=this._checkType}},t.prototype.checkType=function(t){var e=this.Type;return this.Type=e.Type,this.Type instanceof r.reflection.GenericType&&(this.GType=this.Type),this.RedifineChecker(),this.checkType(t)},t.prototype._checkType=function(t){return t instanceof this.Type},t.prototype.isGenerictype=function(t){return t instanceof this.Type.Constructor},t.isObject=function(t){return!0},t.isString=function(t){return"string"==typeof t},t.isNumber=function(t){return"number"==typeof t},t.isBoolean=function(t){return"boolean"==typeof t},t}();t.DProperty=e;var n=[],i=function(){function t(){this.IsValid=!0}return t.New=function(e,i,r,o){var s=0==n.length?new t:n.pop();return s.prop=e,s.__this=i,s._new=o,s._old=r,s},t.prototype.Dispose=function(){n.push(this)},t}();t.EventArgs=i;var o=function(){function t(){}return Object.defineProperty(t.prototype,"key",{get:function(){return this._key},set:function(t){this._key=t},enumerable:!0,configurable:!0}),t}();t.Ref=o;var a=function(){function t(t,e){this._deleagtes=[],this.key=new Object,this.locks=[],this.lock=!1,this.key=t,this.isSingliton=e===!0}return Object.defineProperty(t.prototype,"On",{set:function(t){this._deleagtes.push(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Off",{set:function(t){if(this.lock)return void this.locks.push(t);var e=this._deleagtes.indexOf(t);e!=-1&&this._deleagtes.splice(e,1)},enumerable:!0,configurable:!0}),t.prototype.Invoke=function(t,e){if(!(t!=this.key||o<=0)){this.lock=!0;var n=this.locks;if(this.isSingliton){for(;this._deleagtes.length>0;)r.helper.TryCatch(this,this._deleagtes.shift(),void 0,e);this.locks.length=0}else{for(var i=0,o=this._deleagtes.length;i<o;i++)r.helper.TryCatch(this,this._deleagtes[i],void 0,e);for(this.lock=!1;n.length>0;)this.Off=this.locks.pop()}this.lock=!1}},t.prototype.Invok=function(t,e){if(!(t!=this.key||s<=0)){var n;this.lock=!0;var i=new Array(1);if(this.isSingliton){for(;this._deleagtes.length>0;)i[0]=this._deleagtes.shift(),r.helper.TryCatch(this,e,void 0,i);this.locks.length=0}else{for(var o=0,s=this._deleagtes.length;o<s;o++)i[0]=this._deleagtes[o],r.helper.TryCatch(this,e,void 0,i);for(this.lock=!1;this.locks.length>0;)this.Off=this.locks.pop()}return this.lock=!1,n}},t.prototype.PInvok=function(t,e,n){var i=this._deleagtes.length;if(!(t!=this.key||i<=0)){var o,s=this._deleagtes.slice();this.isSingliton&&(this._deleagtes.length=0);for(var a=0;a<i;a++)o=r.helper.TryCatch(n,s[a],void 0,e);return this.locks.length=0,o}},t.prototype.Add=function(t,e){null==this._store&&(this._store=[]),void 0!==e&&(this._store[e]=t),this._deleagtes.push(t)},t.prototype.Remove=function(t){if(this._store){var e=this._store[t];delete this._store[t],this.Off=e}},t.prototype.Dispose=function(){this.key=null,this.locks.length=0,this.locks=null,this._store&&(this._store.length=0,this._store=null),this._deleagtes.length=0,this._deleagtes=null},t}();t.EventListener=a;var u=function(){function t(t,e){this._deleagtes=[],this.key=new Object,this.currentIndex=-1,this.key=t,this.isSingliton=e===!0}return Object.defineProperty(t.prototype,"On",{set:function(t){this._deleagtes.push(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Off",{set:function(t){var e=this._deleagtes.indexOf(t);e!=-1&&(this._deleagtes.splice(e,1),this.currentIndex!=-1&&e<=this.currentIndex&&this.currentIndex--)},enumerable:!0,configurable:!0}),t.prototype.PInvok=function(t,e,n){if(this.currentIndex!=-1)throw"";var i=this._deleagtes.length;if(!(t!=this.key||i<=0)){var o,s=this._deleagtes.slice();for(this.currentIndex=0;this.currentIndex<this._deleagtes.length;this.currentIndex++){var a,u=s[this.currentIndex];u&&"function"!=typeof u&&(a=u.Owner,u=u.Invoke),o=r.helper.TryCatch(a||n,u,void 0,e)}return this.isSingliton&&(this._deleagtes.length=0),this.currentIndex=-1,o}},t.prototype.Add=function(t,e){null==this._store&&(this._store=[]),void 0!=e&&(this._store[e]=t),this._deleagtes.push(t)},t.prototype.Remove=function(t){if(this._store){var e=this._store[t];delete this._store[t],this.Off=e}},t.prototype.Dispose=function(){this.key=null,this._store&&(this._store.length=0,this._store=null),this._deleagtes.length=0,this._deleagtes=null},t}();t.FEventListener=u;var c=function(){function t(t,e){this.Invoke=t,this.Owner=e}return t.prototype.handleEvent=function(t){if(!this._isIvnoked){if(null==this.Invoke)return!0;this._isIvnoked=!0,r.helper.TryCatch(this.Owner||t.__this,this.Invoke,void 0,[this,t]),this._isIvnoked=!1}},t.prototype.Dispose=function(){this.Owner=null,this.Invoke=null},t}();t.PropBinding=c;var l=function(){function t(t){this.Value=t}return Object.defineProperty(t.prototype,"InsBindings",{get:function(){return void 0===this._bindings&&(this._bindings=[]),this._bindings},enumerable:!0,configurable:!0}),t.prototype.Dispose=function(){if(this.Value=null,this._bindings){for(var t=this._bindings.length-1;t>=0;t--)this._bindings[t].Dispose();this._bindings.length=0,this._bindings=null}},t}();t.PropertyStore=l;var p;(function(t){t[t.NonSerializable=2]="NonSerializable",t[t.Private=4]="Private",t[t.SerializeAsId=8]="SerializeAsId",t[t.IsKey=16]="IsKey",t[t.Optional=32]="Optional"})(p=t.PropertyAttribute||(t.PropertyAttribute={}));var h;(function(t){t[t.NonSerializable=2]="NonSerializable"})(h=t.ObjectAttribute||(t.ObjectAttribute={}));var d=function(){function t(t){this.Base=t,this.Fields=[],this.Fields=t?t.Fields.slice(0):[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.Fields.length},enumerable:!0,configurable:!0}),t.prototype.GetField=function(t){var e;if(this.Base&&(e=this.Base.GetField(t)))return e;for(var n=0;n<this.Fields.length;n++)if((e=this.Fields[n]).Name==t)return e},t}(),f=function(){function n(){this.store=[],this._propertyChanged=[],n.register(this.constructor)}return n.prototype.GetType=function(){return this.constructor},n.__fields__=function(){return[]},n.__attributes__=function(){},Object.defineProperty(n,"isOpen",{get:function(){return this._isOpen},enumerable:!0,configurable:!0}),n.GetProperty=function(t,e){for(var i=n.getId(t),r=n._dpStore[i],o=r.Fields,s=o.length-1;s>=0;s--){var a=o[s];if(a.Name==e)return a}},n.GetDPropertyAt=function(t,e){var i=n.register(t);return i.Fields[e]},n.prototype.GetProperty=function(t){for(var e=r.reflection.GetBaseTypes(this.constructor,n),i=0;i<e.length;i++){var o=n.getId(e[i]),s=n._dpStore[o];if(s)for(var a=s.Fields.length-1;a>=0;a--)if(s.Fields[a].Name==t)return s.Fields[a]}return null},n.prototype.ToJson=function(t,e){e=void 0==e?t.getJson(this):e,e.valid=!0;for(var i=e.json,r=n._dpStore[n.getId(this.constructor)].Fields,o=0,s=r.length;o<s;o++){var a=r[o];if(2!==(2&a.Attribute)){var u=this.get(a);if(8!=(8&a.Attribute))i[a.Name]=t.ToJson(u);else if(u&&u.Id){i[a.Name]=u.Id;continue}}}return i},n.prototype.FromJson=function(t,e,i){if(null==t)return this;var r=t["@ref"];delete t["@ref"],r&&e.set(r.__ref__,this),i=i||!1;for(var o=n._dpStore[n.getId(this.constructor)].Fields,s=0,a=o.length;s<a;s++){var u=o[s];if(4!==(4&u.Attribute)){var c=t[u.Name];void 0!==c&&e.FromJson(c,u.Type,new O.Path(this,u))}}return this},n.IsClass=function(t){return"function"==typeof t&&t!=n.IsClass.constructor},n.CreateField=function(t,n,i,r,o,s){return null==n&&(n=Object),new e(s,t,n,i,r,o)},n.getId=function(t){if(t.hasOwnProperty("__id__"))return t.__id__;var e=++n.typeCount;return s.$defineProperty(t,"__id__",{value:e,writable:!1,configurable:!1,enumerable:!1}),e},n._buildProperty=function(e,n){var i=e[n];if(null!=i)var r=i.constructor;else r=Object;return t.DObject.CreateField(n,r,i)},n.prototype.IsPropertiesChanged=function(t){if(!t)return!0;for(var e,n=t.values,i=this.store,r=0;r<i.length;r++)if((e=i[r])&&e.Value!==n[r])return!0;return!1},n.ToDObject=function(t,e){if(t instanceof this||t.hasOwnProperty("__id__"))return t;var n=t.getType instanceof Function?t.getType():t.constructor;if(n.hasOwnProperty("__id__")){if(n!==-1)throw"Invalid type"}else s.$defineProperty(n,"__id__",{value:-1,writable:!1,configurable:!1,enumerable:!1});for(var i=new Array(e.length),r=0;r<e.length;r++){var o=i[r]=this._buildProperty(t,e[r]);o.Index=r,s.setProperty(t,o)}},n.register=function(t){var e=n.getId(t),i=n._dpStore[e];if(null!=i)return i;for(var o,a,u=r.reflection.GetBaseTypes("function"==typeof t?t:t.constructor,n),c=u.length-1;c>=0;c--){var l=u[c],e=n.getId(l);if(o=n._dpStore[e],null==o){if(l.hasOwnProperty("ctor")&&l.ctor(),l.hasOwnProperty("_ctor")&&l._ctor(),l.hasOwnProperty("__fields__"))var p=l.__fields__;else p=null;n._isOpen=!0,o=new d(a);var h=a?a.length:0,f=p?l.__fields__():[];f.push.apply(f,g.getProperties(l));for(var y=0;y<f.length;y++){var v=f[y];o.GetField(v.Name)||(v.Index=h+y,v.Type instanceof r.reflection.DelayedType||Object.freeze(v),l.prototype.hasOwnProperty(v.Name)||s.setProperty(l,v),o.Fields.push(v))}g.Delete(l),n._isOpen=!1,n._dpStore[e]=o,Object.freeze(o)}a=o}return n._dpStore[e]},n.prototype.getType=function(){return this.constructor},n.getFieldsCount=function(){return this.register(this).Fields.length},n.getFields=function(t){return this.register(t||this).Fields},n.prototype.set=function(t,e,n){if(!this._isFrozen){var r=this.store[t.Index]||(this.store[t.Index]=new l(t.DefaultValue)),o=r.Value;if(o!==e){if(null!=e&&!t.checkType(e))throw{message:"Uncompatible type",this:this,property:t,value:e};var s=i.New(t,this,o,e);if(t.Check&&t.Check.call(this,s),o!==s._new&&s.IsValid)return r.Value=s._new,t.Changed&&t.Changed.call(this,s),this.onPropertyChanged(s),n?s:void s.Dispose()}}},n.prototype.raise=function(t){var e=this.get(t),n=i.New(t,this,e,e);this.onPropertyChanged(n)},n.prototype.get=function(t){var e=this.store[t.Index];return e?e.Value:t.DefaultValue},n.prototype.GetValues=function(){return this.store.map(function(t,e,n){return t&&t.Value})},n.prototype.GetValue=function(t){var e=this.store[t.Index];return e?e.Value:t.DefaultValue},n.prototype.SetValue=function(t,e){this.set(t,e)},n.prototype.removeListener=function(t){var e=this._propertyChanged.indexOf(t.Ref);return e!==-1&&(this._propertyChanged.splice(e,1),!0)},n.prototype.addListener=function(t){return this._propertyChanged.indexOf(t)===-1&&(this._propertyChanged.push(t),!0)},n.prototype.onPropertyChanged=function(t){for(var e=0;e<this._propertyChanged.length;e++){var n=this._propertyChanged[e];n(t),g.property}var i;if(i=(i=this.store[t.prop.Index])&&i._bindings)for(var e=0;e<i.length;e++)i[e].handleEvent(t)&&(i.splice(e,1),e--)},n.prototype.Observe=function(t,e,n){var i=this.store[t.Index]||(this.store[t.Index]=new l(t.DefaultValue));return i.InsBindings.push(i=new c(e,n)),i},n.prototype.UnObserve=function(t,e,n){var i,r=this.store[t.Index]&&this.store[t.Index]._bindings;if(r)if("function"!=typeof e){if((i=r.indexOf(e))!=-1)return this._disposeProp(this.store[t.Index],e,i)}else{for(var o,s,i=r.length-1;i>=0;i--){var a=r[i];if(a.Invoke===e){if(a.Owner===n&&!this._disposeProp(this.store[t.Index],a,i))return!0;o||(o=a,s=i)}}if(o)return this._disposeProp(this.store[t.Index],o,s)}return!1},n.prototype._disposeProp=function(t,e,n){var i=t._bindings;return e.Dispose(),1==i.length?(t._bindings=void 0,!1):(i.splice(n,1),!0)},n.prototype.OnPropertyChanged=function(t,e,n){return this.Observe(t,e,n)},n.prototype.addEvent=function(t,e){var n=this.store[t.Index]||(this.store[t.Index]=new l(t.DefaultValue));n.Bindings.push(e)},n.prototype.removeEvent=function(t,e){var n=this.store[t.Index]&&this.store[t.Index]._bindings;if(n){var i=n.indexOf(e);if(i!=-1)return this._disposeProp(this.store[t.Index],e,i)}return null},Object.defineProperty(n.prototype,"Disposed",{get:function(){return 0===this.store.length},enumerable:!0,configurable:!0}),n.prototype.OnDispose=function(){if(2===this.DisposingStat)return null;var t=1==this.DisposingStat;return this.DisposingStat=1,!t&&this.OnDisposing&&this._onDisposing.Invoke(0,[this]),t},n.prototype.Dispose=function(){var t=this.OnDispose();if(null!==t){this._propertyChanged.length=0;for(var e=(n.getFields(this.GetType()),0),i=this.store.length;e<i;e++)this.store[e]&&this.store[e].Dispose();this.store.length=0,t||(this.DisposingStat=2)}},Object.defineProperty(n.prototype,"OnDisposing",{set:function(e){void 0===this._onDisposing&&(this._onDisposing=new t.EventListener(0,!0)),this._onDisposing.On=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"OffDisposing",{set:function(t){void 0!=this._onDisposing&&(this._onDisposing.Off=t)},enumerable:!0,configurable:!0}),n.prototype.CloneTo=function(t){t._propertyChanged=this._propertyChanged,t.addListener=this.addListener,t.store=this.store},n.prototype.Freeze=function(){this._isFrozen=!0},n.prototype.UnFreeze=function(){this._isFrozen=!1},n.prototype.IsFrozen=function(){return this._isFrozen},n.prototype.CreateBackup=function(t){var e;return s.backups.GetOrAdd(this.store,[]).push(e={OnUndo:t,values:this.store.map(function(t,e){return t.Value})}),e},n.prototype.Commit=function(t){var e=s.backups.Get(this.store);if(null==e||0===e.length)return!1;if(t){var n=e.indexOf(t);if(n===-1)return;e.splice(n)}else e.pop()},n.prototype.Rollback=function(t,e){if(t)return this.UndoTo(t,e);var i=s.backups.Get(this.store);if(null==i||0===i.length)return!1;for(var r=i.pop(),o=n._dpStore[this.constructor.__id__],a=r.values,u=0;u<a.length;u++)this.set(o.Fields[u],a[u]);return r.OnUndo&&r.OnUndo(this,r),!0},n.prototype.UndoTo=function(t,e){var i=s.backups.Get(this.store);if(null!=i&&0!==i.length){var r=i.indexOf(t);if(r===-1)return!1;var o=i.splice(r,i.length-r),a=n._dpStore[this.constructor.__id__];if(e)for(var r=o.length;r>=0;r--)for(var u=o[r],c=u.values,r=0;r<c.length;r++)this.set(a.Fields[r],c[r]);else for(var u=o[0],c=u.values,r=0;r<c.length;r++)this.set(a.Fields[r],c[r]);return!0}},n._dpStore=[],n._isOpen=!1,n.typeCount=0,n}();t.DObject=f;var y;(function(t){t[t.None=0]="None",t[t.Disposing=1]="Disposing",t[t.Disposed=2]="Disposed"})(y=t.DisposingStat||(t.DisposingStat={}));var v=function(){function e(t){this.Name=t}return e.prototype.ListenTo=function(e,n,i){!this.Property&&e instanceof t.DObject&&(this.Property=e.GetProperty(this.Name)),this.Property?(null!=this.Binding&&this.d&&this.d.UnObserve(this.Property,this.Binding,i),this.Binding=void 0,e&&(this.Value=e.GetValue(this.Property),this.Binding=e.Observe(this.Property,n,i))):(null!=this.Binding&&this.d&&D.unobserve(this.d,this.Name,this.Binding,i),this.Binding=void 0,e&&e.hasOwnProperty(this.Name)&&(this.Binding=D.observe(e,this.Name,n,i)),e&&(this.Value=e[this.Name])),this.d=e},e.prototype.Dispose=function(){this.Property&&this.d instanceof t.DObject?null!=this.Binding&&null!=this.d&&this.d.UnObserve(this.Property,this.Binding):null!=this.Binding&&null!=this.d&&D.unobserve(this.d,this.Name,this.Binding),this.Value=null,this.Binding=null},e}();t.XPath=v;var b=function(e){function n(t,n,i){var r=e.call(this)||this;return r.controller=i,r.xpath=[],r.Me=t,r.Path=n,r}return __extends(n,e),Object.defineProperty(n.prototype,"Me",{get:function(){return this.get(n.DPMe)},set:function(t){this.set(n.DPMe,t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Path",{get:function(){return this.get(n.DPPath)},set:function(t){this.set(n.DPPath,t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Value",{get:function(){return this.get(n.DPValue)},set:function(t){this.set(n.DPValue,t)},enumerable:!0,configurable:!0}),n.__fields__=function(){return[n.DPMe,n.DPPath,n.DPValue]},n.prototype.GenType=function(){return n},n.prototype.calcPrefix=function(e){switch(e){case"this":return this.controller&&this.controller.MainControll;case"window":return t.windowScop}},n.prototype.rebuidPath=function(t){var e=t._new;this.disposePath(),this.xpath=new Array(e.length);for(var n=0;n<e.length;n++){var i=e[n];
this.xpath[n]=new v(i)}this.Start(0)},n.prototype.disposePath=function(){for(var t=this.xpath,e=t.length,n=0;n<e;n++){var i=t[n];i.Dispose()}this.Value=null},n.prototype.getValue=function(t){for(var e=this.Me,n=this.xpath,i=0;i<t;i++){var r=n[i];if(null==e)return null;e=r.Property?e.get(r.Property):e[r.Name],r.Value=e}return e},n.prototype.Start=function(t){void 0==t&&(t=0);for(var e=this.xpath,n=this.getValue(t),i=t;i<e.length;i++){var r=e[i];n?(r.ListenTo(n,this.callMe,this),n=r.Value):r&&r.Dispose()}this.Value=n},n.prototype.ESetValue=function(t){var e=this.xpath.length;if(!(e<1)){var n=this.xpath[e-1],i=e-2<0?this.Me:this.xpath[e-2].Value;i&&(n.Property?i.SetValue(n.Property,t):(this.Value=t,i[n.Name]=t))}},n.prototype.callMe=function(t,e){for(var n=this.xpath.length-1;n>=0;n--){var i=this.xpath[n];if(i.Binding==t){this.Start(n+1);break}}this.Value=this.getValue(this.xpath.length)},n.prototype.Dispose=function(){var t=this.OnDispose();null!==t&&(this.disposePath(),e.prototype.Dispose.call(this),t||(this.DisposingStat=2))},n.DPMe=t.DObject.CreateField("Me",Object,null,function(t){this.Start(0)},n.prototype.disposePath),n.DPPath=t.DObject.CreateField("Path",Array,null,n.prototype.rebuidPath),n.DPValue=t.DObject.CreateField("Value",Object,null),n}(t.DObject);t.Observer=b}(b=e.bind||(e.bind={}));var m;(function(t){var e=function(){function t(t,e,n){this.source=t,this.getParent=e,this.dic=new _.Dictionary("nodes"),this.OnChange=new b.EventListener(this.source),this.OnChange.On=n,this.Reset()}return t.prototype.Remove=function(t){this.OnRemove(t)&&this.source.Remove(t)},t.prototype.Add=function(t){this.OnAdd(t),this.source.Add(t)},t.prototype.Clear=function(){this.OnClear(),this.source.Clear()},t.prototype.Reset=function(){this.OnClear();for(var t=this.source.AsList(),e=0;e<t.length;e++)this.OnAdd(t[e])},t.prototype.OnAdd=function(t){var e,n=this.getParent(t),i=this.dic.GetOrAdd(t,{children:[],Value:t,Parent:null,get Depth(){return this._depth?this._depth:this._depth=this.Parent?this.Prent.Depth+1:0}});n&&((e=this.dic.GetOrAdd(n,{children:[],Value:n,Parent:null,get Depth(){return this._depth?this._depth:this._depth=this.Parent?this.Prent.Depth+1:0}})).children.push(i),i.Parent=e),this.OnChange.Invoke(this.source,[e,i,!0])},t.prototype.getNodes=function(){return this.dic.getValues()},t.prototype.getBases=function(){for(var t=[],e=this.dic.getValues(),n=0;n<e.length;n++)null==e[n].Parent&&t.push(e[n]);return t},t.prototype.OnRemove=function(t){var e=this.dic.Get(t),n=this.getParent(t);if(e){if(e.children.length>0)return!1;if(n){var i=this.dic.Get(n),r=i.children.indexOf(e);r>=0&&i.children.splice(r,1)}}return this.OnChange.Invoke(this.source,[i,e,!1]),!0},t.prototype.OnClear=function(){this.OnChange.Invoke(this.source,[]),this.dic.Clear()},t}();t.Tree=e;var n=function(){function t(t){this.Ref=t}return t}();t.RemoveRef=n;var i=function(){function t(t,e,n,i,r){this.oldItem=t,this.newItem=e,this.startIndex=n,this.event=i,this.collection=r}return t.prototype.Dispose=function(){this.oldItem=null,this.newItem=null,this.startIndex=null,this.event=null},Object.defineProperty(t,"ResetEvent",{get:function(){return this._r||(this._r=new t(null,null,0,_.CollectionEvent.Reset,[]))},enumerable:!0,configurable:!0}),t}();t.ListEventArgs=i;var r=function(t){function e(){var e=t.call(this)||this;return e._store=[],e}return __extends(e,t),Object.defineProperty(e.prototype,"Patent",{get:function(){return this._patent},set:function(t){"string"==typeof t&&(e=this.convertFromString(t));var e=t;if(e){if(this._patent&&e.equals(this._patent))return}else{if(!this._patent)return;if(this._patent.equals(null))return}this._patent=e;for(var n=this._store,i=0;i<n.length;i++){var r=n[i];r.callback(this,r.data)}},enumerable:!0,configurable:!0}),e.prototype.OnChanged=function(t,e,n){var i=new s(t,e,n,Date.now());return this._store.push(i),i.id},e.prototype.OffChanged=function(t){if("string"==typeof t)for(var e=t,n=this._store,i=n.length-1;i>=0;i--){var r=n[i];r.name==e&&n.splice(i,1)}else if("number"==typeof t)for(var o=t,n=this._store,i=n.length-1;i>=0;i--){var r=n[i];if(r.id==o)return void n.splice(i,1)}},e.prototype._ismath=function(t){for(var e=0;e<t.length;e++)if(t[e].indexOf(this._patent)!==-1)return!0;return!1},e}(b.DObject);t.Filter=r;var o=function(t){function e(e){var n=t.call(this)||this;return n._isMatch=e,n}return __extends(e,t),e.prototype.IsMatch=function(t,e){return null==this._isMatch||this._isMatch(this._patent,e)},e.prototype.convertFromString=function(t){return t},e.prototype.Begin=function(t,e){},e}(r);t.CostumeFilter=o;var s=function(){function t(t,e,n,i){this.callback=t,this.data=e,this.name=n,this.id=i,void 0==i&&(i=Date.now())}return t}();t.filterCallback=s})(m=e.utils||(e.utils={}));var _;(function(t){var e;(function(t){t[t.Added=0]="Added",t[t.Removed=1]="Removed",t[t.Replace=2]="Replace",t[t.Cleared=3]="Cleared",t[t.Reset=4]="Reset",t[t.Setted=5]="Setted"})(e=t.CollectionEvent||(t.CollectionEvent={}));var i=function(t){function i(e,n){var i=t.call(this)||this;if(i.argType=e,i._list=[],i._changed=[],i._changing=[],n&&n.length)for(var r=0,o=n.length;r<o;r++)i._list.push(n[r]);return i.UCount(),i}return __extends(i,t),i.__fields__=function(){return[i.DPCount]},i.prototype.UCount=function(){this.set(i.DPCount,this._list.length)},Object.defineProperty(i.prototype,"ArgType",{get:function(){return this.argType},enumerable:!0,configurable:!0}),i.prototype.GetType=function(){return r.reflection.GenericType.GetType(this.constructor,[this.argType])},i.prototype.AsList=function(){return this._list},i.prototype.Order=function(t){for(var e=this._list,n=e.length,i=0;i<n;i++)for(var r=i+1;r<n;r++)if(t(e[i],e[r])>0){var o=e[r];e[r]=e[i],e[i]=o}},i.prototype.OrderBy=function(t){var n=this._list.sort(t);this.OnChanged(null,0,e.Reset,null,n)},i.prototype.Filtred=function(t){var e=new s(this.argType);return e.Filter=t,e.Source=this,e},i.prototype.Set=function(t,n){if(t<0)return!1;if(this._list.length<=t)return!1;var i=this._list[t];return i===n||(this._list[t]=n,void this.OnChanged(n,t,e.Setted,i))},i.prototype.Get=function(t){return t<0?null:this._list.length<=t?null:this._list[t]},i.prototype.Insert=function(t,n){if(!this._isFrozen)return t>=0&&t<=this._list.length&&(this._list.splice(t,0,n),this.OnChanged(n,t,e.Added,null),!0)},i.prototype.Add=function(t){if(!this._isFrozen){if(null==t)throw"NullArgument detected";return this._list.push(t),this.OnChanged(t,this._list.length-1,e.Added,null),this}},i.prototype.AddRange=function(t){if(!this._isFrozen)for(var e=0;e<t.length;e++)this.Add(t[e])},i.prototype.CheckIndex=function(t){return t>=0&&t<this._list.length},i.prototype.Remove=function(t){if(!this._isFrozen)return"number"!=typeof t&&(t=this.IndexOf(t)),this.RemoveAt(t)},i.prototype.RemoveAt=function(t){if(!this._isFrozen&&"number"==typeof t){if(this.CheckIndex(t)){var n=this._list[t];return this._list.splice(t,1),this.OnChanged(n,t,e.Removed,n),!0}return!1}},i.prototype.Clear=function(){if(!this._isFrozen){var t=this._list.length;t>0&&this.OnChanged(null,0,e.Cleared,null,this._list.splice(0,this._list.length))}},Object.defineProperty(i.prototype,"Count",{get:function(){return this._list.length},enumerable:!0,configurable:!0}),i.prototype.IndexOf=function(t){return this._list.indexOf(t)},Object.defineProperty(i.prototype,"Listen",{set:function(t){this._changed.push(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Unlisten",{set:function(t){var e=this._changed.indexOf(t);e<0||this._changed.splice(e,1)},enumerable:!0,configurable:!0}),i.prototype.OnChanged=function(t,e,n,i,r){var o=new m.ListEventArgs(i,t,e,n,r),s=this._changed.length;this.UCount();for(var a=0;a<s;a++){var u=this._changed[a];"function"==typeof u?u(o):u.Invoke.call(u.Owner,o)}},i.prototype.getArgType=function(t){var e=this.ArgType;if(null!=e)return e;var i=t.__argtype__;return e=void 0==i?Object:n.context.GetType(i),void 0==e?void 0==this.argType?Object:this.argType:e},i.prototype.ToJson=function(e,i){i=void 0==i?e.getJson(this):i;var r=e.getJson(this);if(i.valid)return i.ref;r=t.prototype.ToJson.call(this,e,i),i.valid=!0;for(var o=[],s=this._list,a=0;a<s.length;a++){var u=s[a];u=e.ToJson(u),o.push(u)}return r.__list__=o,r.__argtype__=n.context.NameOf(this.argType),r},i.prototype.FromJson=function(e,n,r,o){var s=e.__list__||[];this._list=new Array(0);for(var a=this.argType=this.getArgType(e),u=0;u<s.length;u++){var c=s[u];if(void 0!==c){var l=i.getType(c);void 0===l&&(l=this.argType),n.FromJson(c,void 0===l?a:l,new O.LPath(this,u))}}return t.prototype.FromJson.call(this,e,n,r),this.OnDeserialize(this._list),null!=e&&e.IsFrozen&&this.Freeze(),this},i.prototype.OnDeserialize=function(t){},i.getType=function(t){var e=t.__type__;if(void 0!=e)return n.context.GetType(e)},i.GenType=function(t){return r.reflection.GenericType.GetType(this,[t])},i.DPCount=i.CreateField("Count",Number,0,null,null,2),i}(b.DObject);t.List=i;var o=function(t){function n(e,n){var i=t.call(this)||this;return i.Name=e,i.ReadOnly=n,i.keys=[],i.values=[],i._changed=[],n=null==n,i}return __extends(n,t),n.prototype.GetKeyAt=function(t){return this.keys[t]},n.prototype.GetValueAt=function(t){return this.values[t]},Object.defineProperty(n.prototype,"Count",{get:function(){return this.keys.length},enumerable:!0,configurable:!0}),n.prototype.Clear=function(){this.keys.length=0,this.values.length=0,this.OnChanged(null,null,e.Cleared,null)},n.prototype.IndexOf=function(t,e){return this.keys.indexOf(t,e)},n.prototype.IndexOfValue=function(t,e){return this.values.indexOf(t,e)},n.prototype.Set=function(t,e){var n=this.keys.indexOf(t);if(n===-1)n=this.keys.length,this.keys.push(t);else if(this.ReadOnly){if(this.values[n]===e)return;throw"key is exist"}this.values[n]=e},n.prototype.Remove=function(t){var e=this.keys.indexOf(t);if(e!==-1){var n=this.values[e];return this.values.splice(e,1),this.keys.splice(e,1),n}},n.prototype.RemoveAllValues=function(t){for(var e=[];;){var n=this.values.indexOf(t,n);if(n===-1)return e;e.push(this.keys[n]),this.values.splice(n,1),this.keys.splice(n,1)}},n.prototype.RemoveAt=function(t){if(t<this.keys.length&&t>=0){var e={Key:this.keys[t],Value:this.values[t]};return this.values.splice(t,1),this.keys.splice(t,1),e}},n.prototype.getValues=function(){return this.values},n.prototype.Get=function(t){var e=this.keys.indexOf(t);return e===-1?void 0:this.values[e]},n.prototype.GetOrAdd=function(t,e){var n=this.keys.indexOf(t);return n!==-1?this.values[n]:(this.keys.push(t),this.values.push(e),e)},n.prototype.GetOrCreate=function(t,e,n){var i=this.keys.indexOf(t);if(i!==-1)return this.values[i];var r=e(t,n);return this.keys.push(t),this.values.push(r),r},n.prototype.GetKeyOf=function(t){var e=this.values.indexOf(t);return e===-1?void 0:this.keys[e]},Object.defineProperty(n.prototype,"Listen",{set:function(t){this._changed.push(t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Unlisten",{set:function(t){var e=this._changed.indexOf(t);e<0||this._changed.splice(e,1)},enumerable:!0,configurable:!0}),n.prototype.OnChanged=function(t,e,n,i){for(var r=new m.ListEventArgs(i,t,e,n),o=this._changed.length,s=0;s<o;s++){var a=this._changed[s];a(r)}},n}(b.DObject);t.Dictionary=o;var s=function(t){function n(e){var n=t.call(this,e)||this;return n._fid=null,n.sicd={Owner:n,Invoke:n.sourceItemChanged},n}return __extends(n,t),Object.defineProperty(n.prototype,"Source",{get:function(){return this.get(n.DPSource)},set:function(t){this.set(n.DPSource,t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Filter",{get:function(){return this.get(n.DPFilter)},set:function(t){this.set(n.DPFilter,t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"MaxResult",{get:function(){return this.get(n.DPMaxResult)},set:function(t){this.set(n.DPMaxResult,t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Shift",{get:function(){return this.get(n.DPShift)},set:function(t){this.set(n.DPShift,t)},enumerable:!0,configurable:!0}),n.__fields__=function(){return[n.DPFilter,n.DPMaxResult,n.DPShift,n.DPSource]},n.prototype.filterChanged=function(t){t._old&&t._old.OffChanged(this._fid),t._new&&(this._fid=t._new.OnChanged(n.patentChanged,this)),this.Reset()},n.prototype.sourceChanged=function(t){t._old&&(t._old.Unlisten=this.sicd),t._new&&(t._new.Listen=this.sicd),this.Reset()},n.prototype.MaxResultChanged=function(t){this.Reset()},n.New=function(t,e,i){var r=new n(null==t?i:t.ArgType);return r.Filter=e,r.Source=t,r},n.patentChanged=function(t,e){e.Reset()},n.prototype.sourceItemChanged=function(n){switch(n.event){case e.Added:if(this.MaxResult<=this.Count)return;return void(this.isMatch(n.startIndex,n.newItem)&&t.prototype.Add.call(this,n.newItem));case e.Cleared:return t.prototype.Clear.call(this);case e.Removed:return void t.prototype.Remove.call(this,n.oldItem);case e.Replace:var i=this.IndexOf(n.oldItem),r=this.isMatch(n.startIndex,n.newItem);return void(r?i==-1?t.prototype.Add.call(this,n.newItem):this.Set(i,n.newItem):i!=-1&&t.prototype.RemoveAt.call(this,i));case e.Reset:return this.Reset();case e.Setted:var i=this.IndexOf(n.oldItem),r=this.isMatch(n.startIndex,n.newItem);return void(r?i==-1?t.prototype.Add.call(this,n.newItem):t.prototype.Set.call(this,i,n.newItem):i!==-1&&t.prototype.RemoveAt.call(this,i))}},n.prototype.isMatch=function(t,e){var n=this.Filter;return null==n||n.IsMatch(t,e)},n.prototype.Reset=function(){t.prototype.Clear.call(this);var e=this.Source;if(null!=e){var n=this.Filter,i=null==n,r=this.MaxResult;if(!i)if(n.Begin(this.Shift,this.MaxResult))t.prototype.AddRange.call(this,e.AsList());else for(var o=0,s=e.Count;o<s&&r>0;o++){var a=e.Get(o);if(i)t.prototype.Add.call(this,a);else{var u=n.IsMatch(o,a);if(null===u)break;u&&t.prototype.Add.call(this,a)}}}},n.DPSource=b.DObject.CreateField("Source",i,null,function(t){t.__this.sourceChanged(t)}),n.DPFilter=b.DObject.CreateField("Filter",m.Filter,null,function(t){t.__this.filterChanged(t)}),n.DPMaxResult=b.DObject.CreateField("MaxResult",Number,1/0,function(t){t.__this.MaxResultChanged(t)}),n.DPShift=b.DObject.CreateField("Shift",Number,0,function(t){t.__this.MaxResultChanged(t)}),n}(i);t.ExList=s;var a=function(t){function n(e,n,i){var r=t.call(this,e)||this;return r.converter=n,r.stat=i,r.sli={Owner:r,Invoke:r.OnSourceChanged},r}return __extends(n,t),n.__fields__=function(){return[this.DPSource]},n.prototype.SourceChanged=function(t){var e=t._old,n=t._new;e&&(e.Unlisten=this.sli),n&&(n.Listen=this.sli),this.Reset()},n.prototype.OnSourceChanged=function(n){this._internal=!0;try{switch(n.event){case e.Added:var i=this.converter.ConvertA2B(this,n.startIndex,n.newItem,this.stat);t.prototype.Add.call(this,i);break;case e.Cleared:t.prototype.Clear.call(this);break;case e.Removed:t.prototype.Remove.call(this,n.startIndex);break;case e.Replace:var i=this.converter.ConvertA2B(this,n.startIndex,n.newItem,this.stat);t.prototype.Set.call(this,n.startIndex,i);break;case e.Reset:this.Reset()}}catch(t){}this._internal=!1},n.prototype.Reset=function(){t.prototype.Clear.call(this);var e=this.Source;if(e){e=e.AsList();for(var n=0,i=e.length;n<i;n++){var r=this.converter.ConvertA2B(this,n,e[n],this.stat);t.prototype.Add.call(this,r)}}},n.prototype.Add=function(e){return this._internal?t.prototype.Add.call(this,e):void this.Source.Add(this.converter.ConvertB2A(this,this._list.length,e,this.stat))},n.prototype.Remove=function(e){return this._internal?t.prototype.Remove.call(this,e):void this.Source.Remove(this.converter.ConvertB2A(this,this._list.indexOf(e),e,this.stat))},n.prototype.Insert=function(e,n){return this._internal?t.prototype.Insert.call(this,e,n):void this.Source.Insert(e,this.converter.ConvertB2A(this,e,n,this.stat))},n.prototype.Clear=function(){return this._internal?t.prototype.Clear.call(this):void this.Source.Clear()},n.prototype.Order=function(t){},n.prototype.OrderBy=function(t){},n.prototype.Set=function(e,n){return this._internal?t.prototype.Set.call(this,e,n):void this.Source.Set(e,this.converter.ConvertB2A(this,e,n,this.stat))},n.DPSource=b.DObject.CreateField("Source",i,null,n.prototype.SourceChanged),n}(i);t.TransList=a;var u=function(){function t(t){this.DataContext=t}return t.prototype.GetType=function(){return t},Object.defineProperty(t.prototype,"DataContext",{get:function(){return this._dataContext},set:function(t){if(t!=this._dataContext){var e=this._dataContext;null!=e&&(e.Unlisten=this.initChanged),null!=t&&(t.Listen=this.initChanged),this._dataContext=t,this.OnSourceInitialized(e,t)}},enumerable:!0,configurable:!0}),t.prototype.initChanged=function(t){switch(t.event){case _.CollectionEvent.Added:this.OnItemAdded(t.newItem,t.startIndex);break;case _.CollectionEvent.Removed:this.OnItemRemoved(t.oldItem,t.startIndex);break;case _.CollectionEvent.Cleared:this.OnSourceCleared();break;case _.CollectionEvent.Reset:this.OnSourceReset();break;case _.CollectionEvent.Replace:this.OnSourceReplace(t.oldItem,t.newItem,t.startIndex)}},t}();t.Binding=u;var c=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.GetType=function(){return e},Object.defineProperty(e.prototype,"RendredList",{get:function(){return null==this._rendredList&&(this._rendredList=new _.List(Object,[])),this._rendredList},enumerable:!0,configurable:!0}),e.prototype.OnItemAdded=function(t,e){this.RendredList.Insert(e,this.Render(t))},e.prototype.OnItemRemoved=function(t,e){this.RendredList.RemoveAt(e)},e.prototype.OnSourceCleared=function(){this.RendredList.Clear()},e.prototype.OnSourceInitialized=function(t,e){if(null!=e){var n=e.Count;this.RendredList.Clear();for(var i=0;i<n;i++){var r=e.Count;this._rendredList.Add(this.Render(e.Get(r)))}}},e}(u);t.Render=c;var l=function(t){function e(e){var n=t.call(this)||this;if(n.quee=[],n._isExecuting=!1,!n.handler||!n.handler.Invoke)throw"argument (handler) null";return n.handler={Invoke:e.Invoke,Owner:e.Owner},Object.preventExtensions(n),n}return __extends(e,t),e.prototype.push=function(t){this.quee.push(t),this._isExecuting||this.EndOperation(void 0)},e.prototype.EndOperation=function(t){if(p.Get(this)!==t)throw new Error("Unknown frame");if(this.quee.length){this._isExecuting=!0,this.CurrentData=this.quee.shift();var t={data:this.CurrentData,quee:this};p.Set(this,t),r.helper.TryCatch(this.handler.Owner||this,this.handler.Invoke,function(t,e){e.quee.EndOperation(e)},[t])}else this._isExecuting=!1,this.CurrentData=void 0,p.Set(this,void 0)},__decorate([g.property(Object),__metadata("design:type",Object)],e.prototype,"CurrentData",void 0),e}(b.DObject);t.SyncQuee=l;var p=new _.Dictionary("quee_sync_frame")})(_=e.collection||(e.collection={})),function(t){function e(t){return t.tokon<=i.Parser.CToken.string}function o(t){return null==t?1:T[t]||L[t]}function a(t){return!R[t.Name]&&(s.$defineProperty(R,t.Name,{value:t,writable:!1,configurable:!1,enumerable:!1}),!0)}function u(t,e,n){var i=t.indexOf(":");if(i==-1)var r=null,o=t;else o=t.substring(0,i),r=t.substring(i+1);var s=R[o];if(!s)return e;var a=s.CreateNew(e,n&s.BindingMode,r);return a.Initialize(),a}var l=function(e){function n(t){var n=e.call(this)||this;return n._bindingMode=null==t?1:t,n}return __extends(n,e),n.prototype.getScop=function(t,e){return n.getAttribute(this,t.split(/[\s\\\/\.]+/),e)},n.prototype.findScop=function(t){var e=this;do{var n=t.pop();switch(n){case".":continue;case"..":e=e.getParent();break;default:var i=n.charCodeAt(0);if(36===i||126===i)throw"optimize your code by delete the first part befor ($|~)";e=e._scops&&e._scops[n]}}while(t.length>0)},n.prototype.getParent=function(){return this._parent},n.prototype.setParent=function(t){return t==this._parent||!!this.canBeParent(t)&&(this._parent=t,!0)},n.prototype.canBeParent=function(t){for(var e=t;e&&e!=this;)e=e.getParent();return!e},n.prototype.SetExParent=function(t,e){return this.setParent(t)||this.setParent(e)},n.prototype.findAttribute=function(t){for(var e=this,n=[];e;){if(n.indexOf(e)!=-1)return;if(e._scops&&e._scops.hasOwnProperty(t))return e._scops[t];n.push(e),e=this.getParent()}},n.getAttribute=function(t,e,n){if("string"==typeof e&&(e=[e]),!e||0==e.length)return t;var i=t.findAttribute(e[0]);if(!i&&!n)return null;for(i&&(t=i,e.shift());e.length;){var r=e.shift(),o=void 0;if(t._scops&&t._scops.hasOwnProperty(r))o=t._scops[r];else{if(!n)return null;t._scops||(t._scops={}),t._scops[r]=o=new P(null),o.setParent(t)}t=o}return t},n.prototype.setAttribute=function(t,e){var n=this.getScop(t,!0);n.Value=e},n.prototype.getAttribute=function(t,e){return n.getAttribute(this,[t],e)},n.__fields__=function(){return[n.DPValue]},Object.defineProperty(n.prototype,"BindingMode",{get:function(){return this._bindingMode},set:function(t){this._bindingMode=null==t?1:t},enumerable:!0,configurable:!0}),n.prototype.valueChanged=function(t,e){e.__this._OnValueChanged(e)},n.prototype._OnValueChanged_=function(t){return this._OnValueChanged(t)},n.Create=function(t,e,n,i){n=null==n?1:n;var r=t.split("|");if(1===r.length)return this.GenerateScop(t,e,n,i);for(var o=0;o<r.length;o+=2){var s=r[o],a=r[o+1];e=0===s.length?e:this.GenerateScop(s,e,n,i),e=0==a.length?e:u(a,e,n||3)||e}return e},n.BuildScop=function(e,r,o,s){var a=r;switch(e.tokon){case"keyword":a="this"===e.resut?s&&s.MainControll:"window"===e.resut?t.windowScop:r;break;case"anonymousscop":var a=S.UnRegister(e.resut).setController(s);a.setParent(r);break;case"bindscope":a=new t.Bind(e.resut,a,o).setController(s);break;case"namedscop":a=C.Create(e.resut,null,o);break;case"parentscop":for(var u=e.resut-1;u>=0;u--)a=a&&a.getParent();break;case"subscop":a=n.getAttribute(a,e.resut,!0).setController(s);break;case"typedscope":a=new I(a,e.resut,o).setController(s),a.setParent(r);break;case i.Parser.CToken.functionCall:a=new h(e.resut,r,s,o).setController(s),a.setParent(r);break;case i.Parser.CToken.arrayCall:a=new d(e.resut,r,s).setController(s),a.setParent(r);break;case i.Parser.CToken.condition:a=new v(e.resut,r,s).setController(s),a.setParent(r);break;case i.Parser.CToken.biCompute:a=new g(e.resut,r,s).setController(s),a.setParent(r);break;case i.Parser.CToken.uniCompute:a=new b(e.resut,r,s).setController(s),a.setParent(r);break;case i.Parser.CToken.path:for(var c=0,l=e.resut;c<l.length;c++){var p=l[c];a=this.BuildScop(p,a,o,s)}break;default:return null}return a},n.prototype.setController=function(t){return this.__Controller__&&this.__Controller__.unregisterScop(this),t&&(this.__Controller__=t),t&&t.registerScop(this),this},n.GenerateScop=function(t,e,r,o){if(""==t||null==t||"."==t)return e;var s=i.Parser.parseExpression(t);return s.success?n.BuildScop(s,e,r,o):(console.error("bind path : "+t),null)},n.GetStringScop=function(t,e,n){return p.GetStringScop(t,e,n)},n.prototype.AddJob=function(e,n){var i=new t.JobInstance(this,e,n);return this.__jobs__?this.__jobs__.push(i):this.__jobs__=[i],null!=e.OnInitialize&&e.OnInitialize(i,null),i},n.prototype.Dispose=function(){var t=this.OnDispose();if(null!==t){if(this.setParent(null),this.__jobs__){for(var n=0;n<this.__jobs__.length;n++){var i=this.__jobs__[n];i.IsDisposed||(i.Dispose(),f.Url)}this.__jobs__.length=0,this.__jobs__=null}e.prototype.Dispose.call(this),t||(this.DisposingStat=2)}},n.prototype.RegisterJob=function(t){this.__mjobs__||(this.__mjobs__={}),this.__mjobs__[t.Name]=t},n.prototype.GetJob=function(t){return this.__mjobs__&&this.__mjobs__[t]},n.prototype.getThis=function(){return this.__Controller__&&this.__Controller__.CurrentControl},Object.defineProperty(n.prototype,"__hasSegments__",{get:function(){return!1},enumerable:!0,configurable:!0}),n.prototype.forEach=function(t,e){},Object.defineProperty(n.prototype,"ParentValue",{get:function(){var t=this.getParent();return t&&t.Value},enumerable:!0,configurable:!0}),n.prototype.WhenIschanged=function(t,e){return this.OnPropertyChanged(n.DPValue,t,e).Dispose},n.prototype.OffIsIchangeing=function(t){},n.DPValue=t.DObject.CreateField("Value",Object,void 0,n.prototype._OnValueChanged_),n}(t.DObject);t.Scop=l;var p=function(e){function n(n,i,r){var o=e.call(this,t.BindingMode.SourceToTarget)||this;o.template=n;for(var s=0,a=n;s<a.length;s++){var u=a[s];"o"===(typeof u)[0]&&(u.scop=l.GenerateScop(u.Code,i,L.SourceToTarget,r),u.pb=u.scop.OnPropertyChanged(l.DPValue,o.Reset,o))}return o.setParent(i),o.Reset(void 0,void 0),o}return __extends(n,e),n.prototype.AttacheTo=function(t){this._dom=t,this._dom&&(this._dom.textContent=this.Value||"")},n.GetStringScop=function(t,e,r){for(var o=i.Parser.StringTemplate.Compile(t),s=0,a=o;s<a.length;s++){var u=a[s];if("o"===(typeof u)[0])return new n(o,e,r)}return t},n.prototype._OnValueChanged=function(t){this._dom&&(this._dom.textContent=t._new||"")},n.prototype.setParent=function(e){if(!this.canBeParent(e))return!1;var n=this._parent;n&&this.pb?n.removeEvent(t.Scop.DPValue,this.pb):this.pb=null,this._parent=e;for(var i=0;i<this.template.length;i++){var r=this.template[i];"o"===(typeof r)[0]&&r.scop instanceof t.Bind&&r.scop&&r.scop.setParent(e)}return!0},n.prototype.Reset=function(t,e){for(var n=0;n<this.template.length;n++){var r=this.template[n];"o"===(typeof r)[0]&&(r.result=r.scop&&r.scop.Value)}this.Value=i.Parser.StringTemplate.GenearteString(this.template)},n.prototype.FromJson=function(t,e,n){return this},n.prototype.ToJson=function(t,n){var i=e.prototype.ToJson.call(this,t,n);return i},n.prototype.Dispose=function(){var n=this.OnDispose();if(null!==n){this.setParent(null);for(var i=0;i<this.template.length;i++){var r=this.template[i];"o"===(typeof r)[0]&&r.scop instanceof t.Bind&&r.scop.Dispose()}e.prototype.Dispose.call(this),n||(this.DisposingStat=2)}},n}(t.Scop);t.StringScop=p;var h=function(t){function n(n,i,r,o){void 0===o&&(o=1);var s=t.call(this,o)||this;s.caller={scop:l.BuildScop(n.caller,i,L.SourceToTarget,r)},s._bindingMode&&(s.caller.pb=s.caller.scop.OnPropertyChanged(l.DPValue,s.Invoke,s)),s.args=new Array(n.args.length);for(var a=0;a<n.args.length;a++){var u=n.args[a];s.args[a]={isConstant:e(u),value:e(u)?u.resut:void 0,scop:e(u)?void 0:l.BuildScop(u,i,L.SourceToTarget,r)},!s.args[a].isConstant&&s._bindingMode&&(s.args[a].pb=s.args[a].scop.OnPropertyChanged(l.DPValue,s.Invoke,s))}return s._bindingMode&&s.Invoke(),s}return __extends(n,t),n.prototype._OnValueChanged=function(t){},n.prototype.Invoke=function(t,e){var n=this.caller.scop.Value;if("function"!=typeof n)return void(this.Value=n);for(var i=new Array(this.args.length),o=0;o<this.args.length;o++){var s=this.args[o];i[o]=s.isConstant?s.value:s.value=this.args[o].scop.Value}this.Value=r.helper.TryCatch(this.caller.scop.ParentValue,n,void 0,i)},n}(t.Scop);t.FunctionCallScop=h;var d=function(t){function n(n,i,r){var o=t.call(this,1)||this;o.caller={scop:l.BuildScop(n.caller,i,L.SourceToTarget,r)},o.caller.pb=o.caller.scop.OnPropertyChanged(l.DPValue,o.Reset,o);var s=n.index;return o.index={isConstant:e(s),value:e(s)?s.resut:void 0,scop:e(s)?void 0:l.BuildScop(s,i,L.SourceToTarget,r)},o.index.isConstant||(o.index.pb=o.index.scop.OnPropertyChanged(l.DPValue,o.Reset,o)),o.Reset(),o}return __extends(n,t),n.prototype._OnValueChanged=function(t){},n.prototype.Reset=function(t,e){var n=this.caller.scop.Value,i=this.index.isConstant?this.index.value:this.index.scop.Value;void 0==n?this.Value=void 0:n instanceof _.List?this.Value=n.Get(i):this.Value=n[i]},n}(t.Scop);t.ArrayCallScop=d;var y=function(){function n(n,i,r){this.isConstant=e(n),this.value=e(n)?n.resut:void 0,this.scop=e(n)?void 0:t.Scop.BuildScop(n,i,1,r)}return n.prototype.Dispose=function(){this.scop&&this.scop.Dispose(),this.pb&&this.pb.Dispose(),this.scop=void 0,this.pb=void 0,this.value=void 0},Object.defineProperty(n.prototype,"Value",{get:function(){return this.isConstant?this.value:this.scop.Value},set:function(t){this.isConstant?this.value=t:this.scop.Value=t},enumerable:!0,configurable:!0}),n.prototype.CaptureEvent=function(e,n){return this.isConstant?this.pb=D.observe(this,"value",e,n):this.pb=this.scop.OnPropertyChanged(t.Scop.DPValue,e,n),this},n}();t.IScopConst=y;var v=function(t){function e(e,n,i){var r=t.call(this,1)||this;return r.Condition=new y(e.condition,n,i).CaptureEvent(r._onConditionChanged,r),r.Success=new y(e.success,n,i).CaptureEvent(r._onSuccessChanged,r),r.Fail=new y(e.fail,n,i).CaptureEvent(r._onFailChanged,r),r.Value=r.Condition.Value?r.Success.Value:r.Fail.Value,r}return __extends(e,t),e.prototype._onConditionChanged=function(t,e){this.Value=e._new?this.Success.Value:this.Fail.Value},e.prototype._onSuccessChanged=function(t,e){this.Value=this.Condition.Value?e._new:this.Fail.Value},e.prototype._onFailChanged=function(t,e){this.Value=this.Condition.Value?this.Success.Value:e._new},e.prototype._OnValueChanged=function(t){},e.prototype.Dispose=function(){var e=this.OnDispose();null!==e&&(this.Condition.Dispose(),this.Fail.Dispose(),this.Success.Dispose(),t.prototype.Dispose.call(this),e||(this.DisposingStat=2))},e}(t.Scop);t.CondtionScop=v;var g=function(t){function e(e,n,i){var r=t.call(this,1)||this;return r.A=new y(e.a,n,i).CaptureEvent(r.Reset,r),r.Oper=e.o,r.B=new y(e.b,n,i).CaptureEvent(r.Reset,r),r.Reset(),r}return __extends(e,t),e.prototype.Reset=function(t,e){this.Oper.fn.isComplex?this.Value=this.Oper.fn(this.A,this.B):this.Value=this.Oper.fn(this.A.Value,this.B.Value)},e.prototype._OnValueChanged=function(t){},e.prototype.Dispose=function(){var e=this.OnDispose();null!==e&&(this.A.Dispose(),this.B.Dispose(),t.prototype.Dispose.call(this),e||(this.DisposingStat=2))},e}(t.Scop);t.BiComputeScop=g;var b=function(t){function e(e,n,i){var r=t.call(this,1)||this;return r.A=new y(e.a,n,i).CaptureEvent(r._onOperandChanged,r),r.Oper=e.o,r._onOperandChanged(),r}return __extends(e,t),e.prototype._onOperandChanged=function(t,e){this.Oper.fn.isComplex?this.Value=this.Oper.fn(this.A):this.Value=this.Oper.fn(this.A.Value)},e.prototype._OnValueChanged=function(t){},e.prototype.Dispose=function(){var e=this.OnDispose();null!==e&&(this.A.Dispose(),t.prototype.Dispose.call(this),e||(this.DisposingStat=2))},e}(t.Scop);t.UniComputeScop=b;var m={},C=function(t){function e(e,n){var i=t.call(this,n)||this;if("$"==e.charAt(0))throw"Name of scop cannot be started with '$' char";if(1!=c.names_scop_fromIn)throw"Access violatil";return i._name=e,e&&(m[e]=i),c.names_scop_fromIn=!1,i}return __extends(e,t),Object.defineProperty(e.prototype,"Name",{get:function(){return this._name},enumerable:!0,configurable:!0}),e.Get=function(t){return m[t]},e.prototype._OnValueChanged=function(t){},e.Create=function(t,n,i){var r=m[t];return null!=r?r:(c.names_scop_fromIn=!0,r=new e(t,i),r.Value=n,r)},e.prototype.Dispose=function(){var e=this.OnDispose();null!==e&&(t.prototype.Dispose.call(this),m[this.Name]=void 0,delete m[this.Name],e||(this.DisposingStat=2))},e}(l);t.NamedScop=C;var w=function(e){function n(n,i,r){var o=e.call(this,r)||this;return o.pb=null,o.observer=new t.Observer(null,[]),o.int=!1,"string"==typeof n&&(n=n.split(".")),o.Path=n,"string"==typeof i&&(i=C.Create(i,void 0)),o.int=!0,o.Parent=i,o.Value=o.observer.Value,1==(1&r)&&(o.observerBinding=o.observer.OnPropertyChanged(t.Observer.DPValue,o.__OnValueChanged,o)),o.int=!1,o}return __extends(n,e),n.__fields__=function(){return[n.DPParent,n.DPPath]},n.prototype.PathChanged=function(t){this.int=!0,this.observer.Path=null==t._new?[]:t._new,this.int=!1},n.ParentChanged=function(t){var e=t.__this,n=t._new,i=t._old;null!=i&&null!=e.pb&&i.removeEvent(l.DPValue,e.pb),null!=n?(e.pb=n.OnPropertyChanged(l.DPValue,e.ParentValueChanged,e),e.observer.Me=n.Value):e.observer.Me=null},n.prototype.Dispose=function(){var n=this.OnDispose();null!==n&&(this.removeEvent(l.DPValue,this.pb),this.observer.removeEvent(t.Observer.DPValue,this.observerBinding),this.observer.Dispose(),this.pb=null,this.observerBinding=null,this.observer=null,e.prototype.Dispose.call(this),n||(this.DisposingStat=2))},n.prototype.ParentValueChanged=function(t,e){this.int=!0,this.observer.Me=e._new,this.int=!1},Object.defineProperty(n.prototype,"Path",{get:function(){
return this.get(n.DPPath)},set:function(t){this.set(n.DPPath,t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Parent",{get:function(){return this.get(n.DPParent)},set:function(t){this.set(n.DPParent,t)},enumerable:!0,configurable:!0}),n.prototype.__OnValueChanged=function(t,e){this.isChanging=!0,this.Value=e._new,this.isChanging=!1},n.prototype.AttributeChanged=function(t){},n.prototype._OnValueChanged=function(t){if(!this.isChanging&&2===(2&this.BindingMode)&&!this.int){var e=this.observer,n=e.xpath,i=n.length;if(0===i)return;var r,o=n[i-1];r=1===i?e.Me:n[i-2].Value,r&&(null!=o.Property?r.set(o.Property,t._new):r[o.Name]=t._new)}},n.prototype.getParent=function(){return this.get(n.DPParent)},n.prototype.setParent=function(t){return!!this.canBeParent(t)&&(this.set(n.DPParent,t),!0)},n.prototype.getChildren=function(){return[]},Object.defineProperty(n.prototype,"Values",{get:function(){return this.observer.xpath},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Segments",{get:function(){return this.observer.xpath},enumerable:!0,configurable:!0}),n.prototype.forEach=function(t,e){for(var n=this.observer.xpath,i=n.length-1;i>=0;i--)if(t(n[i].Value,e))return{value:n[i].Value}},Object.defineProperty(n.prototype,"ParentValue",{get:function(){var t=this.observer.xpath;if(1==t.length){var e=this.getParent();return e&&e.Value}return t[t.length-2].Value},enumerable:!0,configurable:!0}),n.DPPath=t.DObject.CreateField("Path",Array,null,n.prototype.PathChanged),n.DPParent=t.DObject.CreateField("Parent",l,null,n.ParentChanged),n}(l);t.Bind=w;var S,O=-1,x=[];(function(t){function e(t){return x[++O]=t,O}function n(t){var e=x[t];return x[t]=void 0,e}function i(t){return x[t]}t.Register=e,t.UnRegister=n,t.Get=i})(S=t.AnonymouseScop||(t.AnonymouseScop={}));var P=function(t){function e(e,n){var i=t.call(this,n)||this;return i.Value=e,i}return __extends(e,t),e.prototype._OnValueChanged=function(t){},e}(l);t.ValueScop=P,t.windowScop=new P(window,0);var I=function(t){function e(e,i,r){var o=t.call(this,r)||this;return o.eq="="==i.type,o.itself=":"==i.type,o.type=n.context.GetType(i.path)||i.type,o.setParent(e),o}return __extends(e,t),e.prototype.getParent=function(){return this.parent},e.prototype.setParent=function(t){if(t!=this.parent)return this.parent&&this.pB&&this.parent.removeEvent(l.DPValue,this.pB),this.pB=t.OnPropertyChanged(l.DPValue,this.OnParentValueChanged,this),this.parent=t,this.reProcess(),!0},e.prototype._OnValueChanged=function(t){},e.prototype.OnParentValueChanged=function(t,e){this.reProcess()},e.prototype.reProcess=function(){for(var t=this.parent,e="string"==typeof this.type;t;){if(t.__hasSegments__&&void 0!==t.forEach(function(t,n){return n.checkType(t,e,!0)},this))return;if(this.checkType(t,e,this.itself))return;t=t.getParent(),this.setAttribute}},e.prototype.checkType=function(t,e,n){var i=n?t:t.Value;if(null!=i)if(e){if(i.constructor.name==this.type)return this.Value=i,!0}else if(this.eq?i.constructor===this.type:i instanceof this.type)return this.Value=i,!0},e}(l);t.TypedScop=I;var T={3:3,2:2,1:1,"":0,false:1,true:3},k=function(){function t(t){this.events={};for(var e=t.attributes,n=0;n<e.length;n++){var i=e[n].name;0===i.indexOf("db-")?this[i.substr(3)]=e[n].value:0===i.indexOf("on-")&&(this.events[i.substr(3)]=e[n].value)}this.twoway&&(this.twoway=o(this.twoway)),this.init=r.helper.TryCatch(JSON,JSON.parse,void 0,[this.init]),void 0!=this.stop&&(void 0!==typeof stop&&stop(),stop())}return t}();t.db=k;var A=function(){function t(t){this.scopFunction=t}return Object.defineProperty(t.prototype,"Name",{get:function(){return"Todo"},enumerable:!0,configurable:!0}),t.prototype.Todo=function(t,e){var n=this.scopFunction.Value;if(n instanceof Function){var i=this.scopFunction.getParent();n.call(i&&i.Value,t,e)}},t}();t.Todo=A;var E=(function(){function t(t){this.fns=t,0==t.indexOf("=")&&(t=t.substr(1))}return Object.defineProperty(t.prototype,"Name",{get:function(){return"FnTodo"},enumerable:!0,configurable:!0}),t.prototype.Todo=function(t,e){var n=this.fn;if(n instanceof Function){var i=t.Scop,r=i.__Controller__&&i.__Controller__.MainControll;n.call(r,e._old,e._new,i,t,e)}},t.register=function(t){f.EvalCode.CompileExpression(t,["ovalue","value","scop","job","event"],function(t,e){stop()},this,!0)},t.fns={},t}(),function(t){function e(e,n){var i=t.call(this,n)||this;return i.source=e,i}return __extends(e,t),e.prototype.Initialize=function(){this.source&&(this.dbb=this.source.OnPropertyChanged(l.DPValue,this.SourceChanged,this)),this.Value=this.Convert(this.source?this.source.Value:null)},e.prototype.SourceChanged=function(t,e){0!==(1&this._bindingMode)&&(this.isChanging||(this.isChanging=!0,this.Value=this.Convert(e._new),this.isChanging=!1))},e.prototype._OnValueChanged=function(t){0!==(2&this._bindingMode)&&(this.isChanging||(this.isChanging=!0,this.source.Value=this.ConvertBack(t._new),this.isChanging=!1))},e.prototype.Update=function(){this.Value=this.Convert(this.source.Value)},e.prototype.UpdateBack=function(){this.source.Value=this.ConvertBack(this.Value)},e.prototype.getParent=function(){return this.source},e.prototype.setParent=function(t){return!!this.canBeParent(t)&&(this.source&&this.source.removeEvent(l.DPValue,this.dbb),t&&(this.dbb=t.OnPropertyChanged(l.DPValue,this.SourceChanged,this)),this.source=t,this.Initialize(),!0)},e.prototype.Dispose=function(){this.source&&this.source.removeEvent(l.DPValue,this.dbb),this.source=null,t.prototype.Dispose.call(this)},e}(l));t.Filter=E;var V=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fraction=.3333,e}return __extends(e,t),Object.defineProperty(e.prototype,"Fraction",{set:function(t){if(this.fraction!==t)switch(this.fraction=t,this._bindingMode){case 0:return;case 2:return void this.UpdateBack();case 1:case 3:return void this.Update()}},enumerable:!0,configurable:!0}),e.prototype.Convert=function(t){return t/this.fraction},e.prototype.ConvertBack=function(t){return t*this.fraction},e}(E);t.DoubleFilter=V;var R={};t.RegisterFilter=a,t.CreateFilter=u;var L;(function(t){t[t.SourceToTarget=1]="SourceToTarget",t[t.TwoWay=3]="TwoWay",t[t.TargetToSource=2]="TargetToSource"})(L=t.BindingMode||(t.BindingMode={}));var j=function(){function t(t,e,n,i,r){this.bindingMode=t,this.a=e,this.b=n,this.pa=i,this.pb=r,this.dba=e.OnPropertyChanged(i,this.pac,this),this.dbb=n.OnPropertyChanged(r,this.pab,this),this.Dispose=this.Dispose.bind(this),e.OnDisposing=this.Dispose,n.OnDisposing=this.Dispose,t==L.TargetToSource?this.initB():this.init()}return t.prototype.init=function(){var t=this.a.GetValue(this.pa);this.b.set(this.pb,t)},t.prototype.initB=function(){var t=this.b.GetValue(this.pb);this.a.set(this.pa,t)},t.prototype.pac=function(t,e){0!=(1&this.bindingMode)&&(this.IsChanging||(this.IsChanging=!0,this.b.set(this.pb,e._new),this.IsChanging=!1))},t.prototype.pab=function(t,e){0!=(2&this.bindingMode)&&(this.IsChanging||(this.IsChanging=!0,this.a.set(this.pa,e._new),this.IsChanging=!1))},t.prototype.Dispose=function(){this.disposed||(this.disposed=!0,this.a.OffDisposing=this.Dispose,this.b.OffDisposing=this.Dispose,this.disposed=null,this.a.removeEvent(this.pa,this.dba),this.b.removeEvent(this.pb,this.dbb),this.a=null,this.b=null,this.dba=null,this.dbb=null,this.pa=null,this.pb=null)},t}();t.TwoBind=j;var M=function(){function t(t,e,n,i,r,o,s){this.bindingMode=t,this.a=e,this.b=n,this.pa=i,this.pb=r,this.con=o,this.conBack=s,this.dba=e.OnPropertyChanged(i,this.pac,this),this.dbb=n.OnPropertyChanged(r,this.pab,this),this.Dispose=this.Dispose.bind(this),e.OnDisposing=this.Dispose,n.OnDisposing=this.Dispose,2==t?this.initB():this.init()}return t.prototype.pac=function(t,e){0!=(1&this.bindingMode)&&(this.IsChanging||(this.IsChanging=!0,this.b.set(this.pb,this.con?this.con(e._new):e._new),this.IsChanging=!1))},t.prototype.pab=function(t,e){0!=(2&this.bindingMode)&&(this.IsChanging||(this.IsChanging=!0,this.a.set(this.pa,this.conBack?this.conBack(e._new):e._new),this.IsChanging=!1))},t.prototype.init=function(){var t=this.a.GetValue(this.pa);this.b.set(this.pb,this.con?this.con(t):t)},t.prototype.initB=function(){var t=this.b.GetValue(this.pb);this.a.set(this.pa,this.con?this.conBack(t):t)},t.prototype.Dispose=function(){this.disposed||(this.disposed=!0,this.a.OffDisposing=this.Dispose,this.b.OffDisposing=this.Dispose,this.disposed=null,this.a.removeEvent(this.pa,this.dba),this.b.removeEvent(this.pb,this.dbb),this.a=null,this.b=null,this.dba=null,this.dbb=null,this.pa=null,this.pb=null)},t}();t.TwoDBind=M}(b=e.bind||(e.bind={})),b.RegisterFilter({Name:"2bl",BindingMode:3,CreateNew:function(t,e,n){var i=new b.DoubleFilter(t,e);return n&&(i.Fraction=parseFloat(n)),i}});var C;(function(t){function e(t,e){i[t]=e}function n(t){var e=i[t.name];if(e)return e(t)}var i={};t.register=e,t.create=n})(C=e.ScopicControl||(e.ScopicControl={}));var w;(function(t){function e(t,e,n){var i=n?n:"@"+ ++s;return o[i]={callback:t,Param:e},i}function n(t,e,n){var i=o[t];return i?i.callback.Invoke.call(i.callback.Owner,t,e,n,i.Param):void 0}function i(t){delete o[t]}function r(t){return null!=o[t]}var o={},s=0;t.Register=e,t.Call=n,t.Delete=i,t.contains=r})(w=e.ScopicCommand||(e.ScopicCommand={}));var S;(function(t){function e(t){if("string"!=typeof t.Name)return!1;if(t.DoApiCallback instanceof Function==!1)return!1;var e=a[t.Name];if(null==e)e={Callback:[t],Trigger:void 0},s.$defineProperty(a,t.Name,{value:e,configurable:!1,enumerable:!1,writable:!1});else{if(e.Callback.indexOf(t)!==-1)return;e.Callback.push(t)}o(t)}function n(t){if("string"!=typeof t.Name)return!1;if(t.Filter&&!(t.Filter instanceof Function))return!1;var e=a[t.Name];if(null==e)e={Callback:[],Trigger:t},a[t.Name]=e,o(e);else{if(null!=e.Trigger)throw"This Command Exist";e.Trigger=t,o(e)}o(t)}function i(t,e){var n=a[t];if(!n)throw"Cmd Is Not Exist";var i=n.Trigger;if(i){if(i.CheckAccess&&!i.CheckAccess(i))throw"Access denied";var o=i.Filter}for(var s=n.Callback,u=0,c=s.length;u<c;u++){var l=s[u];o&&!i.Filter(l,e)||r.helper.TryCatch(l,l.DoApiCallback,void 0,[i,l,e])}}var o=Object.freeze,a={};t.RegisterApiCallback=e,t.RegisterTrigger=n,t.RiseApi=i})(S=e.Api||(e.Api={}));var O;(function(t){function e(t){try{return t.parser?t.parser(t.e):t.e.value}catch(t){return t.e.value}}var i=function(){function t(t,e){this.Owner=t,this.Property=e}return t.prototype.Set=function(t){return this.Owner.set(this.Property,t),this.executed=!0,t},t}();t.BPath=i;var o=function(){function t(t,e){this.Owner=t,this.Property=e}return t.prototype.Set=function(t){return this.Property instanceof b.DProperty?this.Owner.set(this.Property,t):this.Owner[this.Property]=t,this.executed=!0,t},t}();t.Path=o;var s=function(){function t(t,e){this.Owner=t,this.Property=e}return t.prototype.Set=function(t){return this.Owner.Insert(this.Property,t)||this.Owner.Add(t),this.executed=!0,t},t}();t.LPath=s;var a=new _.Dictionary("SerializationContext",!1),u=function(){function t(t){this._ext=[],this.indexer=new _.Dictionary("Indexer",!0),this.refs=[],this.cnt=0,t?this._store=a:this._store=new _.Dictionary("SerializationContext",!1)}return t.prototype.Dispose=function(){this.reset(),this._ext=null,this._store=null,this.cnt=null,this.indexer=null,this.refs=null},t.prototype.Register=function(t,e){this._store.Set(t,e)},t.prototype.UnRegister=function(t){return this._store.Remove(t)},t.prototype.GetRegistration=function(t){return this._store.Get(t)},t.prototype.Append=function(t){this._ext.push(t)},t.prototype.Get=function(t){var e=this._store.Get(t);if(e)return e;for(var n=this._ext,i=n.length-1;i>=0;i--)if(null!=(e=n[i].Get(t)))return e;return null},t.prototype.get=function(t,e){var n=this.refs[t];if(n){if(n.setted)return e?e.Set(this.refs[t].val):this.refs[t].val;if(!e)throw"entry Point not Found";n.paths?n.paths.push(e):n.paths=[e]}else{var i={val:void 0,paths:[e]};this.refs[t]=i}},t.prototype.set=function(t,e){var n=this.refs[t];if(n){if(n.val=e,n.setted=!0,n.paths)for(var i=0;i<n.paths.length;i++)n.paths[i].Set(e)}else this.refs[t]={val:e,setted:!0}},t.prototype.getJson=function(t){var e=this.indexer.Get(t);if(null==e){var i={__ref__:++this.cnt},r={"@ref":i};if(this.indexer.Set(t,e={ref:i,json:r,valid:!1}),t instanceof b.DObject){var o=n.context.NameOf(t.constructor);null!=o&&(r.__type__=o)}}return e},t.prototype.reset=function(){return this.indexer.Clear(),this.cnt=0,this.refs.length=0,this},t.getType=function(t){for(;;)if(t instanceof r.reflection.DelayedType)t=t.Type;else{if(!(t instanceof r.reflection.GenericType))return t;t=t.Constructor}},t.prototype.FromJson=function(t,e,i){if(null==t)return i?i.Set(t):t;if(e instanceof r.reflection.DelayedType&&(e=e.Type),e instanceof r.reflection.GenericType&&(e=e.Constructor),e===String||e===Number||e===Boolean)return i?i.Set(t):t;if(e===Date)return"string"==typeof t?i.Set(new Date(Date.parse(t))):i.Set(new Date(t));if("number"==typeof t.__ref__)return this.get(t.__ref__,i);var o,s=t["@ref"];if(delete t["@ref"],r.reflection.IsInstanceOf(e,b.DObject))e.CreateFromJson&&(o=e.CreateFromJson(t,e,!!this.RequireNew&&this.RequireNew(t,e))),null==o&&(o=new e),s&&this.set(s.__ref__,o),o=o.FromJson(t,this);else{if(null!=e.prototype&&e.prototype.hasOwnProperty("fromJson"))o=e.prototype.fromJson(t,n.context,s);else{var a=this.Get(e);o=null!=a?a.FromJson(t,this,s):t}s&&this.set(s.__ref__,o)}return i?i.Set(o):o},t.prototype.ToJson=function(t){if(null===t)return null;switch(typeof t){case"undefined":case"boolean":case"number":case"string":return t;case"function":return t.toString();default:var e=this.getJson(t);if(e.valid)return e.ref;if(t===Object)return this._toJson(t,e);if(t instanceof b.DObject)return t.ToJson(this,e);var n=this.Get(t.constructor);return n?n.ToJson(t,this,e):this._toJson(t,e)}},t.prototype._toJson=function(t,e){if(e.valid=!0,t instanceof Array)return this._arrayToJson(t,e);e.json={};for(var n in t)e.json[n]=this.ToJson(t[n]);return e.json},t.prototype.toString=function(){JSON.stringify(this)},t.prototype._arrayToJson=function(t,e){for(var n=[],i={__type__:l.Array,__value__:n,"@ref":e.ref.__ref__},r=0;r<t.length;r++)n[r]=this.ToJson(t[r]);return i},t.GlobalContext=new t(!0),t}();t.SerializationContext=u;var c=function(){function t(e,n,i){this.input=e,this.autoParse=n,this.asJson=i,this.e={csv:this,index:-1,value:void 0,set:function(t,e){return this.value=t,this.index=e,this}},this.Columns=new Array,this._current=void 0,this._cursor=t.readLine(e,void 0,{cols:this.Columns,csv:this,e:this.e,parser:function(t){return t.value}}),Object.defineProperty(this,"_startCursor",{value:this._cursor,configurable:!1,writable:!1,enumerable:!1}),this._current=i?{}:new Array(this.Columns.length)}return t.ReadAllLines=function(t){for(var e=[],n=0,i=!1,r=0;r<t.length;r++){var o=t[r];"\\"!=o?('"'==o&&"\\"!==t[r-1]&&(i=!i),i||"\r"==o&&(e.push(t.substr(n,r-n)),"\n"==t[r+1]&&r++,n=r+1)):r++}return e},t.prototype.parse=function(t,e){},t.isEmptyLine=function(t,e){if(e){if(e.EOF)return!0}else e={cursor:0,value:void 0};var n=e.cursor||0,i=(t[n],t[n+1]);if("\r"==i){var r=t[n+2];if("\n"==r)var o={cursor:n+3,EOF:null==t[n+3],len:2,newLine:!0,value:"\r\n"};else o={cursor:n+2,EOF:void 0==r,len:1,newLine:!0,value:"\r"}}else o={cursor:n+1,EOF:void 0==i,len:0,newLine:!1,value:""};return!!o.EOF||!(!o.newLine||!e.newLine)},t.trim=function(t,e){if(e){if(e.EOF)return e}else e={cursor:0,value:void 0};var n=e.cursor||0,i=(t[n],t[n+1]);if("\r"==i){var r=t[n+2];if("\n"==r)var o={cursor:n+3,EOF:null==t[n+3],len:2,newLine:!0,value:"\r\n"};else o={cursor:n+2,EOF:void 0==r,len:1,newLine:!0,value:"\r"}}else{if(void 0!=i)return e;o={cursor:n+1,EOF:!0,len:0,newLine:void 0,value:void 0}}return o},t.nextChar=function(t,e){if(e){if(e.EOF)return e}else e={cursor:0,value:void 0};for(var n,i=e.cursor,r=i;r<t.length;){n=o;var o=t[r++];if(o===this.separator)return{value:o,cursor:r};if('"'===o){if("\\"!==n)return{value:'"',cursor:r-1}}else if("\r"===o){var s="\n"===t[r];return s&&r++,{value:s?"\r\n":o,cursor:r,newLine:!0,len:s?2:1}}}return{value:void 0,cursor:t.length,EOF:!0}},t.readString=function(t,e){var n=e.cursor,i=n,r=t[i];if('"'!==r)return null;for(;++i<t.length;){if('"'==t[i]&&"\\"!==r)return{value:t.substring(e.cursor,i+1),cursor:i+1,EOF:i==t.length-1};r=t[i]}return{value:t.substring(n),cursor:t.length,EOF:!0}},t.readColumn=function(t,e){if(e){if(e.EOF)return}else e={cursor:0,value:void 0};for(var n=e;;){var i=this.nextChar(t,n);if(i.value===this.separator)return{value:t.substring(e.cursor,i.cursor-1),EOF:!1,cursor:i};if(i.EOF)return{value:t.substr(e.cursor),EOF:!0,cursor:i};if(i.newLine)return{value:t.substring(e.cursor,i.cursor-i.len),EOF:!1,cursor:i};if('"'===i.value){var r=this.readString(t,i);n=r}}},t.clear=function(t,e){for(;e<t.length;e++)t[e]=void 0;return t},t.fillColumns=function(t,n,i){i.e||(i.e={csv:void 0,set:function(t,e){return this.value=t,this.index=e,this}});var r=i.cols,o=i.header,s=r instanceof Array;if(n&&n.EOF)return s&&this.clear(r,0),n;var a=0,u=n;do{var c=this.readColumn(t,u);if(!c)return s&&this.clear(r,a),{EOF:!0,cursor:t.length,value:void 0};u=c.cursor,i.e.set(c.value,a);var l=e(i);s?r[a]=l:o[a]&&(r[o[a]]=l),a++}while(!u.EOF&&a<(s?r:o).length&&!u.newLine);if(!u.EOF&&!c.cursor.newLine)for(;u&&!u.EOF&&!u.newLine;)c=this.readColumn(t,u),u=c&&c.cursor;return s&&this.clear(r,a),u},t.readLine=function(t,n,i){i.e||(i.e={csv:void 0,set:function(t,e){return this.value=t,this.index=e,this}});var r=i.cols,o=i.header,s=r instanceof Array;if(s&&(r.length=0),n&&n.EOF)return n;var a=n,u=0;do{var c=this.readColumn(t,a);if(!c)return{EOF:!0,cursor:t.length,value:void 0};a=c.cursor,i.e.set(c.value,u);var l=e(i);s?r.push(l):o[u]&&(r[o[u]]=l),u++}while(!c.EOF&&!c.cursor.newLine);return a},t.prototype.ColumnName=function(t){return this.Columns[t]||""},t.prototype.ColumnIndex=function(t){return this.Columns.indexOf(t)},Object.defineProperty(t.prototype,"Cursor",{get:function(){return this._cursor},enumerable:!0,configurable:!0}),t.prototype.Reset=function(){return this._cursor=this._startCursor,this},t.prototype.Next=function(e){if(this._cursor.EOF)return!1;if(!this.AllowNullValue)for(;;){var n=t.trim(this.input,this._cursor);if(n===this._cursor)break;if(n.EOF)return!1;{if(!n.newLine)break;this._cursor=n}}return this._cursor=t.fillColumns(this.input,this._cursor,this.swapArgs(e)),!0},t.prototype.swapArgs=function(t){return t?(t.cols||(t.cols=this._current),t.header||(t.header=this.Columns||[]),t.csv||(t.csv=this),t.e||(t.e=this.e),t):{cols:this._current,parser:this.autoParse?this.jsonParser:void 0,header:this.Columns||[],csv:this,e:this.e}},t.prototype.jsonParser=function(t){return t.value?JSON.parse(t.value):void 0},Object.defineProperty(t.prototype,"Current",{get:function(){return this._current},enumerable:!0,configurable:!0}),t.prototype.Field=function(t){var e=this.Current;return e?this.Current["string"==typeof t?this.Columns.indexOf(t):t]:null},t.separator=";",t.emptyArray=Object.freeze([]),t}();t.CSV=c;var l;(function(t){t[t.Nullable=0]="Nullable",t[t.Boolean=1]="Boolean",t[t.Number=2]="Number",t[t.String=3]="String",t[t.Function=4]="Function",t[t.Array=5]="Array",t[t.Object=6]="Object",t[t.DObject=7]="DObject"})(l=t.NativeTypes||(t.NativeTypes={}))})(O=e.encoding||(e.encoding={}));var x=function(){function t(t,e,n){this.node=t,this.param=e,this.unknown=n,this.children=[],n||(this.unknown=[])}return t.prototype.add=function(e,n){var i=new t(e,n,this.unknown);return i=this.__add(i),this.unknown.length?this.Validate():i},t.prototype.__add=function(t){var e=this._add(t);if(e)return e;for(var n=0;n<this.unknown.length;n++)if(e=this.unknown[n]._add(t))return e;for(var n=0;n<this.unknown.length;n++)if(this.unknown[n].node==t.node)return this;return this.unknown.push(t),this},t.prototype.Validate=function(){for(var t=0;t<this.unknown.length;t++){var e=this._add(this.unknown[t]);e&&(this.unknown.splice(t,1),t--)}return this},t.prototype.ReValidate=function(t){if(this.unknown)for(var e=0;e<this.unknown.length;e++)this.node.contains(this.unknown[e].node)&&(t(this.unknown[e]),this.unknown.splice(e,1),e--)},t.prototype.get=function(t){for(var e=0;e<this.children.length;e++){var n=this.children[e];if(n.node==t)return n;if(n=n.get(t))return n}},t.prototype._add=function(t){if(this.node.contains(t.node)){for(var e=0;e<this.children.length;e++){var n=this.children[e];if(t.node==n.node)return this;if(n._add(t))return this;t.node.contains(n.node)&&this.children.splice(e,1,n)}return this.children.indexOf(t)==-1&&this.children.push(t),this}return this.node==t.node?this:t.node.contains(this.node)?t._add(this):void 0},t.prototype.remove=function(t){for(var e=0;e<this.children.length;e++){var n=this.children[e];if(n.node==t)return this.children.push.apply(this.children,n.children),this.children.splice(e,1),n;if(n=n.remove(t))return n}},t.prototype.hasChild=function(t){for(var e=0;e<this.children.length;e++){var n=this.children[e];if(t.contains(n.node))return n;if(n=n.hasChild(t))return n}},t.prototype.foreach=function(t,e){var n=t(e,this);if(n>0)return n;for(var i=0;i<this.children.length;i++){var n=this.children[i].foreach(t,this);if(n>0)return n-1}return 0},t}();e.xNode=x;var P;(function(t){var e=function(){function t(t,e){this._key=t,this._value=e}return Object.defineProperty(t.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),t}();t.Header=e;var n;(function(t){t[t.json=0]="json",t[t.document=1]="document",t[t.text=2]="text",t[t.arraybuffer=3]="arraybuffer",t[t.blob=4]="blob"})(n=t.ResponseType||(t.ResponseType={}));var i;(function(t){t[t.Get=0]="Get",t[t.Post=1]="Post",t[t.Head=2]="Head",t[t.Put=3]="Put",t[t.Delete=4]="Delete",t[t.Options=5]="Options",t[t.Connect=6]="Connect",t[t.Create=7]="Create",t[t.Open=8]="Open",t[t.Close=9]="Close",t[t.Validate=10]="Validate",t[t.FastValidate=11]="FastValidate",t[t.Print=12]="Print",t[t.UPDATE=13]="UPDATE",t[t.SUPDATE=14]="SUPDATE",t[t.Set=15]="Set"})(i=t.WebRequestMethod||(t.WebRequestMethod={}));var o=function(){function t(t){this.crypt=t,this.http=new XMLHttpRequest,this._responseType=null,this.key=new Object,this.OnComplete=new b.EventListener(this.key),this.http.addEventListener("loadend",this.downloadDelegate=new f.Delegate(this,this._onprogress,function(t){t.Owner.http.removeEventListener("loadend",t),t.Owner.http.removeEventListener("error",t)})),this.http.addEventListener("error",this.downloadDelegate)}return t.prototype.getResponseType=function(){return"number"==typeof this._responseType?this._responseType:n.text},t.prototype.setResponseType=function(t){return this._responseType=t,t},Object.defineProperty(t.prototype,"Crypto",{set:function(t){this.crypt=t},enumerable:!0,configurable:!0}),t.prototype.Dispose=function(){this.OnComplete.Dispose(),this.downloadDelegate.Dispose(),this.key=null,this.http=null,this.OnComplete=null,this.downloadDelegate=null},t.prototype._onprogress=function(t){var e=null;switch(this.http.readyState){case 4:e=this.OnComplete;break;default:return}if(e){var n=this;e.Invoke(this.key,[n])}},Object.defineProperty(t.prototype,"IsSuccess",{get:function(){return 200==this.http.status&&4==this.http.readyState},enumerable:!0,configurable:!0}),t.prototype.Download=function(t,e){this.http.open(i[t.Method],t.Url,!0,this.Uid,this.Pwd),this.http.setRequestHeader("xreq",btoa((this.Uid||"")+":"+(this.Pwd||""))),this.http.responseType=n[this.getResponseType()].toLowerCase(),t.Method===i.Get?this.http.send():this.http.send(JSON.stringify(e))},t.prototype.Download2=function(t){if(t.url.beforRequest&&!t.url.beforRequest(t.url))return this.OnComplete&&this.OnComplete.Invoke(this.key,[this]);var e=t.url;this.http.open(i[e.Method],this.getUrlOf(t),!0,this.Uid,this.Pwd),this.http.setRequestHeader("xreq",btoa((this.Uid||"")+":"+(this.Pwd||""))),this.http.setRequestHeader("Access-Control-Allow-Origin","*"),t.url.timeout?this.http.timeout=t.url.timeout:this.http.timeout=0,this.http.responseType=n[t.url.ResponseType]||"text",this.http.send(this.getDataOf(t))},t.prototype.getUrlOf=function(t){var e=t.url,n=e.Url;if(t.params){var i=n.lastIndexOf("?")!=-1;for(var r in t.params)n+=(i?"&":(i=!0)&&"?")+(encodeURI(r)+"="+encodeURI(String(t.params[r])))}return n},t.prototype.getDataOf=function(t){var e=t.url;if(e.HasBody===!0&&e.Method!==i.Get&&void 0!==t.data)return t.data.OutputData()},t.prototype.GetFileSize=function(t,e){this.http.open("HEAD",t,!0,this.Uid,this.Pwd),this.http.onreadystatechange=function(){this.readyState==this.DONE&&e&&e(parseInt(this.getResponseHeader("Content-Length")))},this.http.send()},t.prototype.RequestHeader=function(t,n){this.http.open("HEAD",t,!0),this.http.onreadystatechange=function(){if(this.readyState==this.DONE&&n){for(var t=this.getAllResponseHeaders().split("\r\n"),i=[],r=t.length-1;r>=0;r--){var o=t[r];if(o){var s=o.split(": ");i.push(new e(s[0],s[1]))}}n(i)}},this.http.send()},Object.defineProperty(t.prototype,"Response",{get:function(){return this.http.response},enumerable:!0,configurable:!0}),t.prototype.GetHeader=function(t){return this.http.getResponseHeader(t)},t.prototype.GetHeaders=function(){return this.http.getAllResponseHeaders()},t}();t.WebRequest=o;var s=function(){function t(t,e,n){this.callback=t,this.data=e,this.isPrivate=n,this.IsSuccess=null,void 0==n&&(this.isPrivate=!1)}return t.prototype.Callback=function(t,e){this.callback&&this.callback(t,e)},t}();t.RequestParams=s;var a=function(){function t(t,e,n){this.url=t,this.data=e,this.params=n,this.fail=void 0}return t}();t.Request=a;var u=function(){function e(e){this.crypt=e,this.quee=[],this.isRunning=!1,this.isDownloading=!1,this.OnSuccess=new b.EventListener(1),this.OnFail=new b.EventListener(1),this.OnFinish=new b.EventListener(1),this.webr=new t.WebRequest(e),this.webr.setResponseType(t.ResponseType.text),this.webr.OnComplete.Add(this.DownloadComplete.bind(this),"DCT")}return Object.defineProperty(e.prototype,"Uid",{set:function(t){this.webr.Uid=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Pwd",{set:function(t){this.webr.Pwd=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Request",{get:function(){return this.webr},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Crypto",{set:function(t){this.webr.Crypto=t},enumerable:!0,configurable:!0}),e.prototype.OnError=function(){if(this.isDownloading=!1,this.current){var t=!0,e=this.current.data;e instanceof s&&(e.IsSuccess=!1,r.helper.TryCatch(e,e.Callback,void 0,[this,this.webr]),t=!e.isPrivate),t&&this.OnFail.PInvok(1,[this,e],this)}this.Next()},e.prototype.DownloadComplete=function(t){this.isDownloading=!1;var e=this.webr.IsSuccess?this.OnSuccess:this.OnFail;if(this.current){var n=!0,i=this.current.data;i instanceof s&&(i.IsSuccess=this.webr.IsSuccess,r.helper.TryCatch(i,i.Callback,void 0,[this,this.webr]),n=!i.isPrivate),n&&e.PInvok(1,[this,i],this)}this.Next()},e.prototype.Push=function(t,e,n){this.quee.push(new a(t,e,n)),this.isRunning||this.Start()},e.prototype.Insert=function(t){this.quee.push(t),this.isRunning||this.Start()},e.prototype.Start=function(){this.isDownloading||(this.isRunning=!0,this.Next())},e.prototype.Next=function(){if(0==this.quee.length){this.isRunning=!1,this.isDownloading=!1;var t=this;return void this.OnFinish.Invoke(1,[t,t.current.data])}try{this.webr.Download2(this.current=this.quee.shift()),this.isDownloading=!0}catch(t){this.isDownloading=!1,this.OnError()}},e.prototype.Restart=function(){this.isDownloading=!1,this.Start()},e}();t.QueeDownloader=u})(P=e.net||(e.net={})),function(t){var e=function(){function e(e,n,i,r,o,s){this._url=e,this.context=n,this.Header=i,this.Method=r,this.HasBody=o,this.ResponseType=s,void 0==r&&(this.Method=t.WebRequestMethod.Get)}return Object.defineProperty(e.prototype,"Url",{get:function(){return this.context?this.context.GetPath(this._url):this._url},set:function(t){this._url=t},enumerable:!0,configurable:!0}),e}();t.RequestUrl=e}(P=e.net||(e.net={})),function(t){var e=new _.Dictionary("ethandler"),n=function(){function t(t,n,i,r,o){this.dom=t,this.event=n,this.owner=i,this.handle=r,this.param=o,this.Started=!1,e.Set(this,t)}return t.prototype.Start=function(){this.Started===!1&&(this.Started=!0,this.dom.addEventListener(this.event,this))},t.prototype.Pause=function(){this.Started===!0&&(this.Started=!1,this.dom.removeEventListener(this.event,this))},t.prototype.Dispose=function(){void 0!==this.Started&&(this.Pause(),e.Remove(this),this.dom=void 0,this.event=void 0,this.handle=void 0,this.Started=void 0,this.param=void 0)},t.prototype.Reset=function(){this.Pause(),this.Start()},t.prototype.handleEvent=function(t){this.handle.call(this.owner,this,t,this.param)},t.Dispose=function(t,n){var i;if(null==n)for(var r=0,o=e.RemoveAllValues(t);r<o.length;r++)o[r].Dispose();else for(;;){if((i=e.IndexOfValue(t,i))===-1)break;e.RemoveAt(i).Key.Dispose()}},t}();t.DomEventHandler=n}(f=e.basic||(e.basic={})),function(t){t.backups=new _.Dictionary("buckups"),b.NamedScop.Create("window",window,0)}(s||(s={}));var I;(function(t){var e=function(){function t(){}return t}();t.t1=e;var n=function(){function t(){}return t}();t.t2=n;var i=function(){function t(){}return t}();t.t3=i})(I=e.Ids||(e.Ids={}));var D;(function(t){function e(t,e,n,i){if(e=String(e),t instanceof b.DObject){var r=t.GetProperty(e);if(r)return a=t,t.OnPropertyChanged(r,function(t,e){n(e._new,e._old)},i)}var o=Object.getOwnPropertyDescriptor(t,e);if(!o||o&&o.configurable&&!o.get){var s=u.create(t);return s.observe(o,e,n,i)}return a=null,null}function n(t,e,n,i){function r(t){for(t=0;t<e.length;t++){var n=(e[t],o[t]),i=n.obj;if(!i)return;n.pb&&(i instanceof u?i.unobserve(n.propName,n.pb):i.UnObserve(i.GetProperty(n.propName),n.pb),n.pb=null)}}for(var o=new Array(e.length),s=t,a=0;a<e.length;a++){var c=s[e[a]];o.push({propName:e[a],obj:null,value:c,pb:null}),s=c}r(0)}function i(t,e,n,i){if(e=String(e),t instanceof b.DObject){var r=t.GetProperty(e);if(r)return t.UnObserve(r,n,i)}var o=u.create(t);if(!o)return!1;o.unobserve(e,n,i);var s=o.get(e);return!!s&&s.UnObserve(n,i)}function o(t,n,i){if(n&&t)return e(this,"string"==typeof t?t:t.Name,n,i)}function s(t,e,n){if(e&&t)return i(this,"string"==typeof t?t:t.Name,e,n)}var a,u=function(){function t(t){this.obj=t,this.props={}}return t.prototype.create=function(t,e){var n=this.props[t];return n?n:this.props[t]=new c(this,t,e)},t.prototype.get=function(t){return this.props[t]},t.create=function(e){var n=this.store.Get(e);return n||this.store.Set(e,n=new t(e)),n},t.get=function(t){return this.store.Get(t)},t.prototype.observe=function(t,e,n,i){if(t=Object.getOwnPropertyDescriptor(this.obj,e),!t||t&&t.configurable&&!t.get){var r=this.create(e,t);t?t.set?Object.defineProperty(this.obj,e,{get:t.get,set:r.set,enumerable:t.enumerable}):Object.defineProperty(this.obj,e,{get:r.get,set:r.set,enumerable:t.enumerable}):Object.defineProperty(this.obj,e,t={get:r.get,set:r.set});var o;return r.callback.push(o=new b.PropBinding(n,i)),o}return null},Object.defineProperty(t.prototype,"Obj",{set:function(t){for(var e in this.props)this.props[e].set(t&&t[e])},enumerable:!0,configurable:!0}),t.prototype.unobserve=function(t,e,n){var i=this.get(t);return!!i&&i.UnObserve(e,n)},t.store=new _.Dictionary(""),t}(),c=function(){function t(t,e,n){this.parent=t,this.p=n,this.callback=[],this.prop={Name:e,Type:Object,Index:-1},this.set=this.set.bind(this),this.get=this.get.bind(this),this.value=t.obj[e]}return t.prototype.getInstCallback=function(){return this.callback},t.prototype.set=function(t){var e=this.value;t!=e&&(this.value=t,this.p&&this.p.set&&this.p.set.call(this.parent.obj,t),this.onPropertyChanged(e,t))},t.prototype.get=function(){return this.p&&this.p.get&&this.p.get.call(this.parent.obj),this.value},t.prototype.onPropertyChanged=function(t,e){for(var n=b.EventArgs.New(this.prop,this.parent.obj,t,e),i=0;i<this.callback.length;i++){var o=this.callback[i];r.helper.TryCatch(o,o.handleEvent,void 0,[n]);
}},t.prototype.addEventListener=function(t,e){this.callback.push(new b.PropBinding(t,e))},t.prototype.UnObserve=function(t,e){if(this)if("function"!=typeof t){var n=this.callback.indexOf(t);if(n!=-1)return t.Dispose(),this.callback.splice(n,1)}else{for(var i,r,n=this.callback.length-1;n>=0;n--){var o=this.callback[n];if(o.Invoke==t){if(o.Owner===e)return o.Dispose(),this.callback.splice(n,1),!0;i||(i=o,r=n)}}if(i)return i.Dispose(),this.callback.splice(r,1),!0}return!1},t}();t.observe=e,t.observePath=n,t.unobserve=i,Object.defineProperty(Object.prototype,"Observe",{writable:!1,enumerable:!1,value:o}),Object.defineProperty(Object.prototype,"UnObserve",{writable:!1,enumerable:!1,value:s})})(D=e.injecter||(e.injecter={}));var T;(function(t){function e(t,e){s.$defineProperty(e,"Id",{value:e.Id||++a,writable:!1,configurable:!1,enumerable:!0}),o[t]?o[t].push(e):o[t]=[e]}function n(t,e){var n=o[t];if(n&&n.length){var i={data:e,name:t,handler:void 0};e=e?e.slice(0):[],e.unshift(i);for(var s=0;s<n.length;s++){var a=n[s];i.handler=a,r.helper.TryCatch(a.owner||a,a.callback,void 0,e)}}}function i(t,e){var n=o[t];if(!n||!n.length)return!0;var i=n.indexOf(e);if(i==-1)for(var r=0;r<n.length;r++){var s=n[r];if(s.Id===e){i=r;break}}return i!==-1&&n.splice(i,1),!0}var o={},a=0;t.on=e,t.fire=n,t.off=i})(T=e.Notification||(e.Notification={}))}),define("sys/defs",["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})}),define("sys/db",["require","exports","sys/Corelib","sys/System","context","sys/runtime"],function(t,e,n,i,r,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s;(function(t){var e="function"==typeof openDatabase,s=function(){function t(){this.databaseName="data_store",this.databaseDesc="Data store",this.sqlLiteDBVersion="1.0",this.FIVE_MB=5120,this.tableName="data-store",this._tables__=new l(this),this.shemas=new u(this,"__tables__",c),this.OnLoad=new n.bind.FEventListener(0,!0),this.queue=[],this._commands=[],this._current={value:null},this._IsExecuting=!1,this._job=o.thread.Dispatcher.cretaeJob(this._runCmd,[],this,!1),this._store={},this.__info__=new u(this,"__info__",p)}return t.prototype.initialize=function(){var t=this;return e?(this.database=openDatabase(this.databaseName,this.sqlLiteDBVersion,this.databaseDesc,this.FIVE_MB),this._transaction=this._transaction.bind(this),this._OnError=this._OnError.bind(this),this._OnSuccess=this._OnSuccess.bind(this),this.shemas.CreateIfNotExist(function(e,n){t.__info__.CreateIfNotExist(function(e,n){t.shemas.LoadTableFromDB(t._tables__,function(e){t.IsLoaded=!0,t.OnLoad.PInvok(0,[t],t)})})}),this):this},t.prototype.Push=function(t){var n=this;if(e)if(t.async){if(this.queue.push(t),this.isExecuting)return;this.queue=[],this.isExecuting=!0;var i=this.queue;this.database.transaction(function(t){for(var e=0;e<n.queue.length;e++)"string"==typeof n.queue[e].cmd?n._exeScalSQL(t,n.queue[e]):n._exeVectorSQL(t,n.queue[e]);n.isExecuting=!1},function(t){for(var e=0;e<i.length;e++){var r=i[e];"string"==typeof r.cmd?r.callback&&r.callback(!1,n,t):r.callback&&r.callback(0,!1,n,t)}})}else this.database.transaction(function(e){"string"==typeof t.cmd?n._exeScalSQL(e,t):n._exeVectorSQL(e,t)},function(e){"string"==typeof t.cmd?t.callback&&t.callback(!1,n,e):t.callback&&t.callback(0,!1,n,e)})},t.prototype.execute=function(t,e,n){this.Push({cmd:e,callback:n,async:t})},t.prototype._exeScalSQL=function(t,e){var n=this;t.executeSql(e.cmd,[],e.callback?function(t,i){e.callback(!0,n,t,i),e.callback=void 0}:void 0)},t.prototype._exeVectorSQL=function(t,e){for(var n=this,i=-1,r=e.callback?function(t,r){i++,e.callback&&e.callback(i,!0,n,t,r),i==o.length-1&&(e.callback=void 0)}:void 0,o=e.cmd,s=0;s<o.length;s++)t.executeSql(o[s],[],r)},t.prototype.executes=function(t,e,n){this.Push({async:t,cmd:e,callback:n})},t.prototype.syncExecute=function(t,n){e&&this._Push({cmd:t,callback:n})},t.prototype._Push=function(t){if(this._commands.push(t),!this._IsExecuting)return this._next()},t.prototype._runCmd=function(){this.database.transaction(this._transaction,this._OnError)},t.prototype._transaction=function(t){t.executeSql(this._current.value.cmd,[],this._OnSuccess)},t.prototype._OnSuccess=function(t,e){try{this._current.value.callback&&this._current.value.callback(!0,this,t,e)}catch(t){}this._next()},t.prototype._OnError=function(t){try{this._current.value.callback&&this._current.value.callback(!1,this,t)}catch(t){}this._next()},t.prototype._next=function(){return 0===this._commands.length?void(this._IsExecuting=!1):(this._IsExecuting=!0,this._current.value=this._commands.pop(),void o.thread.Dispatcher.Push(this._job,[this._current]))},t.prototype.CreateTable=function(t,n){if(!e)return this;var i=new u(this,t,n),r={table:i,info:this._tables__.gettableByName(t,n),_dbInfo_:this.shemas};return i.CreateIfNotExist(),this._store[t]=r,this},t.prototype.Get=function(t){return this._store[t]},t.prototype.MakeUpdate=function(t,n){if(e){null==n&&(n=0),"number"!=typeof n&&(n=n.valueOf());var i=this._store[t];i&&(i.info.LastUpdate=n,i._dbInfo_.ExecuteOperation({op:h.Update,row:i.info},function(t,e,n,i){}))}},t}();t.Database=s;var a=function(){function t(t,e){this.tableName=t,this.type=e,this._map={},this.init()}return Object.defineProperty(t.prototype,"Key",{get:function(){return this._key},enumerable:!0,configurable:!0}),t.prototype.init=function(){for(var t=n.bind.DObject.getFields(this.type),e=0;e<t.length;e++){var i=t[e];i.IsKey&&(this._key=i),this._map[i.Name]=i.Type}this.cretaeCmd=this.getCreateCmd(),this.insertCmd=this.getInsertCmd(),this.updateCmd=this.getUpdateCmd(),this.selectCmd=this.getSelectCmd(),this.deleteCmd=this.getDeleteCmd()},t.prototype.getSB=function(t){return n.basic.CompileString(t,this.getDbValue,this)},t.prototype.getCreateCmd=function(){for(var t=n.bind.DObject.getFields(this.type),e="CREATE TABLE IF NOT EXISTS ["+this.tableName+"] (",i=0;i<t.length;i++){var r=t[i],o=this.getTypeName(r.Type);void 0!=o?(0!==i&&(e+=","),e+="["+r.Name+"] "+o+((r.Attribute&n.bind.PropertyAttribute.IsKey)===n.bind.PropertyAttribute.IsKey?" PRIMARY KEY":" ")):console.error("Filed ["+r.Name+"] of table "+this.tableName+" cannot be created")}return e+=")",this.getSB(e)},t.prototype.getInsertCmd=function(){for(var t=n.bind.DObject.getFields(this.type),e="",i="",r=0;r<t.length;r++){var o=t[r];0!==r&&(e+=",",i+=","),e+="["+o.Name+"]",i+="@"+o.Name}return this.getSB("INSERT INTO ["+this.tableName+"] ("+e+") VALUES ("+i+")")},t.prototype.getUpdateCmd=function(){for(var t=n.bind.DObject.getFields(this.type),e="",i=null,r=0;r<t.length;r++){var o=t[r];0!==r&&(e+=","),!i&&o.IsKey&&(i=o),e+="["+o.Name+"] = @"+o.Name}return e="UPDATE ["+this.tableName+"] SET "+e+" WHERE ["+i.Name+"] = @"+i.Name,this.getSB(e)},t.prototype.getSelectCmd=function(){return this.getSB("SELECT * FROM ["+this.tableName+"] WHERE ["+this._key.Name+"] = @"+this._key.Name+" LIMIT 1")},t.prototype.getDeleteCmd=function(){return this.getSB("DELETE FROM ["+this.tableName+"] WHERE ["+this._key.Name+"] = @"+this._key.Name)},t.prototype.getTypeName=function(t){if(t===String)return"TEXT";if(t===Number||t===Date)return"Number";if(t===Boolean)return"Boolean";if(o.reflection.IsInstanceOf(t,i.sdata.DataRow))return"number";if(!o.reflection.IsInstanceOf(t,i.sdata.DataTable))throw console.error("Unresolved Type = "+t,t),"unresolved type"},t.prototype.getDbValue=function(t,e){if(null==e)return"null";var n=this.params,r=n._map[t];switch(r){case String:return null==e?"null":"'"+e+"'";case Number:return n.getNumber(e);case Boolean:return void 0==e?"null":e?"1":"0";case Date:return n.getNumber(e&&e.valueOf());default:if(o.reflection.IsInstanceOf(r,i.sdata.DataRow)){var s=e&&e.Id;return null==s?"null":String(s)}return}},t.prototype.getNumber=function(t){return null==t||isNaN(t)?"null":String(Math.abs(t)>Number.MAX_VALUE?Number.MAX_VALUE:t)},t.parseBool=function(t){if(null==t)return null;switch(typeof t){case"string":return"true"===t||"false"!==t&&(t=parseFloat(t),!!t);case"number":break;case"boolean":return t;default:return!!t}},t.prototype.getJsValue=function(e,n){var r=this.params,s=r._map[e];switch(s){case String:return n;case Number:return"string"==typeof n?parseFloat(n):n;case Boolean:return t.parseBool(n);case Date:return null===n?t.emptyDate:new Date("string"==typeof n?parseInt(n):n);default:if(o.reflection.IsInstanceOf(s,i.sdata.DataRow)){var a=n&&n.Id;return null==a?"null":String(a)}return}},t.prototype.getAvaibleCmd=function(t){return null==t?t="["+this._key.Name+"]":"*"==t?t="*":"string"!=typeof t&&(t=this.jointCols(t)),"SELECT "+t+" FROM ["+this.tableName+"]"},t.prototype.jointCols=function(t){return 0==t.length?"":1==t.length?"["+t[0]+"]":"["+t.join("],[")+"]"},t.emptyDate=new Date(0),t}();t.SQLInstructureBuilder=a;var u=function(){function t(t,e,i){if(this.database=t,!o.reflection.IsInstanceOf(i,n.bind.DObject))throw"Type not implimented";this.builder=new a(e,i)}return t.prototype.Insert=function(t,e){this.database.syncExecute(this.builder.insertCmd.apply(t),e)},t.prototype.Delete=function(t,e){this.database.syncExecute(this.builder.deleteCmd.apply(t),e)},t.prototype.Update=function(t,e){this.database.syncExecute(this.builder.updateCmd.apply(t),e)},t.prototype.Select=function(t,e){this.database.syncExecute(this.builder.selectCmd.apply(t),e)},t.prototype.Create=function(t){this.database.syncExecute(this.builder.cretaeCmd.apply({}),t)},t.prototype.ExecuteOperation=function(t,e){var n,i=this,r=this.getCmd(t);this.database.execute(!1,r,n=function(r,o,s,a){if(r=r&&!((t.op==h.Update||t.op==h.UpdateOnly)&&0==a.rowsAffected),!r)do{if(2==t.op)t={op:4,row:t.row};else{if(1!=t.op)break;t={op:5,row:t.row}}return i.database.execute(!1,i.getCmd(t),n)}while(!1);t&&e&&e(r,o,s,a)})},t.prototype.getAvaible=function(t,e){this.database.execute(!1,this.builder.getAvaibleCmd(t),e)},t.prototype.ExecuteOperations=function(t,e){var n=this;if(0==t.length)return e&&e(!0,0);var i,r=0,o=0;this.ExecuteOperation(t[r],i=function(s,a,u,c){return s||o++,r++,t.length==r?e&&e(0==o,o):void n.ExecuteOperation(t[r],i)})},t.prototype.ExecuteOperations1=function(e,n){t.__count;if(0==e.length)return n&&n(!0,0);for(var i=0;i<e.length;i++)e[i]=this.getCmd(e[i]);var r,o=[];this.database.executes(!1,e,r=function(t,i,r,s,a){if(i||o.push(e[t]),t==e.length-1)return n&&n(0!=o.length,o.length)})},t.prototype.UpdateTableToDB=function(t,e,n){var r=this,o=t instanceof i.sdata.DataTable?t.AsList():t,s=o.slice(0),a=s.map(function(t){return t.Id}),u=[];(n||a.length)&&this.getAvaible(["Id","LastModified"],function(t,i,c,l){if(null==l)return console.error("HardError");for(var p=l.rows,h=0;h<p.length;h++){var d=p[h],f=a.indexOf(d.Id);if(f==-1)n&&u.push({row:y,op:3});else{var y=(d.LastModified||0,o[f]);d.LastModified<y.LastModified&&u.push({row:y,op:1})}for(var v;(v=s.indexOf(y))!=-1;)s.splice(v,1)}for(var h=0;h<s.length;h++)u.push({row:s[h],op:2});r.ExecuteOperations1(u,e)})},t.prototype.LoadTableFromDB=function(t,e){var i=this,r=new n.encoding.SerializationContext(!0);this.getAvaible("*",function(n,s,a,u){if(n){var c=u.rows,l=0,p=function(){var i=l+100;for(i>c.length&&(i=c.length);l<i;l++){var s=c[l];t.Add(t.CreateNewItem(s.Id).FromJson(s,r))}i<c.length?o.thread.Dispatcher.call(this,p):e&&e(n)};o.thread.Dispatcher.call(i,p)}else e&&e(n)})},t.prototype.getCmd=function(t){switch(t.op){case 0:return null;case 1:case 4:return this.builder.updateCmd.apply(t.row);case 2:case 5:return this.builder.insertCmd.apply(t.row);case 3:return this.builder.deleteCmd.apply(t.row)}},t.prototype.MakeUpdate=function(t){this.database.MakeUpdate(this.builder.tableName,t)},t.prototype.IsExist=function(t){this.database.execute(!1,"SELECT * FROM ["+this.builder.tableName+"] limit 0",function(e,n){t&&t(e)})},t.prototype.CreateIfNotExist=function(t){var e=this;this.IsExist(function(n){return n?(e.Created=!0,t&&t(!0,e)):void e.Create(function(n,i,r){return e.Created=n,t&&t(n,e)})})},t.__count=1,t}();t.DatabaseTable=u;var c=function(t){function e(e){var i=t.call(this,n.basic.New())||this;return i.table=e,e&&(i.Type=r.context.NameOf(e.builder.type),i.TableName=e.builder.tableName),i}return __extends(e,t),e.prototype.getStore=function(){return e.store},e.__fields__=function(){return[this.DPTableName,this.DPType,this.DPLastUpdate]},e.prototype.onPropertyChanged=function(t){},e.store=new n.collection.Dictionary("_Table__"),e.DPTableName=n.bind.DObject.CreateField("TableName",String),e.DPType=n.bind.DObject.CreateField("Type",String),e.DPLastUpdate=n.bind.DObject.CreateField("LastUpdate",Number),e}(i.sdata.QShopRow);t._Table__=c;var l=function(t){function e(e){var n=t.call(this,null,c,function(t){return new c(null)})||this;return n.database=e,n}return __extends(e,t),e.prototype.gettableByName=function(t,e){for(var i=0;i<this._list.length;i++)if(this._list[i].TableName==t)return this._list[i];var o=new c(this.database.shemas);return o.Id=n.basic.New(),o.Type=r.context.NameOf(e),o.TableName=t,o.LastUpdate=1,o.LastModified=new Date(0),this.Add(o),this.database.shemas.ExecuteOperation({op:h.Insert,row:o}),o},e}(i.sdata.DataTable);t._Tables__=l;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.__fields__=function(){return[this.DPCount]},e.prototype.getStore=function(){return null},e.prototype.Update=function(){throw new Error("Method not implemented.")},e.prototype.Upload=function(){throw new Error("Method not implemented.")},e.DPCount=n.bind.DObject.CreateField("Count",Number),e}(i.sdata.DataRow);t.__ExeInfo__=p;var h;(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.c=function(){},e})(i.sdata.DataTable);(function(t){t[t.None=0]="None",t[t.Update=1]="Update",t[t.Insert=2]="Insert",t[t.Delete=3]="Delete",t[t.UpdateOnly=4]="UpdateOnly",t[t.InsertOnly=5]="InsertOnly"})(h=t.Operation||(t.Operation={}))})(s=e.db||(e.db={}))}),define("sys/Encoding",["require","exports","sys/Corelib"],function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i;(function(t){function e(){}t.init=e,n.encoding.SerializationContext.GlobalContext.Register(Number,{FromJson:function(t){if(null==t)return 0;if("number"==typeof t)return t;if("string"==typeof t)return parseInt(t);throw"basic.Guid.FromNumber(parseInt(a));"},ToJson:function(t){return null==t?0:t.toString()}}),n.encoding.SerializationContext.GlobalContext.Register(Date,{FromJson:function(t){return null==t?null:"number"==typeof t?new Date(t):"string"==typeof t?new Date(t):void 0},ToJson:function(t){return t.toJSON()}})})(i=e.__encoddings__||(e.__encoddings__={}))}),define("sys/Jobs",["require","exports","sys/Corelib","sys/UI","context"],function(t,e,n,i,r){"use strict";function o(t){return t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement}function s(t){var e=t.getAttribute("target");if(null!=e){var n=e.split("/");if(n.length>2)throw"Error";if(n.length>1){e=n[1];var i=parseInt(n[0])+1}else i=1;return{depth:i,href:e}}}function a(t,e,n){for(var i=t,r=0;r<e;r++)i=i.parentElement;if(!n||""==n)return i;var o=$(n,i);return o&&(o instanceof Array?0!=o.length&&(i=o[0]):i=o),i}function u(t){var e=s(t);return e?a(t,e.depth,e.href):t}Object.defineProperty(e,"__esModule",{value:!0}),e.parseTarget=s,e.getTarget=a,e.getTargetFrom=u;var c;(function(t){function e(){}function s(){}function a(t){return(t-621355968e9)/1e4}function u(t){var e=t.dom.getAttribute("target");if(!e)return t.dom;for(var n=e.split("/"),i=parseInt(n[0])||0,r=n[1],o=t.dom;0!=i;)i--,o=o.parentElement||o;if(r){var s=$(r,o);s&&(s instanceof Array?0!=s.length&&(o=s[0]):o=s)}return o||t.dom}t.InputChecks=e,t.Load=s;var c;(function(t){function e(t,e,n){Object.defineProperty(p,t,{value:e,configurable:!n,writable:!n,enumerable:!1})}function n(){var e=/(0{1}[5|7|6|9]{1}\d{8})/,n=/(0{1}[2|3]{1}\d{7})/,i=/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,r=/^[a-z|A-Z\s]*$/,o=/^([a-zA-Z\@][a-zA-Z\d\@\._]{5,20})$/,s=/[\w\s\.\d\/\*\ \+\-\%\=]*/;p.readonly=function(){return!1},p.alphanumeric=function(t){return!!t.match(/^[a-zA-Z0-9]*$/)},p.ip=function(t){return!!t.match(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)},p.numeric=function(t){return!!t.match(/^-?[0-9]+$/)},p.int=function(t){return!!t.match(/^(?:-?(?:0|[1-9][0-9]*))$/)},p.decimal=function(t){return!!t.match(/^(?:-?(?:0|[1-9][0-9]*))?(?:\.[0-9]*)?$/)},p.text=function(){return!0},p.password=function(t){return!!t.match(/^[a-zA-Z0-9\s\.\@\!\?]+$/)},p.any=function(){return!0},p.ref=function(t){return!!t.match(/^[A-Z]{2}[0-9]{1,5}$/)},p.creditcard=function(t){if(t=t.replace(/[^0-9]+/g,""),!t.match(/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/))return!1;for(var e,n,i=0,r=!1,o=t.length-1;o>=0;o--)e=t.substring(o,o+1),n=parseInt(e,10),r?(n*=2,i+=n>=10?n%10+1:n):i+=n,r=!r;return i%10===0},p.tel=function(t){return t=t.trim(),n.test(t)&&9===t.length||e.test(t)&&10===t.length},p.mail=function(t){var e=i.exec(t);return null!==e&&e[0].length===t.length},p.name=function(t){var e=r.exec(t);return null!==e&&e[0].length===t.length},p.username=function(t){var e=o.exec(t);return null!==e&&e[0].length===t.length},p.dimention=function(t){var e=s.exec(t);return null!==e&&e[0].length===t.length},p.select=function(t){var e=o.exec(t);return null!==e&&e[0].length===t.length},Object.freeze(t),Object.freeze(e),Object.freeze(n)}function i(t){if(!t.Ischanging){t.Ischanging=!0;try{t.dom.value=t.Scop.Value||""}catch(t){}t.Ischanging=!1}}function r(){return!0}function s(){}function a(t,e){var n=t.dom.getAttribute("db-check");"readonly"===n&&(t.dom.contentEditable="false"),t.Checker=p[n],t.Handle=this.handleEvent,this.Todo(t,e),t.addEventListener("ochange",o(t.dom)?"change":"textContentChanged",t)}function u(t){if(!t.Ischanging){t.Ischanging=!0;try{var e=t.dom.value;t.Checker?t.Checker(e)?t.Scop.Value=e:t.dom.value=t.Scop.Value:t.Scop.Value=e}catch(t){}t.Ischanging=!1}}function c(t){t.removeEventListener("ochange")}function l(){return{Name:h,Todo:i,OnInitialize:a,Check:r,OnScopDisposing:c,OnError:s,handleEvent:u}}t.Register=e;var p={},h="input";t.init=n,t.Instance=l,n()})(c||(c={}));var l=new n.basic.CodeCompiler,p=function(){function t(){this.Name="$"}return t.prototype.Todo=function(t,e){for(var n=t.getValue("regs"),i=t.Scop,r=t.Scop.Value,o=[r,i,void 0,t,void 0],s=0;s<n.length;s++){var a=n[s];o[2]=a.stat||t.dom,o[4]=a.evalCode,o[2].textContent=a.evalCode.apply(i,o)}},t.prototype.OnError=function(t,e){},t.prototype.OnInitialize=function(t,e){var i=this,r=t.dom.firstChild,o=[];t.addValue("regs",o);do if(r instanceof Text){var s=l.push(r.textContent);s.IsString?l.remove(s):(s.stat=r,o.push(s),n.bind.Observer)}while(r=r.nextSibling);l.onload=function(n){n.reset(),i.Todo(t,e)},l.Compile()},t.prototype.OnScopDisposing=function(t,e){var n=t.getValue("regs");n.length=0},t}();t.interpolation=p,n.bind.Register(new p);var h=function(){function t(){this.Name="checkbox"}return t.prototype.Todo=function(t,e){t.dom.checked=t.Scop.Value},t.prototype.OnError=function(t,e){},t.prototype.OnInitialize=function(t,e){this.Todo(t,e),t.addEventListener("change","change",t),t.Handle=this.Handle},t.prototype.OnScopDisposing=function(t,e){},t.prototype.Handle=function(t){var e=t.dom.checked;t.Scop.Value=null==e?null:!!e},t}();t.CheckBox=h,n.bind.Register(new h);var d=function(){function t(){this.Name="number",this.reg=function(t){return!!t.match(/^[+-]?\d+(?:\.\d+)?$/)}}return t.prototype.Todo=function(t,e){if(!t.Ischanging){t.Ischanging=!0;try{var n=t.Scop.Value;n=null==n?t._store.def:n,t.dom instanceof HTMLInputElement?t.dom.value=n:t.dom.textContent=n}catch(t){}t.Ischanging=!1}},t.prototype.OnInitialize=function(t,e){var n=this,i=t.dom,r=i.getAttribute("db-check");t.addValue("max",parseFloat(i.getAttribute("max")||"9999999999")),t.addValue("min",parseFloat(i.getAttribute("min")||"-9999999999")),t.addValue("def",parseFloat(i.getAttribute("default")||"0.00")),"readonly"===r?i.contentEditable="false":(t.Handle=this.handleEvent,t.addEventListener("ochange",o(i)?"change":"textContentChanged",function(e){n.handleEvent(t)})),this.Todo(t,e)},t.prototype.handleEvent=function(t){if(!t.Ischanging){t.Ischanging=!0;try{var e=t.dom,n=e.value;if(this.reg(n)){var i=Math.round(1e3*parseFloat(n))/1e3,r=Math.max(t.getValue("min"),Math.min(i,t.getValue("max")));t.Scop.Value=r,i!=r&&(e.value=r.toString())}else e.value=String(Math.round(1e3*(t.Scop.Value||0))/1e3)}catch(t){}t.Ischanging=!1}},t.prototype.OnScopDisposing=function(t,e){t.removeEventListener("ochange")},t}();t.FloatJob=d;var f=function(){function t(){this.Name="select"}return t.prototype.Todo=function(t,e){var n=t.getValue("db-const"),i=t.getValue("db-style"),r=t.Scop.Value;try{var o=t.dom;n===r?o.classList.add(i):o.classList.remove(i)}catch(t){}},t.prototype.OnError=function(t,e){},t.prototype.OnInitialize=function(t,e){var n=t.dom,i=this.callback.bind(t);t.addValue("__",i),t.addValue("db-const",n.getAttribute("db-const")),t.addValue("db-style",n.getAttribute("db-style")),this.Todo(t,e),n.addEventListener("click",i)},t.prototype.callback=function(){var t=this;try{var e=t.getValue("db-const");t.Scop.Value=e}catch(t){}},t.prototype.OnScopDisposing=function(t,e){},t}();t.AccordionSelectJob=f,t.LabelJob=n.bind.Register({Name:"readonly",Todo:function(t){for(var e=t.getValue("target"),n=!t.Scop.Value,i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT);i.nextNode();){var r=i.currentNode;"boolean"==typeof r.readOnly&&(r.readOnly=n)}},OnInitialize:function(t,e){t.addValue("target",u(t)),this.Todo(t,e)}}),t.LabelJob=n.bind.Register({Name:"toggleText",Todo:function(t){var e=t.getValue("data"),n=t.Scop.Value;t.dom.textContent=e[n]},OnInitialize:function(t,e){var n=t.dom.attributes.getNamedItem("data");if(n)try{t.addValue("data",JSON.parse(n.value))}catch(e){t.addValue("data",{})}else t.addValue("data",{});this.Todo(t,e)}}),t.LabelJob=n.bind.Register(new n.bind.Job("label",function(t){var e=t.dom;e.textContent=t.Scop.Value||""},null,null,function(t){var e=t.dom;e.textContent=t.Scop.Value||""},function(){})),t.LabelJob=n.bind.Register({Name:"html",Todo:function(t){var e=t.dom;e.innerHTML=t.Scop.Value||""},OnInitialize:function(t,e){this.Todo(t,e)}});n.bind.Register({Name:"cdate",OnInitialize:function(t,e){this.Todo(t,e)},Todo:function(t){var e=t.dom,n=t.Scop.Value,i=new Date(a(n));e instanceof HTMLInputElement?t.dom.valueAsDate=i:t.dom.textContent=i.toLocaleString()}});var y={true:3,2:2,3:3};t.LabelJob=n.bind.Register({Name:"date",OnInitialize:function(t,e){var n=t.dom,i=y[n.getAttribute("db-twoway")];t._store.tw=i=void 0===i?1:parseInt(i),2==(2&i)&&t.addEventListener("change",o(n)?"change":"textContentChanged",{handleEvent:function(){var e=t.dom;this.self.Scop.Value=e instanceof HTMLInputElement?e.valueAsDate:new Date(e.textContent)},self:t}),this.Todo(t,e)},Todo:function(t){navigator.hardwareConcurrency;var e=t._store.tw;if(1===(1&e)){var n=t.dom,i=t.Scop.Value,r=null==i?new Date(0):i instanceof Date?i:"number"==typeof i?new Date(i):"string"==typeof i?Date.parse(i):new Date(0);n instanceof HTMLInputElement?t.dom.valueAsDate=r:t.dom.textContent=r.toLocaleString()}}}),t.LabelJob=n.bind.Register(new n.bind.Job("rinput",function(t){t.dom.value=t.Scop.Value},null,null,function(t){t.dom.value=t.Scop.Value},function(){})),t.textboxJob=n.bind.Register(new n.bind.Job("textbox",function(t){var e=t.dom;e.innerText=t.Scop.Value},null,null,function(t){var e=t.dom;e.innerText=t.Scop.Value},function(){})),t.LabelJob=n.bind.Register(new n.bind.Job("price",function(t){var e=t.dom;e.innerText=n.math.round(t.Scop.Value||0,2)+" DZD"},null,null,function(t){var e=t.dom;e.innerText=n.math.round(t.Scop.Value||0,2)+" DZD"},function(){})),t.ratingJob=n.bind.Register(new n.bind.Job("rateing",function(t){for(var e=t.dom,n=Math.round(t.Scop.Value||0),i=e.childElementCount,r=0;r<n;r++)e.children[r].style.visibility="visible";for(var r=n;r<i;r++)e.children[r].style.visibility="hidden"},null,null,function(e,n){t.ratingJob.Todo(e,n)})),t.LabelJob=n.bind.Register({Name:"enable",Todo:function(t){t.dom.style.pointerEvents=t.Scop.Value?"all":"none"},OnInitialize:function(t,e){this.Todo(t,e)}}),t.LabelJob=n.bind.Register({Name:"applyStyle",Todo:function(t){var e=t.getValue("target"),n=t.getValue("data")||v,i=this.getType(t),r=t.Scop.Value;i&&(r=r instanceof i),e.classList.add.apply(e.classList,r?n[1]:n[0]),e.classList.remove.apply(e.classList,r?n[0]:n[1])},OnInitialize:function(t,e){var n=t.dom,i=n.getAttribute("db-data");i&&(i=i.split(","),1==i.length?i=[i[0].split(" "),"none"]:(i[0]=i[0].split(" "),i[1]=i[1].split(" ")),t.addValue("data",i));var r=n.getAttribute("ofType");r&&t.addValue("ofType",r),t.addValue("target",u(t)),this.Todo(t,e)},getType:function(t){var e=t.getValue("ofType");return"string"==typeof e&&(e=r.context.GetType(e),e instanceof Function&&t.addValue("ofType",e)),e},getTarget:function(t){var e=t.dom.getAttribute("target");if(e){for(var n=e.split("/"),i=parseInt(n[0])||0,r=n[1],o=t.dom;0!=i;)i--,o=o.parentElement||o;if(r){var s=$(r,o);s&&(s instanceof Array?0!=s.length&&(o=s[0]):o=s)}t.addValue("target",o||t.dom.parentElement||t.dom)}}}),t.LabelJob=n.bind.Register({Name:"show",Todo:function(t){var e=t.getValue("target"),n=t.getValue("data")||v,i=this.getType(t),r=t.Scop.Value;i&&(r=r instanceof i),e.style.display=r?n[1]:n[0]},OnInitialize:function(t,e){var n=t.dom,i=n.getAttribute("db-data");i&&(i=i.split(","),1==i.length&&(i=[i[0],"none"]),t.addValue("data",i));var r=n.getAttribute("ofType");r&&t.addValue("ofType",r),t.addValue("target",u(t)),this.Todo(t,e)},getType:function(t){var e=t.getValue("ofType");return"string"==typeof e&&(e=r.context.GetType(e),e instanceof Function&&t.addValue("ofType",e)),e}}),t.LabelJob=n.bind.Register({Name:"editable",Todo:function(t){for(var e=!t.Scop.Value,n=$("input",t.dom),i=0;i<n.length;i++){var r=n[i];r.disabled=e}},OnInitialize:function(t){this.Todo(t)},OnScopDisposing:function(){}});var v=["none",""];t.LabelJob=n.bind.Register({Name:"toggle",Todo:function(){},OnInitialize:function(t){t.addEventListener("domclick","click",function(){t.Scop.Value=!t.Scop.Value})},OnScopDisposing:function(t){t.removeEventListener("domclick")}}),t.LabelJob=n.bind.Register(new n.bind.Job("showIf",function(t){var e=t.dom,n=e.parentElement,i=n.style.display,r=t.Scop.Value;if(r===!1){if("none"==i)return;t.addValue("display",i),n.style.display="none"}else n.style.display="none"==i?t.getValue("display"):i},null,null,function(t){var e=t.dom,n=e.parentElement,i=n.style.display,r=t.Scop.Value;if(r===!1){if("none"==i)return;t.addValue("display",i),n.style.display="none"}else n.style.display="none"==i?t.getValue("display"):i},function(){})),t.LabelJob=n.bind.Register(new n.bind.Job("hideIf",function(t){var e=t.dom,n=e.parentElement,i=n.style.display,r=t.Scop.Value;if(r===!0){if("none"==i)return;t.addValue("display",i),n.style.display="none"}else n.style.display="none"==i?t.getValue("display"):i},null,null,function(t){var e=t.dom,n=e.parentElement,i=n.style.display,r=t.Scop.Value;if(r===!0){if("none"==i)return;t.addValue("display",i),n.style.display="none"}else n.style.display="none"==i?t.getValue("display"):i},function(){})),t.TextJob=n.bind.Register(c.Instance()),t.TextJob=n.bind.Register(new d),t.TextJob=n.bind.Register(new f),t.CheckJob=n.bind.Register(new n.bind.Job("check",function(t){var e=t.dom;e.innerText=t.Scop.Value},null,null,function(t){var e=t.dom;e.innerText=t.Scop.Value},function(){})),n.bind.Register({Name:"enumoption",OnInitialize:function(t,e){if(!(t.dom instanceof HTMLInputElement))throw"Dom must be Select";var r=t.dom,o=r.getAttribute("enum"),s=r.getAttribute("enum-type");"string"!==s&&(s="number");var a=n.basic.getEnum(o),u=new i.UI.ProxyAutoCompleteBox(new i.UI.Input(t.dom),a);u.Box.Parent=i.UI.Desktop.Current,u.initialize();var c={ac:u,lst:a,et:s};t.addValue("params",c),this.Todo(t,e),u.OnValueChanged(u,function(e,n,i){return t.Scop.Value="string"===s?i?i.Name:a.Get(0):i?i.Value:0})},Todo:function(t){var e=t.getValue("params"),i=t.Scop.Value;e.ac.Value="number"===e.et?n.basic.EnumValue.GetValue(e.lst,i||0):i}}),n.bind.Register({Name:"enum",OnInitialize:function(t,e){if(!(t.dom instanceof HTMLSelectElement))throw"Dom must be Select";var i=t.dom;i.contentEditable="true";for(var r=i.getAttribute("enum")||i.getAttribute("type")||i.getAttribute("rtype"),o=n.basic.getEnum(r),s=0;s<o.Count;s++){var a=document.createElement("option"),u=o.Get(s);a.value=String(u.Value),a.text=u.Name,t.dom.appendChild(a)}t.addValue("list",o),this.Todo(t,e),t.dom.addEventListener("change",function(){if(!t._store.inter){t._store.inter=!0;try{var e=this.options[this.selectedIndex];e=parseFloat(e&&e.value),t.Scop.Value=isFinite(e)?e:null}catch(t){}t._store.inter=!1}})},Todo:function(t){if(!t._store.inter){t._store.inter=!0;try{var e=t.getValue("list"),i=n.basic.EnumValue.GetValue(e,t.Scop.Value);i=i&&e.IndexOf(i),t.dom.selectedIndex=i}catch(t){}t._store.inter=!1}}}),n.bind.Register({Name:"enumstring",OnInitialize:function(t,e){var i=t.dom,r=i.getAttribute("type"),o=n.basic.getEnum(r);t.addValue("params",o),this.Todo(t,e)},Todo:function(t){var e=t.getValue("params"),n=t.Scop.Value;t.dom.textContent="string"==typeof n?n:e.Get(n||0).Name}}),n.bind.Register({Name:"enum2string",OnInitialize:function(t,e){var i=t.dom,r=i.getAttribute("type"),o=n.basic.getEnum(r);t.addValue("params",o),this.Todo(t,e)},Todo:function(t){var e=t.getValue("params"),n=t.Scop.Value;t.dom.textContent="string"==typeof n?n:e.Get(n||0).Name}});var g;n.bind.Register({Name:"tostring",OnInitialize:g=function(t){var e=t.Scop.Value||"";"string"!=typeof e&&(e=e&&e.toString()||""),e.length>45&&(e=e.substring(0,45)+"..."),t.dom.textContent=e},Todo:g})})(c=e.Jobs||(e.Jobs={}))}),define("sys/Thread",["require","exports"],function(t,e){"use strict";if(Object.defineProperty(e,"__esModule",{value:!0}),"undefined"==typeof e)var e={};var n="function"==typeof importScripts&&!("undefined"!=typeof window&&window instanceof Window);"undefined"==typeof e&&"undefined"!=typeof window&&(window.exports={});var i;(function(t){function e(t){if(!t)return t;if("object"==typeof t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}return t instanceof Array?t.splice(0):t}var i;(function(e){function i(t,e){return!!t&&((0!==t.indexOf("__")||t.lastIndexOf("__")!==t.length-2)&&(!!e&&(u[t]=e,!0)))}function r(t){return(0!==t.indexOf("__")||t.lastIndexOf("__")!==t.length-2)&&u[t]}function o(t){return!!t&&((0!==t.indexOf("__")||t.lastIndexOf("__")!==t.length-2)&&delete u[t])}function s(t,e,n,i){try{return t&&t.apply(i,n)}catch(t){return(n=n.slice()).unshift(t),e&&e.apply(i,n)}}function a(){t.WebWorker.registerHandler("fetch",function(t){var e=t.Msg.Data;t.keepAlive=!0,t.Handled=!0;var n=t.e.ports&&t.e.ports.slice(),i=t.e.origin;fetch(new Request(e.request.request)).then(function(e){return 200==e.status&&"ok"===e.statusText?e.text().then(function(e){t.Thread.postMessage({Data:e,Id:t.Msg.Id,IsError:!1,keepAlive:!1},i,n,n)},function(e){t.Thread.postMessage({Data:e,Id:t.Msg.Id,IsError:!0,keepAlive:!1},i,n,n)}):void t.Thread.postMessage({Data:void 0,Id:t.Msg.Id,IsError:!0,keepAlive:!1},i,n,n)})})}var u={};e.registerHandler=i,e.getHandler=r,e.unregisterHandler=o;var c=function(){function t(){this.onPostMessageError=function(t,e){this.postMessage({Id:e.Id,IsError:!0,Data:"UnExpectedError",keepAlive:!1})}.bind(this),this.Start()}return t.prototype.Start=function(){this._worker=self,this._worker.addEventListener("error",this._onerror.bind(this),{capture:!0}),this._worker.addEventListener("message",this._onmessage.bind(this),{capture:!0})},t.prototype._onerror=function(t){},t.prototype._onmessage=function(t){var e=t.data,n=u[e.Handler],i={
e:t,Msg:e,Result:void 0,Handled:!1,Thread:this},r=s(n,this._onHandlerError,[i],this);i.Handled||this.postMessage({Id:e.Id,Data:i.Result||r,keepAlive:i.keepAlive},t.origin,t.ports,t.ports.slice())},t.prototype._onHandlerError=function(t,e){e.Error=!0,e.Handled=!0,this.postMessage({Id:e.Msg.Id,IsError:!0,Data:t,keepAlive:!1})},t.prototype.postMessage=function(t,e,i,r){if(r&&0!=r.length){a=[t];for(var o=0;o<r.length;o++)s(r[o].postMessage,this.onPostMessageError,a,r[o])}else{var a=n?[t,i]:[t,e?e:void 0,i];s(this._worker.postMessage,this.onPostMessageError,a,this._worker)}},t.Start=function(){this.Default=new t},t}();e.Server=c;var l=function(){function t(t){this._url=t,this._quee={},this.Start()}return t.prototype.Start=function(){this._worker=new Worker(this._url),this._worker.addEventListener("error",this._onerror.bind(this),{capture:!0}),this._worker.addEventListener("message",this._onmessage.bind(this),{capture:!0})},t.prototype.Send=function(t){var e=performance.now();t.Id=e,this._quee[e]=t,this._worker.postMessage({Id:e,Data:t.data,Handler:t.handler})},t.prototype._onmessage=function(t){var e=t.data,n=this._quee[e.Id];n&&(s(n.callback,void 0,[n,e],n),e.keepAlive||delete this._quee[e.Id])},t.prototype._onerror=function(t){},t.counter=0,t}();e.Client=l,function(){function t(t,e){u[t]=e}t("getValue",function(t){return self[t.Msg.Data]}),t("__close__",function(t){return n&&self.close(),n}),t("__loadScripts__",function(t){importScripts(t.Msg.Data)}),t("__hasHandler__",function(t){return u[t.Msg.Handler]instanceof Function}),t("__href__",function(t){return location.href}),t("__getHandlers__",function(t){return Object.keys(u)}),a()}()})(i=t.WebWorker||(t.WebWorker={}));var r=function(){function t(){}return t.Start=function(t,n){return navigator.serviceWorker.register(t,n?{scope:n}:void 0).then(function(t){o=e(o),console.log("SW registration succeeded. Scope is "+t.scope)}).catch(function(t){console.error("SW registration failed with error "+t)})},t.postMessageToSW=function(t){return new Promise(function(e,n){navigator.serviceWorker.getRegistration().then(function(i){var r=new MessageChannel;i.active.postMessage(t,[r.port2]),r.port1.onmessage=function(i){var r=i.data;(r.IsError?n:e)(r.IsError?{IsError:!0,Action:t,Result:r}:{Action:t,Result:r})}}).catch(function(e){n({IsError:!0,Action:t,Result:e})})})},t}();t.ServiceWorker=r;var o;"undefined"!=typeof window&&(window.SW=r)})(i=e.Workers||(e.Workers={}))}),define("sys/Initializer",["require","exports","sys/Corelib","sys/UI","sys/runtime","sys/Dom"],function(t,e,n,i,r,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s;(function(t){var e=function(){function t(){}return Object.defineProperty(t,"default",{get:function(){return this._default||(this._default=new t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"ON:"},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"attribute",{get:function(){return"ON:"},set:function(t){},enumerable:!0,configurable:!0}),t.prototype.check=function(t,e){return!0},t.prototype.execute=function(t,e){var n=e.value,r=new i(t);for(var o in n)r.Register(t.Control,o,n[o]);return t},t.prototype.valueParser=function(t){},Object.defineProperty(t.prototype,"priority",{get:function(){return 9007199254740900},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPrimitive",{get:function(){return!0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFinalizer",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),t}();t.NotifyDef=e;var i=function(){function t(t){this.xx=t}return t.prototype.Register=function(t,e,n){this.events||(this.events={});var i={interpolation:n};t.watch(e,this.handleEvent,this),this.events[e]=i},t.prototype.generateScop=function(t){if(void 0!==t.scop)return t.scop;if(0==t.interpolation.indexOf("."))var e=this.xx.parent&&this.xx.parent.Scop||this.xx.Scop,i=i.substring(1);else var e=this.xx.Scop;return t.scop=n.bind.Scop.Create(t.interpolation,e,0,this.xx.controller),t.scop||(t.scop=null),t.scop},t.prototype.handleEvent=function(t){var e=this.generateScop(this.events[t.name]),i=e&&e.Value;if(e instanceof n.bind.FunctionCallScop)return e.Invoke();if("function"==typeof i){var r=e.ParentValue;i.call(r,t)}else i instanceof Object&&i.handleEvent&&i.handleEvent(t)},t}();t.watchifyCache=i})(s||(s={}));var a;(function(t){function e(t,e){}function a(t){this._old.length&&this.view.classList.remove.apply(this.view.classList,this._old);var e=0;if(t){for(var n=0,i=t.split(" ");n<i.length;n++){var r=i[n];""!=r&&(this._old[e++]=r)}this._old.length=e,this.view.classList.add.apply(this.view.classList,this._old)}else this._old.length=0}function u(t,e){this._reset(e._new)}function c(t,e){var i=n.bind.StringScop.GetStringScop(e.value,t.Scop,t.controller),r={_old:new Array(0),view:t.e.dom,reset:u,_reset:a};return"string"!=typeof i&&(i.OnPropertyChanged(n.bind.Scop.DPValue,r.reset,r),i=i.Value),r._reset(i),t}function l(t){for(var e=this.view.style,n=0,i=this._old;n<i.length;n++){var r=i[n],o=e[r.name];o==r.value&&(e[r.name]=r.oldValue)}for(var s=t.split(";"),a=0,u=0,c=s;u<c.length;u++){var l=c[u];if(l=l.trim()){var p=l.split(":"),h=p[0],d={name:h,oldValue:e[h]};this._old[a++]=d,e[h]=p[1],d.value=e[h]}}this._old.length=a}function p(t,e){this._reset(e._new)}function h(t,e){var i=n.bind.StringScop.GetStringScop(e.value,t.Scop,t.controller),r={_old:[],view:t.e.dom,reset:p,_reset:l};return"string"!=typeof i&&(i.OnPropertyChanged(n.bind.Scop.DPValue,r.reset,r),i=i.Value),r._reset(i),t}function d(t,e){return"true"==e.value?e.value=n.bind.BindingMode.TwoWay:"false"==e.value?e.value=n.bind.BindingMode.SourceToTarget:e.value=isNaN(Number(e.value))?n.bind.BindingMode[e.value]||n.bind.BindingMode.SourceToTarget:Number(e.value),!0}function f(t,e){var i,r=t.e.dom,o=t.parent.Scop,s=t.Scop,a=t.e.Jobs,u=e.value,c=u.split("->"),l=c[0]||"",p=c[1]||"";if(0!==p.length&&("#"===p[0]&&(i=!0,p=p.substr(1)),0!==p.length)){if("."==l[0]?(o=s||o,l=l.substr(1)):null==o&&(o=s),l.length>0&&(s=n.bind.Scop.Create(l,o,u.indexOf("<->")!==-1?n.bind.BindingMode.TwoWay:u.indexOf("->")?n.bind.BindingMode.SourceToTarget:n.bind.BindingMode.TargetToSource)),i)return n.ScopicCommand.Call(p,r,s);var h="."==p?s.GetJob(p.substring(1)):n.bind.GetJob(p),d=s.AddJob(h,r);a.push(d)}}function y(t,e){for(var i=t.Scop,r=t.controller,o=""+e.value,s=3;s>0;s--)if(o.indexOf(A[s])!=-1){var a=s;break}if(a){var u=o.split(A[a]),c=n.bind.Scop.GenerateScop(u[0],i,3,r),l=n.bind.Scop.GenerateScop(u[1],i,3,r);if(c&&l){var p=new n.bind.TwoBind(a,c,l,n.bind.Scop.DPValue,n.bind.Scop.DPValue);r.OnDisposing=function(t){p.Dispose()}}}}function v(t,e){(t.parent.Scop||t.Scop)&&(t.parent.Scop||t.Scop).setAttribute(e.value,void 0)}function g(t,e){var n=function(t,e){if(!t)throw"template args not setted";var n=r.mvc.MvcDescriptor.Get(t);return e=n.Create()},i=t.e.dom,s=n(e.value,i);if(i!=s){for(var a=0;a<i.attributes.length;a++){var u=i.attributes.item(a);"compiled"!==u.name&&0!==u.name.indexOf("db-")&&s.setAttribute(u.name,u.value)}i.parentNode.replaceChild(s,i),i=s}var c=o.Processor.Compile(t.New(i));return c||t}function b(t,e){var i=e.manager.getProcessorByAttribute("db-twoway");t.e.Scop=e.value?n.bind.Scop.Create(e.value,t.parent.Scop,i&&i.value,t.controller)||t.parent.Scop:t.parent.Scop,t.e.IsNew=t.e.Scop!=t.parent.Scop,t.e.Scop||(t.e.Scop=t.parent.Scop||t.controller.Scop)}function m(t,e){var i=n.bind.StringScop.GetStringScop(t.Dom.textContent,t.Scop,t.controller);if("string"!=typeof i)return i.AttacheTo(t.Dom),t.e.Scop=i,t.e.IsNew=!0,t.e.Scop||(t.e.Scop=t.parent.Scop||t.controller.Scop),t}function _(t,e){for(var n in e.value)t.Scop.setAttribute(n,e.value[n]);return t}function C(t,e){var i=e.manager.getProcessorByAttribute("db-twoway");return t.e.Scop=n.bind.CreateFilter(e.value,t.Scop,i&&i.value||3),t}function w(t,e){for(var n=t.e,r=t.parent.Control,o=e.value.split("|"),s=0,a=o.length;s<a;s++){var u=t.controller.createJobInstance(o[s],t);u.Control instanceof i.UI.JControl&&(u.Control.Parent=u.Control.Parent||t.Control||r),n.Control||(n.Control=u.Control)}return t}function S(t){for(var e,n=t.firstChild;n;){if(n instanceof Element)return n;!e&&n instanceof Node&&(e=n),n=n.nextSibling}return e}function O(t,e){var i=t.parent.Scop,r=t.parent.Control,o=t.controller,s=t.e,a=S(s.dom);s.dom.removeAttribute("db-control");var u=n.ScopicControl.create({name:e.value,dom:a,currentScop:t.Scop||i,parentScop:i,parentControl:r,controller:o,e:s});s.Control=u,u.Parent=r;var c=s.dom.parentNode||s.dom.parentElement;c&&a!==s.dom&&(c.replaceChild(a,s.dom),s.dom=a)}function x(t,e){var i=t.parent.Scop,r=t.parent.Control,o=t.controller,s=t.e,a=e.manager.getProcessorByAttribute("db-twoway"),u=t.Scop||i;e.value&&(u=n.bind.Scop.Create(e.value,u,a&&a.value,o));var c=n.ScopicControl.create({name:"foreach",dom:s.dom,currentScop:u,parentScop:i,parentControl:r,controller:o,e:s});s.Control=c,c.Parent=r;s.dom.parentNode||s.dom.parentElement}function P(t,e,n){for(var i=e;i;){try{if(i.setName){if(0==i.setName(t,n.dom,e,n))continue;return!0}}catch(t){}i=i.Parent}}function I(t,e){var n=e.value,i=t.parent&&t.parent.Control||t.controller.CurrentControl,r=t.e;r.Control?P(n,i,r):P(n,t.Control,r)||P(n,i,r)}function D(t,e){var i=t.parent.Scop,r=t.e,o=t.controller,s=n.bind.Scop.Create(e.value,i,0,o);s&&t.Scop.AddJob({scopFunction:s,Todo:n.bind.Todo.prototype.Todo},r.dom)}function T(t,e){for(var i=0,r=e.value.split("|");i<r.length;i++){var o=r[i];n.ScopicCommand.Call(o,t.e.dom,t.Scop)}}function k(){}var A;(function(t){t[t["<->"]=3]="<->",t[t["->"]=1]="->",t[t["<-"]=2]="<-"})(A||(A={})),o.Processor.Register({name:"twoway",attribute:"db-twoway",execute:e,check:d,isPrimitive:!0}),o.Processor.Register({name:"bind",attribute:"db-bind",execute:b,isPrimitive:!0}),o.Processor.Register({name:"filter",attribute:"db-filter",execute:C,isPrimitive:!0}),o.Processor.Register({name:"init",attribute:"db-init",execute:_,isPrimitive:!0}),o.Processor.Register({name:"dec",attribute:"db-dec",execute:v,isPrimitive:!0}),o.Processor.Register({name:"set",attribute:"db-set",execute:y,isPrimitive:!0}),o.Processor.Register({name:"class",attribute:"db-class",execute:c,isPrimitive:!0}),o.Processor.Register({name:"style",attribute:"db-style",execute:h,isPrimitive:!0}),o.Processor.Register({name:"template",attribute:"db-template",execute:g,isPrimitive:!0}),o.Processor.Register({name:"str",attribute:"db-str",execute:m,isPrimitive:!0}),o.Processor.Register({name:"foreach",attribute:"db-foreach",execute:x,isPrimitive:!0}),o.Processor.Register({name:"control",attribute:"db-control",execute:O,isPrimitive:!0}),o.Processor.Register(s.NotifyDef.default),o.Processor.Register({name:"cmd",attribute:"db-cmd",execute:T,isFinalizer:!0}),o.Processor.Register({name:"job",attribute:"db-job",execute:w,isFinalizer:!0}),o.Processor.Register({name:"exec",attribute:"db-exec",execute:f,isFinalizer:!0}),o.Processor.Register({name:"todo",attribute:"db-todo",execute:D,isFinalizer:!0}),o.Processor.Register({name:"prop",attribute:"db-prop",execute:I,isFinalizer:!0,priority:9007199254740991}),o.Processor.Register({name:"name",attribute:"db-name",execute:I,isFinalizer:!0,priority:Number.MAX_VALUE}),t.load=k})(a=e.bom||(e.bom={}))}),define("sys/Services",["require","exports","sys/Corelib","sys/System","sys/UI","sys/QModel"],function(t,e,n,i,r,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s;(function(t){function e(t){s=t,i.Controller.Register(new a),i.Controller.Register(new u),i.Controller.Register(new c),i.Controller.Register(new l),i.Controller.Register(new p),i.Controller.Register({Name:"guid",OnResponse:function(t,e,i){var r=i.sdata;if("number"==typeof r)n.basic.setGuidRange(r,r+2e3-1);else{if(!(r instanceof Array))throw"Invalide Exception";n.basic.setGuidRange(r[0],r[1])}}})}var s,a=function(){function t(){this.Name="alert"}return t.prototype.OnResponse=function(t,e,n){r.UI.Modal.ShowDialog(n.sdata.Title,n.sdata.Content,null,"OK",null)},t}(),u=function(){function t(){this.Name="confirm"}return t.prototype.OnResponse=function(t,e,i){var s=this,a=new n.encoding.SerializationContext(!0),u=a.FromJson(i.sdata,o.models.Message,null);switch(a.Dispose(),u.Type){case 0:case 1:return void(t.callBack&&t.callBack(t,i,void 0));case 2:case 3:u.Callback={ProxyCallback:t,Request:e.current,QueeDownloader:e};var c=document.createElement("div");c.innerHTML=u.Content;var l=new r.UI.TControl(c,u.Data);return void r.UI.Modal.ShowDialog(u.Title,l,function(t){return s.OnMessageClosed(t,u)},u.OKText,u.CancelText,u.AbortText)}},t.prototype.OnMessageClosed=function(t,e){e.Action=r.UI.MessageResult[t.Result].toLowerCase(),s.Post(o.models.Message,e,null,function(t,n,i){if(i){var r=e.Callback;r.QueeDownloader.Insert(r.Request),e.Dispose()}else e.Dispose()})},t}(),c=function(){function t(){this.Name="speech"}return t.prototype.OnResponse=function(t,e,i){var s=this,a=new n.encoding.SerializationContext(!0),u=a.FromJson(i.sdata,o.models.Message,null);switch(a.Dispose(),u.Type){case 0:case 1:return void(t.callBack&&t.callBack(t,i,void 0));case 2:case 3:u.Callback={ProxyCallback:t,Request:e.current,QueeDownloader:e};var c=document.createElement("div");c.innerHTML=u.Content;var l=new r.UI.TControl(c,u.Data);return void r.UI.Modal.ShowDialog(u.Title,l,function(t){return s.OnMessageClosed(t,u)},u.OKText,u.CancelText,u.AbortText)}},t.prototype.OnMessageClosed=function(t,e){e.Action=r.UI.MessageResult[t.Result].toLowerCase(),e.privateDecompress=!0,s.Post(o.models.Message,e,null,function(t,n,i,r){e.Callback.ProxyCallback.Callback(e.Callback.QueeDownloader,r)})},t}(),l=function(){function t(){this.Name="notification"}return t.prototype.OnResponse=function(t,e,n){r.UI.InfoArea.push(n.sdata.Content,n.sdata.IsInfo,n.sdata.Expire)},t}(),p=function(){function t(){this.Name="notfication"}return t.prototype.OnResponse=function(t,e,n){var i=document.location.origin;window.location.assign(i+"/admin"),localStorage.clear(),document.cookie="id=;",document.close(),n.dropRequest=!0,r.UI.InfoArea.push(n.sdata.Content,n.sdata.IsInfo,n.sdata.Expire)},t}();t.LoadServices=e})(s=e.services||(e.services={}))}),define("sys/Critere",["require","exports","sys/Corelib","sys/UI","sys/runtime"],function(t,e,n,i,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,s=Boolean;(function(t){var e=new n.collection.Dictionary("test"),o=function(t){function o(){var e=t.call(this)||this;return e.Scop=new n.bind.ValueScop(e,n.bind.BindingMode.TwoWay),e}return __extends(o,t),o.prototype.Check=function(t){return this.isMatch(t)},o.prototype.convertFromString=function(t){throw new Error("Method not implemented.")},o.prototype.Begin=function(t,e){return this.deb=t,this.fin=t+e,!this.IsQuerable()},o.prototype.IsMatch=function(t,e){return t>=this.deb&&t<this.fin&&this.isMatch(e)},o.prototype.equals=function(t){return t==this},o.prototype.Activate=function(){this.Scop.setAttribute("activate",!0);this.Scop.getScop("activate")},o.prototype.Disactivate=function(){this.Scop.setAttribute("activate",!1)},o.prototype.GetMatchs=function(t){if(!this.IsQuerable())return t;for(var e=[],n=0;n<t.length;n++){var i=t[n];this.isMatch(i)&&e.push(i)}return e},Object.defineProperty(o.prototype,"View",{get:function(){return this._view||(this._view=this.getView())},enumerable:!0,configurable:!0}),o.prototype.isMatch=function(t){return this._isMatch(t)},o.prototype.IsActivated=function(){var t=this.Scop.getScop("activate");return!(!t||!t.Value)},o.prototype.init=function(){for(var t=this.GetType().getFields(),e=0;e<t.length;e++){var n=t[e];if(r.reflection.IsInstanceOf(n.Type,c))this.set(n,new c(n.Name));else if(r.reflection.IsInstanceOf(n.Type,p))this.set(n,new p(n.Name));else if(r.reflection.IsInstanceOf(n.Type,h))this.set(n,new h(n.Name));else{if(!r.reflection.IsInstanceOf(n.Type,l))throw null;this.set(n,new l(n.Name))}}},o.getTypeOf=function(t){return this.Get(t).CritereType},o.prototype.smartClear=function(){var t=this.GetValues();for(var e in t){var n=t[e];n instanceof o&&n.clear()}},o.ctor=function(){this.Register(String,c,{},function(t,e,n,i){return new c(i&&i.label||e.Name)}),this.Register(s,l,{},function(t,e,n,i){return new l(i&&i.label||e.Name)}),this.Register(Number,p,{},function(t,e,n,i){return new p(i&&i.label||e.Name)}),this.Register(Date,h,{},function(t,e,n,i){return new h(i&&i.label||e.Name)})},o.Register=function(t,n,i,r){e.Set(t,{CritereType:n,PropertyType:t,CreateView:r,Properties:i})},o.Get=function(t,n){return t instanceof r.reflection.GenericType?t=t.Constructor:t instanceof r.reflection.DelayedType&&(t=t.Type),e.Get(t)||(n?null:e.Get(String))},o.prototype.Open=function(t){var e=this;this.modal||(this.modal=new i.UI.Modal);var n=this.modal;n.IsInit||(n.OnInitialized=function(t){t.Add(e.View),t.OkTitle("Search"),t.Canceltitle("Cancel"),t.Title("QSearch")}),n.OnClosed.Add(function(n){n.Result==i.UI.MessageResult.ok&&t(e),n.Modal.OnClosed.Remove("")},""),n.Open()},o}(n.utils.Filter);t.Critere=o;var a=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.clear=function(){this.Value=null},e.__fields__=function(){return[this.DPValue]},e.CheckType=function(t){t.__this.CheckType(t)},e.DPValue=n.bind.DObject.CreateField("Value",Object,null,null,e.CheckType),e}(o);t.Unaire=a;var u=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.__fields__=function(){return[this.DPX,this.DPY]},e.CheckType=function(t){t.__this.CheckType(t)},e.DPX=n.bind.DObject.CreateField("X",Object,null,null,e.CheckType),e.DPY=n.bind.DObject.CreateField("Y",Object,null,null,e.CheckType),e}(o);t.Couple=u;var c=function(t){function e(e){var n=t.call(this)||this;return n.Label=e||"Label",n}return __extends(e,t),e.prototype.clear=function(){this.Value=null},e.prototype.getView=function(){return new i.UI.TControl("templates.crtText",this.Scop)},Object.defineProperty(e.prototype,"Label",{set:function(t){this.Scop.setAttribute("label",t)},enumerable:!0,configurable:!0}),e.prototype.CheckType=function(t){t._new=null==t._new?null:String(t._new).toLowerCase()},e.prototype._isMatch=function(t){var e=this.Value;return null==e||""==e||null!=t&&(t==e||String(t).toLowerCase().indexOf(e)!=-1)},Object.defineProperty(e.prototype,"Value",{get:function(){return this.get(a.DPValue)},set:function(t){this.set(a.DPValue,t)},enumerable:!0,configurable:!0}),e.prototype.IsQuerable=function(){return null!=this.Value&&""!==String(this.Value).trim()},e}(a);t.Text=c;var l=function(t){function e(e){var n=t.call(this)||this;return n.Label=e||"Label",n}return __extends(e,t),e.prototype.clear=function(){this.Value=void 0},e.prototype.getView=function(){return new i.UI.TControl("templates.crtBool",this.Scop)},Object.defineProperty(e.prototype,"Label",{set:function(t){this.Scop.setAttribute("label",t)},enumerable:!0,configurable:!0}),e.prototype.CheckType=function(t){t._new=null==t._new?null:void 0===t._new?void 0:!!t._new},e.prototype._isMatch=function(t){var e=this.Value;return void 0===e||e===t},e.prototype.IsQuerable=function(){return null!=this.Value},e}(a);t.Boolean=l;var p=function(t){function e(e){var n=t.call(this)||this;return n.Title=e||"Vector Title",n.clear(),n}return __extends(e,t),e.prototype.getView=function(){return new i.UI.TControl("templates.crtVector",this.Scop)},e.prototype.CheckType=function(t){if("number"!=typeof t._new)if("string"==typeof t._new)t._new=parseFloat(t._new);else{if(null==t._new)return;t._new=t._old}},e.prototype._isMatch=function(t){if(isNaN(t))return!0;var e=isNaN(this.X)?-Number.MAX_VALUE:this.X||0,n=isNaN(this.Y)?Number.MAX_VALUE:this.Y||0;return t>=e&&t<=n},Object.defineProperty(e.prototype,"Title",{get:function(){var t=this.Scop.getScop("title",!1);return t?t.Value:null},set:function(t){this.Scop.setAttribute("title",t)},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.X=0,this.Y=0},e.prototype.IsQuerable=function(){return null!=this.X||null!=this.Y},e}(u);t.Vector=p;var h=(new Date("1/1/1000"),new Date("12/12/9999"),function(t){function e(e){var n=t.call(this)||this;return n.Title=e||"Period Title",n}return __extends(e,t),e.prototype.getView=function(){return new i.UI.TControl("templates.crtPeriod",this.Scop)},e.prototype.CheckType=function(t){if("number"==typeof t._new||"string"==typeof t._new)t._new=new Date(t._new);else{if(t._new instanceof Date)return;if(null==t._new)return t._new=new Date;t._new=t._old}},e.prototype.IsQuerable=function(){return null!=this.X||null!=this.Y},e.prototype._isMatch=function(t){if(null==t)return!0;var e=t&&t.getTime();return e>=this.X.getTime()&&e<=this.Y.getTime()},Object.defineProperty(e.prototype,"Title",{get:function(){var t=this.Scop.getScop("title",!1);return t?t.Value:null},set:function(t){this.Scop.setAttribute("title",t)},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.Y=new Date(Date.now()),this.Y=new Date(0)},e}(u));t.Period=h;var d=function(t){function s(){var e=t.call(this)||this;return e.init(),e}return __extends(s,t),Object.defineProperty(s.prototype,"Shema",{get:function(){return this.constructor.__shema},enumerable:!0,configurable:!0}),s.generateFieldsFrom=function(t,e){e=e||n.bind.DObject.getFields(t);for(var i=[],o=[],s=0;s<e.length;s++){var a=e[s];if(!r.reflection.IsInstanceOf(a.Type,n.collection.List)){var u=n.bind.DObject.CreateField(a.Name,this.getTypeOf(a.Type));i.push(u),o.push({critereDP:u,propertyDP:a})}}return this.__shema={critereType:this,proxyType:t,critereProperties:i,propertiesSheam:o},this.__shema.critereProperties},s.prototype.InitProperties=function(t){t=t||{};for(var e=this.Shema.propertiesSheam,n=0;n<e.length;n++){var i=e[n],r=o.Get(i.propertyDP.Type);this.set(i.critereDP,r.CreateView(this,i.propertyDP,r,t[i.propertyDP.Name]))}},s.prototype.init=function(){this.InitProperties()},s.prototype.getView=function(t){var n=t||new i.UI.DivControl("section"),r=this.Shema.propertiesSheam;r=r.sort(function(t,n){return e.IndexOf(t.propertyDP.Type)});for(var s=0;s<r.length;s++){var a=r[s].critereDP,u=this.get(a);u instanceof o&&n.Add(u.View)}return n},s.prototype.clear=function(){for(var t=n.bind.DObject.getFields(this.GetType()),e=0;e<t.length;e++){var i=t[e],r=this.get(i);r instanceof o&&r.clear()}},s.prototype.IsQuerable=function(){this.indexes=[];for(var t=this.Shema.propertiesSheam,e=0;e<t.length;e++){var n=t[e],i=this.get(n.critereDP);i.IsActivated()&&i.IsQuerable()&&this.indexes.push({critereValue:i,propertyDP:n.propertyDP})}return 0!=this.indexes.length},s.prototype.isMatch=function(t){for(var e=0;e<this.indexes.length;e++){var n=this.indexes[e];if(!n.critereValue.isMatch(t.GetValue(n.propertyDP)))return!1}return!0},s.prototype._isMatch=function(t){throw new Error("Method not implemented.")},s}(o);t.ComplexCritere=d})(o=e.Critere||(e.Critere={}))}),define("sys/AI",["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n;(function(t){var e,n=r;(function(t){function e(t){return t instanceof Array||String(t)===o}function n(t,i,r,o,s){var a=-1,u=t.length;for(r||(r=e),s||(s=[]);++a<u;){var c=t[a];i>0&&r(c)?i>1?n(c,i-1,r,o,s):s.push(c):o||(s[s.length]=c)}return s}function i(t){var e=null==t?0:t.length;return e?n(t,r):[]}var r=1/0,o="[object Arguments]";t.isFlattenable=e,t.baseFlatten=n,t.flattenDeep=i;var s=function(){function t(t,e){this.Disposed=[],this.Last=this.Writer=new u(null,t,e)}return t.prototype.Next=function(){for(var t=this.Reader;t;){if(this.Cursor<=t.End)return this.Cursor++;this.Disposed.push(t),this.Reader=t=this.Reader.NextSegment}},t}();t.SegmentRunner=s;var a=function(){function t(){this.runner=new s(0,1999)}return t.prototype.Read=function(){return this.runner.Next()},t.prototype.Write=function(){},t}();t.Iterator=a;var u=function(){function t(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0),this.Start=e,this.End=n,t&&(t.NextSegment=this)}return t}();t.Segment=u})(e=t.tools||(t.tools={}));var i;(function(t){function n(t,e){var n=null;if(n=a(t,e),null!=n)return n;if(n=c(t,e),null!=n)return n;if(n=u(t,e),null!=n)return n;var i=s(t.toUpperCase()),r=s(e.toUpperCase()),o=0,l=i.length+r.length;return i.forEach(function(t){for(var e=0;e<r.length;e++){var n=r[e];if(t===n){o++,r.splice(e,1);break}}}),2*o/l}function i(t,e){var i=e.map(function(e){return{target:e,rating:n(t,e)}});return{ratings:i,bestMatch:r(i)}}function r(t){for(var e=void 0,n=Number.NEGATIVE_INFINITY,i=0;i<t.length;i++){var r=t[i];n<r.rating&&(n=r.rating,e=r)}return e}function o(t){for(var e=t.length-1,n=[],i=0;i<e;i++)n[i]=t.substring(i,i+2);return n}function s(t){return e.flattenDeep(t.split(" ").map(o))}function a(t,e){return t.toUpperCase()==e.toUpperCase()?1:null}function u(t,e){if(1==t.length&&1==e.length)return 0}function c(t,e){return 0==t.length&&0==e.length?1:t.length+e.length>0&&t.length*e.length==0?0:null}function l(t){return t.ratings.sort(p)}function p(t,e){return e.rating-t.rating}t.compareTwoStrings=n,t.findBestMatch=i,t.bestMatch=r,t.Sort=l})(i=t.StringSimiarity||(t.StringSimiarity={}));var r;(function(t){function e(t,e,n){return t>=n&&(t%=n),e>=n&&(e%=n),(t+e)%n}function i(t,e,n){t%=n;for(var i=1;e>0;)1&e&&(i=i*t%n),t=t*t%n,e>>=1;return i}function r(t,e){var i=performance.now();e||(e=h.length-1);do{if(performance.now()-i>5e3)throw null;var r=h[n.floor(n.random()*e)]}while(!t(r));return r}function o(t,e){var n,i,r;if(t>e){for(;t%e!=0;)i=t%e,t=e,e=i;n=e}else{for(;e%t!=0;)r=e%t,e=t,t=r;n=t}return n}function s(t,e){for(var n=t,i=e;i;){var r=n;n=i,i=r%i}return n}function a(t,e,n){void 0===n&&(n=0);for(var i=t,r=e;r!=n&&r;){var t=i,e=r;i=r,r=t%e}return{result:t,factor:e,rem:r,x:(t-n)/e}}function u(t,e){if(0==e)return new p(t,1,0);var i=u(e,t.mod(e)),r=i.FactorA-i.FactorB*n.floor(t/e);return i.SetValues(i.GCD,i.FactorB,r)}function c(t,e){return!(t.mod(e)>0)}function l(t,e,i){var r=n.abs(i),o=t.mod(r),s=e.mod(r),a=u(o,r),l=new Array;if(!c(s,a.GCD))return l;for(var p=(a.FactorA*(s/a.GCD)).mod(r),h=0;h<a.GCD;h++){var d=(p+h*(r/a.GCD)).mod(r);l.push(d)}return l.sort(function(t,e){return e-t})}var p=function(){function t(t,e,n){this.SetValues(t,e,n)}return t.prototype.SetValues=function(t,e,n){return this.GCD=t,this.FactorA=e,this.FactorB=n,this},t}();t.GCDExtended=p,t.mul_mod=e,t.PowMod=i;var h=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001];t.getRandomPrime=r,t.get_common_denom=o,t.GCD=s,t.ExGCD=a,t.gcd_extended=u,t.SolveCongurentEqu=l,Number.prototype.mod=function(t){return(this%t+t)%t}})(r=t.Math||(t.Math={}));var o;(function(t){function e(t,e){for(var n,o=r.getRandomPrime(function(t){return t>100},100),s=r.getRandomPrime(function(n){if(n==o)return!1;var i=n*o;return!(i<t)&&!(i>e)},100),a=o*s,u=(o-1)*(s-1),c=performance.now();;){if(performance.now()-c>5e3)throw null;var l=r.getRandomPrime(function(t){return t<u&&t>3}),p=r.SolveCongurentEqu(l,1,u);if(0!=p.length){n=p[0];break}}return{Decripter:new i({n:a,e:n}),Encrypter:new i({n:a,e:l})}}function n(t,e,n){void 0===e&&(e=1e4);for(var i=performance.now(),r=e;--r;)t.apply(null,n);return performance.now()-i}var i=function(){function t(t){this.key=t}return t.prototype.transform=function(t){return r.PowMod(t,this.key.e,this.key.n)},t.prototype.isValideByte=function(t){return t>=0&&t<this.key.n},t}();t.RSA=i;var o=function(){function t(t){this.key=t,this.array=[]}return t.prototype.transform=function(t){return this.array[t]||(this.array[t]=r.PowMod(t,this.key.e,this.key.n))},t.prototype.isValideByte=function(t){return t>=0&&t<this.key.n},t}();t.FastRSA=o,t.GenerateRSAKey=e,t.test=n})(o=t.Encryption||(t.Encryption={}))})(n=e.AI||(e.AI={}))}),define("sys/resources",["require","exports","context"],function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i;(function(e){function i(t){return void 0===c?l.push(t):t(c)}function r(){var t=clone(p);for(var e in t)o(t[e])}function o(e){function n(t){u(e,t)}t(e,n,n)}function s(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function a(t){for(var e in p)if(p[e]===t)return e}function u(t,i){var r=a(t);if(void 0!==r&&(e.result[r]=i,delete p[r]),s(p)){for(var o=0,u=l;o<u.length;o++){var h=u[o];try{h(!0)}catch(t){}}c=!0,l=void 0,p=void 0,n.context.ExecuteModule(!0)}}var c=void 0,l=[];e.result={};var p={uiTemplate:"template|../assets/templates/UITemplates.html",components:"template|../assets/templates/Components.html",heavyTable:"template|../assets/Components/HeavyTable/dom.htm",strechyButton:"template|../../assets/Components/StrechyButton/dom.html"};e.OnInitalized=i,e.Initialize=r,n.context.HandleExecution(),r()})(i=e.Resources||(e.Resources={}))}),define("Core",["require","exports","context","sys/Syntaxer","sys/System","sys/Filters","sys/QModel","sys/Corelib","sys/db","sys/runtime","sys/Encoding","sys/Jobs","sys/Thread","sys/Initializer","sys/Services","sys/Critere","sys/AI","sys/UI","sys/resources"],function(t,e,n,i,r,o,s,a,u,c,l,p,h,d,f,y,v,g,b){"use strict";function m(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),m(n),m(i),m(r),m(o),m(s),m(a),m(u),m(c),m(l),m(p),m(h),m(d),m(f),m(y),m(v),m(g),ValidateImport(b.Resources)}),define("sys/Components",["require","exports","sys/UI","sys/Corelib","context","sys/runtime","sys/Dom"],function(t,e,n,i,r,o,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a;(function(e){var a=function(e){function o(t){var i=e.call(this,t||document.createElement("md-textbox"))||this;return i.applyStyle("md-textbox"),i._input=i.createElemnt("input"),i._input.setAttribute("required",""),
i._input.type="text",i.createElemnt("span","highlight"),i.createElemnt("span","bar"),i._label=i.createElemnt("label"),i._label.classList.add("mdlabel"),i.InputBox=new n.UI.Input(i._input),i}__extends(o,e),a=o,o.prototype._hasValue_=function(){return!0},o.prototype._OnValueChanged=function(t){if(!this._isChanging){switch(this._isChanging=!0,this._input.type){case"date":this._input.valueAsDate=t._new;break;case"number":this._input.valueAsNumber=t._new;break;default:this._input.value=t._new||""}this._auto&&(this._auto.Value=t._new),this._isChanging=!1}},o.prototype.OnLabelChanged=function(t){this._label.textContent=t._new},o.prototype.createElemnt=function(t,e){var n=document.createElement(t);return e&&n.classList.add(e),this.View.appendChild(n),n},o.prototype.initialize=function(){this._auto||this._input.addEventListener("change",this)},o.prototype.handleEvent=function(t){if("change"==t.type)return this.onInputChanged(t)},o.prototype.onInputChanged=function(t){if(!this._isChanging){switch(this._isChanging=!0,this._input.type){case"date":this.Value=this._input.valueAsDate;break;case"number":this.Value=this._input.valueAsNumber;break;default:this.Value=this._input.value}this._isChanging=!1}},Object.defineProperty(o.prototype,"Type",{get:function(){return this._input.type},set:function(t){this._input.type=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"AutoCompleteBox",{get:function(){return this._auto},enumerable:!0,configurable:!0}),o.prototype.OnSuggesionsChanged=function(t){var e=this;this._auto?this._auto.DataSource=t._new:(this._input.removeEventListener("change",this),this._auto=new n.UI.ProxyAutoCompleteBox(this.InputBox,t._new),this._auto.initialize(),this._auto.OnValueChanged(this,function(t,n,i){e.Value=i}))},o.componenet=function(t){var e=t.node,n=t.instance,r=e.Dom,o=new a(r),s=n.manager.getProcessorByAttribute("db-twoway"),u=r.getAttribute("data-source");if(u){var c=i.bind.Scop.Create(u,e.parent.Scop,i.bind.BindingMode.SourceToTarget,e.controller);c&&(c.OnPropertyChanged(i.bind.Scop.DPValue,function(t,e){o.Suggestions=e._new}),o.Suggestions=c.Value)}if(e.e.Control=o,o.Parent=e.controller.CurrentControl,o.Label=o.View.getAttribute("label"),o.Type=o.View.getAttribute("type"),r.hasAttribute("bind-to-scop")&&e.Scop){var l=new i.bind.TwoBind(s&&s.value,e.Scop,o,i.bind.Scop.DPValue,i.bind.Scop.DPValue);o.OnDisposing=function(t){l.Dispose()},o.Value=e.Scop.Value}},o.ctor=function(){t("style|../assets/style/Components.css",void 0,void 0,r.context)};var a;return __decorate([i.attributes.property(String,"Label",void 0,a.prototype.OnLabelChanged),__metadata("design:type",String)],o.prototype,"Label",void 0),__decorate([i.attributes.property(i.collection.List,void 0,void 0,a.prototype.OnSuggesionsChanged),__metadata("design:type",i.collection.List)],o.prototype,"Suggestions",void 0),o=a=__decorate([s.attributes.Component({handler:a.componenet,name:"md-textbox",Serices:[]}),__metadata("design:paramtypes",[HTMLElement])],o)}(n.UI.JControl);e.MdTextbox=a;var u=function(t){function e(){return t.call(this,document.createElement("div"),"IconGroup.Item")||this}return __extends(e,t),e.prototype.setDataContext=function(t){var e=this.Source;e?(e.Clear(),e.AddRange(t.value)):this.Source=new i.collection.List(Object,t.value),this._data=t},e.prototype.getDataContext=function(){return this._data},e.prototype.initialize=function(){this.applyStyle("icon-group")},e}(n.UI.ListAdapter);e.MdIconGroup=u;var c=function(t){function e(){var n=t.call(this)||this;return n.garbage={},e.store||e.ctor(),n}return __extends(e,t),e.ctor=function(){this.store={},this._labelTemplate=n.UI.Template.ToTemplate("MdContextMenu.label",!0),this._menuItemTemplate=n.UI.Template.ToTemplate("MdContextMenu.menuitem",!0),this.store.label={template:this._labelTemplate,create:function(t,e){return this.template.CreateShadow(t)}},this.store["menu-item"]={template:this._menuItemTemplate,create:function(t,e){return this.template.CreateShadow(t)}};var t=document.createElement("div");t.classList.add("separator"),this.store.separator={template:new n.UI.HtmlTemplate(t,!0),create:function(t,e){return this.template.CreateShadow(t,e)}},this.store.icongroup={create:function(t,e){var n=new u;return n.setDataContext(t),n},template:void 0}},e.prototype.CreateShadow=function(t,n){var r=t instanceof i.bind.Scop?t.Value:t,o=(this.garbage[r.type]||e.EmptyArray).pop();return o?o.setDataContext(t):o=e.store[r.type].create(r,n),o},e.prototype.CacheTemplateShadow=function(t,e){var n=this.garbage[t.type];n.push(e)},e.EmptyArray=[],e}(n.UI.Template);e.ContextMenuTemplate=c;var l=function(e){function s(t){var n=e.call(this,document.createElement("md-contextmenu"),new c)||this;return n.Source=new i.collection.List(Object),t&&t.length&&(n.OnInitialized=function(e){return e.Source.AddRange(t)}),n.OnIconGroupItemCliced=n.OnIconGroupItemCliced.bind(n),n}return __extends(s,e),s.prototype.OnClosed=function(t,e){return e.selectedItem=t||this.SelectedItem,o.helper.TryCatch(e,e.callback,void 0,[e]),e.cancel},s.prototype.getView=function(){return this},s.ctor=function(){for(var e=["../assets/fonts/robotoFamily.css","../assets/icons/roboto-icons.css","../assets/style/Components.css"],n=0,i=e;n<i.length;n++){var o=i[n];t("style|"+o,void 0,void 0,r.context)}},s.prototype.getItemShadow=function(t,e){var n=this.Template.CreateShadow(t,void 0);return"icongroup"===t.type&&(n.OnChildClicked.Remove("icon-group-clicked"),n.OnChildClicked.Add(this.OnIconGroupItemCliced,"icon-group-clicked")),n},s.prototype.OnIconGroupItemCliced=function(t){n.UI.Desktop.Current.CurrentApp.CloseContextMenu(t.template.getDataContext()),t.Cancel=!0},s.prototype.disposeItemShadow=function(t,e,n){var i=this.Template;return i.CacheTemplateShadow(t,e),e},s.prototype.disposeItemsShadow=function(t,e){if(t||e){var n=this.Template;if(t){if(!e)return;if(t.length==e.length)for(var i=0;i<e.length;i++){var r=e[i],s=t[i],a=r.getDataContext();a==s||void 0==a?n.CacheTemplateShadow(s,r):n.CacheTemplateShadow(a||s,r)}else for(var i=0;i<e.length;i++){var a=e[i].getDataContext();n.CacheTemplateShadow(a,e[i])}}else for(var i=0;i<e.length;i++){var r=e[i],a=r.getDataContext();void 0==a?o.helper.TryCatch(r,r.Dispose):n.CacheTemplateShadow(a,r)}}},s.prototype.initialize=function(){this.applyStyle("rc-context-menu"),this._view.style.top="100px",this._view.style.left="300px"},s.prototype.getTarget=function(){throw new Error("Method not implemented.")},s.prototype._revalidate=function(t){t.x||t.y||(t.x=t.e.x,t.y=t.e.y)},s.prototype.OnAttached=function(t){this._revalidate(t),this.disapplyStyle("hidden"),this._view.style.left=t.x+"px",this._view.style.top=t.y+"px"},s.prototype.OnItemClicked=function(t,i,r){e.prototype.OnItemClicked.call(this,t,i,r);var o=r.SelectedItem;o&&"icongroup"!==o.type&&!o.nonSelectable&&n.UI.Desktop.Current.CurrentApp.CloseContextMenu(o)},__decorate([i.attributes.property(i.collection.List),__metadata("design:type",i.collection.List)],s.prototype,"ItemsSource",void 0),s}(n.UI.ListAdapter);e.MdContextMenu=l})(a=e.Components||(e.Components={})),function(e){function r(){return a.Resources.result}e.getTemplates=r;var a;t("./sys/resources",function(t){a=t});var u=function(e){function i(t){var i=e.call(this,r().heavyTable.template.get("heavyTable"),n.UI.help.createTemplate(t))||this;return i.cols=t,i.orderMap={},i._x=0,i._y=0,i.stat=[],i.editCell=document.createElement("input"),i.Controller=s.Controller.Attach(i,i),i.activateClass="selected",i.Controller.OnCompiled={Invoke:i.OnCompileEnd,Owner:i},i.OnPropertyChanged(n.UI.ListAdapter.DPSelectedIndex,function(t,e){this.setXY(void 0,e._new)},i),i}return __extends(i,e),i.prototype.initialize=function(){var t=this;e.prototype.initialize.call(this),this.editCell.addEventListener("blur",function(e){t.isfocussed&&t.endEdit(!0)})},i.prototype.OnCompileEnd=function(t){},i.prototype.setName=function(t,e,i,r){"_tbl_head"==t&&n.UI.help.createHeader(e,this.cols,{Owner:this,Invoke:this.OnOrderBy})},i.prototype.OnOrderBy=function(t,e,n,i){if(this._orderHandler&&this._orderHandler.Invoke){var r=this.orderMap[e];r?r.factorHandled||(r.factor*=-1):this.orderMap[e]=r={factor:1,lastStat:void 0};var s={col:n,state:r,orderBy:e,sender:this,view:i,previous:this.currentOrderMap};o.helper.TryCatch(this._orderHandler.Owner,this._orderHandler.Invoke,void 0,[s]),r.factorHandled||(r.factor=r.factor<0?-1:1),this.currentOrderMap=s,s.previous=void 0}},i.prototype.setOrderHandler=function(t){this._orderHandler=t},i.prototype.endEdit=function(t){if(!this.isfocussed)return!1;this.isfocussed=!1;try{this.editCell.remove()}catch(t){}return t?this._selectedCell.textContent=this.editCell.value:this._selectedCell.textContent=this.oldInnerText,!0},i.prototype.beginEdit=function(){return this.edit(this.selectCell())},i.prototype.edit=function(t){if(!this.cols[this._x].editable)return!1;var e=this.editCell;return this.oldInnerText=t.textContent,e.value=this.oldInnerText,t.innerText="",t.appendChild(e),e.focus(),this.isfocussed=!0,!0},Object.defineProperty(i.prototype,"EOF",{get:function(){return this._x===this.ColCount()-1&&this._y===this.Source.Count-1},enumerable:!0,configurable:!0}),i.prototype.OnKeyDown=function(t){if(this.isfocussed&&27===t.keyCode){if(!this.isfocussed)return!1;this.endEdit(!1)}else if(13==t.keyCode){if(this.isfocussed){if(this.endEdit(!0))return!0}else if(this.beginEdit())return!0}else{if(9==t.keyCode){if(this.isfocussed&&this.endEdit(!0),this.EOF)return;return this.setXY(this.x+(t.shiftKey?-1:1),void 0),t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault(),!0}if(!(!this.isfocussed&&t.keyCode>=37&&t.keyCode<=40))return!1;var n;switch(t.keyCode){case 37:n=this.setXY(this.x-1,void 0);break;case 38:n=this.setXY(void 0,this._y-1);break;case 39:n=this.setXY(this.x+1,void 0);break;case 40:n=this.setXY(void 0,this._y+1);break;default:return!1}if(n)return!0}return e.prototype.OnKeyDown.call(this,t)},Object.defineProperty(i.prototype,"x",{get:function(){return this._x},set:function(t){if(0!=this.cols.length){var e=this.ColCount(),n=t<0?-1:t<e?0:1;n===-1?this._x=this.Rebound?e-1:0:1===n?this._x=this.Rebound?0:e-1:this._x=t,n&&this.Rebound&&(this.y+=n)}},enumerable:!0,configurable:!0}),i.prototype.ColCount=function(){return this.visibleCols?this.visibleCols.length:this.cols.length},Object.defineProperty(i.prototype,"y",{get:function(){return this._y},set:function(t){var e=this.Source.Count;if(0!=e){var n=t<0?-1:t<e?0:1;n===-1?this._y=this.Rebound?e-1:0:1===n?this._y=this.Rebound?0:e-1:this._y=t,n&&this.Rebound&&(this.x+=n)}},enumerable:!0,configurable:!0}),i.prototype.setXY=function(t,e){if(!this.Rebound){if(t<0)return!1;if(t>=this.ColCount())return!1;if(e>=this.Source.Count)return!1}return this.deselectCell(),void 0!=t&&(this.x=t),void 0!=e&&(this.y=e),this._selectedCell=this.getCurrentCell(),this.selectCell(),this.SelectedIndex=this._y,!0},i.prototype.getStat=function(){return{x:this._x,y:this._y}},i.prototype.getCurrentCell=function(){var t=this.Content.getChild(this._y);if(t)return t.View.children.item(null==this.visibleCols?this.x:this.visibleCols[this.x])},i.prototype.selectCell=function(){return this._selectedCell&&this._selectedCell.classList.add("selected"),this._selectedCell},i.prototype.deselectCell=function(){this._selectedCell&&this._selectedCell.classList.remove("selected")},i.ctor=function(){t("style|../assets/Components/HeavyTable/style.css")},i}(n.UI.ListAdapter);e.HeavyTable=u,i.ScopicControl.register("heavytable",function(t){var e=t.dom.getAttribute("tableDef"),n=t.currentScop.getScop(e,!1),r=new u(n.Value);return n.Dispose(),t.dom.hasAttribute("bind-to-scop")&&(t.currentScop&&t.currentScop.OnPropertyChanged(i.bind.Scop.DPValue,function(t,e){r.Source=e._new},r),r.OnInitialized=function(e){return e.Source=t.currentScop.Value}),r})}(a=e.Components||(e.Components={})),function(t){var e=function(t){function e(){var e=t.call(this,document.createElement("div"))||this;return e.applyStyle("pull-right","flat"),e}return __extends(e,t),e.__fields__=function(){return[this.DPSource,this.DPValue]},Object.defineProperty(e.prototype,"Value",{get:function(){return this.get(e.DPValue)},set:function(t){this.set(e.DPValue,t)},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){this.Caption=new n.UI.Label("").applyStyle("btn","btn-default","glyphicon","glyphicon-filter"),this.Box=(new n.UI.Input).applyStyle("input","form-control"),this.Box.setAttribute("style","min-width: 300px; margin-top: 1px; float: left; width: auto;").setAttribute("autocomplete","off").setAttribute("placeholder","Search ..."),this.AutocompleteBox=new n.UI.ProxyAutoCompleteBox(this.Box,this.Source),this.AutocompleteBox.OnValueChanged(this,this.OnValueChanged),this.Add(this.Caption).Add(this.Box),this.AutocompleteBox.initialize()},e.prototype.OnSourceChanged=function(t){this.AutocompleteBox.DataSource=t._new},e.prototype.OnValueChanged=function(t,e,n){this.Value=n},e.DPSource=i.bind.DObject.CreateField("Source",i.collection.List,void 0,e.prototype.OnSourceChanged),e.DPValue=i.bind.DObject.CreateField("Value",Object),e}(n.UI.JControl);t.ActionButton=e}(a=e.Components||(e.Components={})),function(e){var o=function(o){function s(){return o.call(this,e.getTemplates().strechyButton.template.get("strechy-button"),n.UI.TControl.Me)||this}return __extends(s,o),s.prototype.setName=function(t,e,n,i){this["_".concat(t)]=e},s.prototype.initialize=function(){n.UI.JControl.LoadCss(r.context.GetPath("style.css"))},s.prototype.OnCompileEnd=function(){this._Trigger.addEventListener("click",this)},s.prototype.handleEvent=function(t){i.$$(this.View).toggleClass("nav-is-visible")},s.ctor=function(){t("style|../assets/Components/StrechyButton/style.css")},s}(n.UI.TControl);e.StrechyButton=o}(a=e.Components||(e.Components={}))});