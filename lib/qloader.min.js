function ValidateImport(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0;n<e.length;n++){if(void 0!=e[n])continue;e.splice(n,1)}}var __extends=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},exports={},__global={},envirenment,clone,$,$defineProperty,$bench;(function(e){function t(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)}function n(e){for(var t=e;t;){var n=getComputedStyle(t).overflowY;if("auto"==n)return t;t=t.parentElement}}function r(e,t){return t instanceof HTMLElement?e===t.id?t:o(e,t):t instanceof Element&&t.id==e?t:void 0}function o(e,t){var n=new Array(1e3);n[0]=t;for(var r=0;r>=0;)for(var o=n[r--],i=0,s=o.children.length;i<s;i++){var a=o.children[i];if(a.id===e)return a;a instanceof HTMLElement&&(n[++r]=a)}}function i(e,t){return e=e.toUpperCase(),t instanceof HTMLElement?s(e,t):t instanceof Element&&t.tagName===e?[t]:[]}function s(e,t){var n=new Array(1e3);if(e===t.tagName)var r=[t];else r=[];n[0]=t;for(var o=0;o>=0;)for(var i=n[o--],s=0,a=i.children.length;s<a;s++){var u=i.children[s];u.tagName===e&&r.push(u),u instanceof HTMLElement&&(n[++o]=u)}return r}function a(e,t){return t instanceof HTMLElement?u(e,t):t instanceof Element&&t.classList.contains(e)?[t]:[]}function u(e,t){var n=new Array(1e3);n[0]=t;var r=0;if(t.classList.contains(e))var o=[t];else o=[];for(;r>=0;)for(var i=n[r--],s=0,a=i.children.length;s<a;s++){var u=i.children[s];u.classList.contains(e)&&o.push(u),u instanceof HTMLElement&&(n[++r]=u)}return o}function l(e,t){return t instanceof HTMLElement?c(e,t):t instanceof Element&&t.hasAttribute(e)?[t]:[]}function c(e,t){var n=new Array(1e3);if(t.hasAttribute(e))var r=[t];else r=[];n[0]=t;for(var o=0;o>=0;)for(var i=n[o--],s=0,a=i.children.length;s<a;s++){var u=i.children[s];u.hasAttribute(e)&&r.push(u),u instanceof HTMLElement&&(n[++o]=u)}return r}$defineProperty=function(e,t,n,r){try{return Object.defineProperty(e,t,n)}catch(o){return r&&r(e,t,n),!1}},e.getMobileOperatingSystem=function(){var t=navigator.userAgent||navigator.vendor||e.opera;return/windows phone/i.test(t)?"Windows Phone":/android/i.test(t)?"Android":/iPad|iPhone|iPod/.test(t)&&!e.MSStream?"iOS":"unknown"},__global={supportTemplate:function(){return"content"in document.createElement("template")}(),useListenerOrMutation:!0,GetApiAddress:function(e){return __global.ApiServer?__global.ApiServer.Combine(e).toString():e},CaseSensitive:!1,https:!1,ApiServer:void 0};var h=function(e,t){function n(){this.constructor=e}$defineProperty(e,"base",{value:t,writable:!1,enumerable:!0,configurable:!1});for(var r in t)"base"!=r&&0!==r.indexOf("_")&&"ctor"!=r&&t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};$defineProperty(e,"__extends",{get:function(){return h},set:function(){},configurable:!1,enumerable:!1},function(){__extends=h});var d=d=!("undefined"==typeof e||"undefined"==typeof navigator||!e.document);envirenment={isBrowser:d,isWebWorker:!d&&"undefined"!=typeof importScripts,isOpera:"undefined"!=typeof e.opera&&"[object Opera]"===e.opera.toString(),isChromeApp:"chrome-extension:"===document.location.protocol,isMobile:!!t()},__global.supportTemplate||$defineProperty(HTMLUnknownElement.prototype,"content",{get:function(){return this}}),clone=function(e){if(!e)return e;if("object"==typeof e){var t=e.constructor();for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}return e instanceof Array?e.splice(0):e},Element.prototype.getScrollArea=function(){return n(this)},Object.clone=clone,void 0==Element.prototype.scrollIntoViewIfNeeded&&(Element.prototype.scrollIntoViewIfNeeded=function(){var e=this.getBoundingClientRect(),t=n(this);if(!t)return void this.scrollIntoView({inline:"center"});var r=document.body,o=(t||r).getBoundingClientRect();o.top-e.top>0?t.scrollTop-=o.top-e.top:o.bottom<e.bottom&&(t.scrollTop-=o.bottom-e.bottom)}),void 0===String.prototype.endsWith&&(String.prototype.endsWith=function(e){return this.indexOf(e,this.length-e.length)!==-1}),void 0===String.prototype.startsWith&&(String.prototype.startsWith=function(e){return 0===this.indexOf(e)}),void 0===HTMLElement.prototype.remove&&(HTMLElement.prototype.remove=function(){this.removeNode(!0)}),void 0===HTMLElement.prototype.parent&&(HTMLElement.prototype.parent=function(){return this.parentElement||this.parentNode}),HTMLElement.prototype.insertChildAtIndex=function(e,t){var n=this.children.length;t<n?this.insertBefore(e,this.children.item(t)):this.appendChild(e)},$=function(e,t){var n=document.body,o=document;t=t===o?n:t||n;var s=t===n,u=e[0]||"";return"#"===u?s?document.getElementById(e.substr(1)):r(e.substr(1),t):"."===u?s?document.getElementsByClassName(e.substr(1)):a(e.substr(1),t):"["===u?l(e.substr(1,e.length-2),t):s?document.getElementsByTagName(e):i(e,t)},DocumentFragment.prototype.hasOwnProperty("firstElementChild")||$defineProperty(DocumentFragment.prototype,"firstElementChild",{get:function(){for(var e=this.children||this.childNodes,t=0;t<e.length;t++)if(e[t]instanceof Element)return e[t];return null},configurable:!1}),"undefined"==typeof DOMParser&&(e.DOMParser=function t(){this.parseFromString=function(t,n){if(/^\s*text\/html\s*(?:;|$)/i.test(n)){var r=document.implementation.createHTMLDocument("");return t.toLowerCase().indexOf("<!doctype")>-1?r.documentElement.innerHTML=t:r.body.innerHTML=t,r}return e.DOMParser.prototype.nativeParse.apply(this,arguments)},function(e){"use strict";var t=e.prototype,n=t.parseFromString;try{if((new e).parseFromString("","text/html"))return}catch(e){}t.parseFromString=function(e,t){if(/^\s*text\/html\s*(?:;|$)/i.test(t)){var r=document.implementation.createHTMLDocument("");return e.toLowerCase().indexOf("<!doctype")>-1?r.documentElement.innerHTML=e:r.body.innerHTML=e,r}return n.apply(this,arguments)}}(t)});if(e.stop=function(){},envirenment.isChromeApp){var f={};e.localStorage={key:function(e){return Object.keys(f)[e]},clear:function(e){chrome.storage.local.clear(e)},getItem:function(e,t){return chrome.storage.local.get(e,t),f[e]},get length(){return Object.keys(f).length},setItem:function(e,t,n){f[e]=t;var r={};r[e]=t,chrome.storage.local.set(r,n)},removeItem:function(e,t){delete f[e],f[e]=void 0,chrome.storage.local.remove(e,t)}}}else if("undefined"==typeof localStorage){var f={};e.localStorage={setItem:function(e,t){f[e]=t},getItem:function(e){return f[e]},clear:function(){},key:function(e){return f[e]},length:0,removeItem:function(e){}}}})(window);var enumProperty=/\w*\[\w*\[\"([^\"]*)\"\]\s*=\s*([^\]]*)[^;]*;/gim,enumPropertyEs6="$1=$2,",ModuleType;(function(e){e[e.folder=9007199254740991]="folder",e[e.uknown=-1]="uknown",e[e.code=0]="code",e[e.json=1]="json",e[e.xml=2]="xml",e[e.html=3]="html",e[e.Image=4]="Image",e[e.template=5]="template",e[e.style=6]="style",e[e.none=7]="none"})(ModuleType||(ModuleType={}));var ModuleExt;(function(e){e[e.js=0]="js",e[e.json=1]="json",e[e.xml=2]="xml",e[e.html=3]="html",e[e.img=4]="img",e[e.template=5]="template",e[e.svg=6]="svg",e[e.ico=6]="ico",e[e.css=6]="css",e[e.none=7]="none"})(ModuleExt||(ModuleExt={}));var ModuleStat;(function(e){e[e.New=0]="New",e[e.Downloading=1]="Downloading",e[e.Downloaded=2]="Downloaded",e[e.Defining=3]="Defining",e[e.Defined=4]="Defined",e[e.Executing=5]="Executing",e[e.Executed=6]="Executed",e[e.Failed=7]="Failed",e[e.Forbidden=111]="Forbidden"})(ModuleStat||(ModuleStat={}));var System;(function(e){function t(){for(var e=[],t=0;t<c.length;t++){var n=c[t].checkOverflow();0!=n.length&&e.push([c[t],n])}return e}function n(){for(var e=[],t=0;t<c.length;t++){var n=c[t];n.Stat<6&&e.push(n)}return e}function r(){return f.Args.getUnExecuted()}function o(){return f.Args.getUnSuccessed()}function i(){function e(e){for(var r=0;r<n.length;r++){var o=n[r];if(o.m===e)return o}return n.push(o={a:e.FullName,m:e,r:[],push:function(e){if(this.r.indexOf(e)===-1){this.r.push(e);var n=t.indexOf(e);n!==-1&&t.splice(n,1)}}}),t.push(o),o}var t=[],n=[],o=[];return r().forEach(function(t){var n=e(t.m);t.r.forEach(function(t){e(t).push(n)})},o),n}function s(){var e=[];return y.collectAssets(e,[]),e}function a(e){var t=y.FullName,n=[];return s().map(function(r){if(n.indexOf(r.Folder)==-1){var o=r.Folder.FullName.replace(t,""),i="mkdir "+e+o;n.push(r.Folder)}else i="";var s=r.FullName.replace(t,"");return i+"\r\n copy "+s+" "+e+s})}var u,l=function(e,t){if(null==t)return e;null==e&&(e={});for(var n in t)e[n]=t[n];return e},c=[],h=[];(function(e){var t=function(){function e(e){this.init(e||"")}return e.prototype.IsEquals=function(e){if(!this.SameHostAs(e))return!1;if(this._path.length!==e._path.length)return!1;if(this.moduleName!=e.moduleName)return!1;if(this.ext!=e.ext)return!1;if(this.moduleType!=this.moduleType)return!1;for(var t=0;t<this._path.length;t++)if(this._path[t]!=e._path[t])return!1;return!0},Object.defineProperty(e.prototype,"Directory",{get:function(){return this._directory||(this._directory=new e(this.getDirectory()))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ParentDirectory",{get:function(){if(this.IsFolder){var t;return t=this.IsExternal?this.host+"/":this.IsRooted?"/":"",this.path.length>1&&(t+=this._path.slice(0,this._path.length-1).join("/")+"/"),new e(t)}return this.Directory},enumerable:!0,configurable:!0}),e.prototype.getmoduleType=function(e){if(this.IsFolder)return ModuleType.folder;var t=this.ext;if(null==t||""==t)return"number"==typeof e?e:ModuleType.none;var n=ModuleExt[t];return null==n?ModuleType[this.PluginName]||ModuleType.uknown:n},Object.defineProperty(e.prototype,"moduleType",{get:function(){if(this.IsFolder)return ModuleType.folder;var e=this.ext;if(null==e||""==e)return ModuleType.none;var t=ModuleExt[e];return null==t?ModuleType[this.PluginName]||ModuleType.uknown:t},enumerable:!0,configurable:!0}),e.prototype.getEName=function(e){if(this.IsFolder)return"";e=this.moduleType==ModuleType.none?e:this.ext||ModuleExt[this.moduleType];var t=this.moduleName;return e&&(t+="."+e),this.params&&(t+="?"+this.params),t},e.prototype.setDefaultExt=function(e){return null!=this.ext&&""!=this.ext||(this.ext=e),this},e.prototype.setDefaultType=function(e){return null!=this.ext&&""!=this.ext||(this.ext=ModuleExt[e]),this},Object.defineProperty(e.prototype,"IsPlugin",{get:function(){return null!=this.PluginName&&""!=this.PluginName},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return this.getDirectory()+this.getEName()},e.prototype.getDirectory=function(){var e;return e=this.IsExternal?this.host+"/":this.IsRooted?"/":"",this.path.length>0&&(e+=this.path.join("/")+"/"),e},Object.defineProperty(e.prototype,"IsContextual",{get:function(){return!this.IsPlugin&&this._isContextual},enumerable:!0,configurable:!0}),e.prototype.getUrl=function(e){var t=e.indexOf("?"),n=e.indexOf("#",t);return n!==-1&&(this.fragment=e.substr(n),e=e.substr(0,n)),t!==-1&&(this.params=e.substr(t+1),e=e.substr(0,t)),__global.CaseSensitive||(e=e.toLowerCase()),e},e.prototype.init=function(e){e=this.getUrl(e.trim()),this._directory=null;var t=e.indexOf("|");t!==-1&&(this.PluginName=e.substr(0,t),e=e.substr(t+1)),0===e.indexOf("//")?this.getHost(e=e.substr(2)):this.getFullHost(e);var n=this.path.pop();if(n){this.IsFolder=!1;var r=n,o=r.lastIndexOf(".");o!==-1?(this.ext=r.substr(o+1),this.moduleName=r.substr(0,o)):this.moduleName=r}else this.IsFolder=!0;return this},Object.defineProperty(e.prototype,"IsRooted",{get:function(){return"/"===this.host},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsRelative",{get:function(){return!!this.IsExternal},enumerable:!0,configurable:!0}),e.prototype.getHost=function(e){if(this._isContextual=!1,""===e)return this.host="//",void(this.path=[]);var t=e.indexOf("://"),n=e.indexOf("/");if(n<t)return this.path=e.split("/"),void(0===n&&(this.path.shift(),this.host="/"));if(t===-1)throw" Invalid Url ";var r=e.indexOf("/",t+3);this.host=r===-1?e:e.substr(0,r),this.path=r===-1?[""]:e.substr(r+1).split("/")},e.prototype.getFullHost=function(e){var t=e.indexOf("://"),n=e.indexOf("/");if(this._isContextual=t==-1&&0!=n&&"."!=e[0],t===-1||n<t)this.path=e.split("/"),0===n&&(this.path.shift(),this.host="/");else{var r=e.indexOf("/",t+3);this.host=r===-1?e:e.substr(0,r),this.path=r===-1?[""]:e.substr(r+1).split("/")}},e.prototype.Combine=function(t){var n="string"==typeof t?new e(t):t;if(n.IsExternal)return n;var r=new e;return r.host=this.host,r.path=null==this.path?n.path:null==n.path?null:this.path.concat(n.path),r.moduleName=n.moduleName,r.ext=n.ext,r.params=n.params,r.PluginName=n.PluginName,r.IsFolder=n.IsFolder,r.fragment=n.fragment,r.params=n.params,r.isAsset,r},Object.defineProperty(e.prototype,"IsExternal",{get:function(){return null!=this.host&&""!=this.host&&"/"!=this.host},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAsset",{get:function(){return this.moduleType!==ModuleType.code},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._path},set:function(t){e.RevalidatePath(t,this.IsExternal),this._path=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FullPath",{get:function(){return this.toString()},enumerable:!0,configurable:!0}),e.prototype.SameHostAs=function(t){var n=this.IsExternal?this.host:e.rootUrl.host,r=t.IsExternal?t.host:e.rootUrl.host;return n===r},e.RevalidatePath=function(e,t){if(e){var n,r;for(n=0;n<e.length;n++)if(r=e[n],"."===r)e.splice(n,1),n-=1;else if(".."===r)if(t)0==n?(e.splice(n,1),n-=1):(e.splice(n-1,2),n-=2);else{if(0===n||1===n&&".."===e[2]||".."===e[n-1])continue;n>0&&(e.splice(n-1,2),n-=2)}}},e.prototype.intersect=function(t){if(!this.SameHostAs(t))return null;var n=new e;return n.host=this.host,n},e.getUrl=function(t,n,r){return r&&t.unshift("."),new e(t.join("/")+"/"+(n?n:""))},e.prototype.getRelativePath=function(){function t(e,t){for(var n=[],r=0;r<t;r++)n.push(e);return n}if(!this.IsExternal)return this;var n=new e(document.URL);if(!this.SameHostAs(this))return this;if(this.IsRooted&&0===n._path.length)return e.getUrl(this._path,this.getEName(),!0);for(var r=Math.min(this._path.length,n._path.length),o=0;o<r;o++)if(n._path[o]!==this.path[o]){var i=t("..",n._path.length-o);return e.getUrl(i.concat(this.path.slice(o)),this.getEName(),!0)}return e.getUrl(this.path.slice(r),this.getEName(),!0)},Object.defineProperty(e.prototype,"IsInternal",{get:function(){return!this.IsExternal||e.rootUrl.SameHostAs(this)},enumerable:!0,configurable:!0}),e.rootUrl=new e(document.location.href),e}();e.Url=t})(u=e.basics||(e.basics={}));var d;(function(e){var t=function(){function e(e,t){this._key=e,this._value=String(t||"")}return Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}();e.Header=t;var n=function(){function e(e){this.key=e,this._deleagtes=[]}return Object.defineProperty(e.prototype,"On",{set:function(e){this._deleagtes.push(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Off",{set:function(e){var t=this._deleagtes.indexOf(e);t!=-1&&this._deleagtes.splice(t,1)},enumerable:!0,configurable:!0}),e.prototype.call=function(e,t,n,r){try{for(n++;n<r;n++)this._deleagtes[n].apply(e,t)}catch(e){}return n},e.prototype.PInvoke=function(e,t,n){var r=-1,o=this._deleagtes.length;if(e==this.key&&o>0)for(;r<o;)r=this.call(t,n,r,o)},e.prototype.Invok=function(e,t){var n=this._deleagtes.length;if(e==this.key&&n>0)for(var r=0;r<n;r++)try{t(this._deleagtes[r])}catch(e){}},e.prototype.Add=function(e,t){null==this._store&&(this._store=[]),t&&this._store.push({k:t,d:e}),this._deleagtes.push(e)},e.prototype.Remove=function(e){if(this._store)for(var t=0;t<this._store.length;t++){var n=this._store[t];n.k==e&&(this._store.splice(t,1),t--)}},e}();e.EventListener=n;var r;(function(e){e[e.json=0]="json",e[e.Document=1]="Document",e[e.Text=2]="Text",e[e.ArrayBuffer=3]="ArrayBuffer",e[e.Blob=4]="Blob",e[e[""]=8]=""})(r=e.ResponseType||(e.ResponseType={}));var o;(function(e){e[e.Get=0]="Get",e[e.Post=1]="Post",e[e.Head=2]="Head",e[e.Put=3]="Put",e[e.Delete=4]="Delete",e[e.Options=5]="Options",e[e.Connect=6]="Connect"})(o=e.WebRequestMethod||(e.WebRequestMethod={}));var i=function(){function e(){this.http=new XMLHttpRequest,this._responseType=null,this.key=new Object,this.OnComplete=new n(this.key),this._onprogress=this._onprogress.bind(this),this.http.onload=this._onprogress,this.http.onerror=this._onprogress}return Object.defineProperty(e.prototype,"method",{get:function(){return null==this._method?0:this._method},set:function(e){null!=o[e]&&(this._method=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ResponseType",{get:function(){return this._responseType||r.Text},set:function(e){this._responseType=e},enumerable:!0,configurable:!0}),e.prototype._onprogress=function(e){if(4!=this.http.readyState)throw"";var t=this.OnComplete;t&&t.PInvoke(this.key,null,[this])},Object.defineProperty(e.prototype,"IsSuccess",{get:function(){return 200==this.http.status&&4==this.http.readyState},enumerable:!0,configurable:!0}),e.prototype.Download=function(e,t){this.http.open(o[this.method],e.toString(),!0),this.http.setRequestHeader("allow-cross-origin","*");var n=this.http;n.setRequestHeader("Access-Control-Allow-Headers","*"),n.setRequestHeader("Content-type","*"),n.setRequestHeader("Access-Control-Allow-Origin","*"),this.http.responseType=r[this.ResponseType].toLowerCase(),this.method==o.Get?this.http.send():this.http.send(t.data)},Object.defineProperty(e.prototype,"Response",{get:function(){return this.http.response},enumerable:!0,configurable:!0}),e}();e.WebRequest=i;var s=function(){function e(e,t,n){this.callback=e,this.data=t,this.isPrivate=n,this.callback=e,this.data=t,this.isPrivate=n,this.IsSuccess=null,void 0==n&&(n=!1)}return e}();e.downloadCallback=s;var a=function(){function e(e,t){this.url=e,this.data=t}return e}();e.__data=a;var u=function(){function t(){this.quee=[],this.isRunning=!1,this.isDownloading=!1,this.success=[],this.fails=[],this.OnSuccess=new n(1),this.OnFail=new n(1),this.OnFinish=new n(1),this.webr=new e.WebRequest,this.quee=[],this.isRunning=!1,this.isDownloading=!1,this.success=[],this.fails=[],this.OnSuccess=new n(1),this.OnFail=new n(1),this.OnFinish=new n(1),this.webr.method=e.WebRequestMethod.Get,this.webr.ResponseType=e.ResponseType.Text,this.webr.OnComplete.Add(this.DownloadComplete.bind(this),"DCT")}return Object.defineProperty(t.prototype,"Request",{get:function(){return this.webr},enumerable:!0,configurable:!0}),t.prototype.DownloadComplete=function(e){var t;this.isDownloading=!1,this.webr.IsSuccess?(t=this.OnSuccess,this.success.push(this.current)):(t=this.OnFail,this.fails.push(this.current));try{var n=!0,r=this;if(r.current.data instanceof s){try{var o=r.current.data;o.IsSuccess=r.webr.IsSuccess,o.callback instanceof Function&&o.callback(this,o)}catch(e){}n=!o.isPrivate}n&&t.PInvoke(1,null,[r,r.current.data])}catch(e){}this.Next()},t.prototype.Push=function(e,t){this.quee.push(new a(e,t)),this.isRunning||this.Start()},t.prototype.Start=function(){this.isDownloading||(this.isRunning=!0,this.Next())},t.prototype.Next=function(){if(0==this.quee.length){this.isRunning=!1,this.isDownloading=!1;var e=this;return void this.OnFinish.PInvoke(1,null,[e,e.current.data])}var t=this.current=this.quee.shift();this.webr.Download(t.url,t.data),this.isDownloading=!0},t.prototype.Restart=function(){this.isDownloading=!1,this.Start()},t}();e.Downloader=u})(d=e.net||(e.net={}));var f;(function(t){function n(){v=new d.Downloader,m=new C,p=new S("/",new u.Url("//"));var e=u.Url.rootUrl.path.slice();e.unshift(u.Url.rootUrl.host);var t=u.Url.rootUrl;t.IsFolder||(t=t.Directory),y=new S(e.join("/"),t),p.Stat=_.Executed,i=[],x.Init(),window.global={root:y,global:p}}var r=0,o={},i=[],s=function(){function e(){}return e.set=function(e,t){var n=this.keys.length;this.keys.push(e),this.values[n]=t},e.get=function(e){var t=this.keys.indexOf(e);if(t!==-1)return this.values[t]},e.getkey=function(e){var t=this.values.indexOf(e);if(t!==-1)return this.keys[t]},e.registerNativeTypes=function(){for(var e=Object.getOwnPropertyNames(window),t=0;t<e.length;t++){var n=e[t],r=Object.getOwnPropertyDescriptor(window,n);r=r.value,r&&r.prototype&&r.prototype.constructor===r&&(this.keys.push(r),this.values.push(n))}delete this.registerNativeTypes},e.keys=[],e.values=[],e}();t.dic=s,s.registerNativeTypes();var a={},f=Object.freeze,g=function(){function e(e,t){this._id=t++,a[this._id]={count:"number"!=typeof t?1:t,vaue:e},f(this)}return Object.defineProperty(e.prototype,"Value",{get:function(){var e=a[this._id];if(e)return--e.count<=0&&delete a[this._id],e.vaue},enumerable:!0,configurable:!0}),e}();t.SecureValue=g;var b=function(){function e(e){this.context=this;var t=++r;$defineProperty(this,"Id",{value:t,writable:!1,configurable:!1}),o[t]={Module:e},Object.freeze(this),Object.preventExtensions(this),Object.seal(this)}return Object.defineProperty(e.prototype,"CanAccessToMe",{set:function(e){if(e instanceof Function){var t=o[this.Id];$defineProperty(t,"CanAccessToMe",{value:e,writable:!1,configurable:!1})}},enumerable:!0,configurable:!0}),e.prototype.canAccessToMe=function(e,t,n){var r=o[this.Id];return!r.CanAccessToMe||r.CanAccessToMe(e,t,n)},e.prototype.GetPath=function(e){var t=o[this.Id];return t.Module.Folder.FullName+(e.startsWith("/")?e.substring(1):e)},e.prototype.NameOf=function(e){var t=o[this.Id];return t.Module.NameOf(e)},e.prototype.GetType=function(e){if(null==e)return null;var t=o[this.Id];return t.Module.GGetType(e)},e.prototype.GetEnum=function(e){if(null==e)return null;var t=o[this.Id];return t.Module.GGetEnum(e)},e.prototype.GetStat=function(e){if(null==e)return null;var t=o[this.Id];return t.Module.GetStat()},e.prototype.OnStat=function(e,t,n){var r=o[this.Id];return r.Module.OnStatChanged(e,t,n)},e.prototype.OnGStat=function(e,t){var n=o[this.Id];return n.Module.OnGStatChanged(e,t)},e.prototype.GetTemplateRoot=function(e){var t=o[this.Id],n=t.Module.Folder;if("string"==typeof e){var r=new u.Url(e);if(n=w.NavigateTo(r.path,n),e=r.getEName(),!n)return}if(n instanceof x)return n.getRooteOfTemplate(e)},e.prototype.SetSuperVisor=function(e){var t=o[this.Id];t.Module.RootFolder.SuperVisor=e},e.prototype.HandleExecution=function(){var e=o[this.Id];e.Module._executedHandled=!0},e.prototype.ExecuteModule=function(e){var t=o[this.Id];t.Module._executedHandled=!1,t.Module.Stat=e?ModuleStat.Executed:ModuleStat.Failed},e}();t.Context=b,$defineProperty(b.prototype,"__extends",{value:window.__extends,writable:!1,configurable:!1,enumerable:!1});var x=function(){function t(e,t,n){if(this.folder=e,this.Url=t,this._folderContext=n,this._stat=ModuleStat.New,this.Script="",this._onExecuted=[],c.push(this),t.setDefaultType(ModuleType.code),this.exports=new F,this._stat=ModuleStat.New,this.Script="",this._thisContext=new b(this),this.loadLib=this.loadLib.bind(this),null==e)throw"Context errro";this.require=this.require.bind(this),this._listeners=[]}return Object.defineProperty(t.prototype,"Folder",{get:function(){return this.folder},set:function(e){this.folder=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ResourceUrl",{get:function(){return new u.Url(this.FullName).setDefaultType(ModuleType.code)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FolderContext",{get:function(){return this._folderContext||this.Folder},enumerable:!0,configurable:!0}),t.prototype.call=function(e,t,n,r){return e._thisContext.canAccessToMe(this.Url.moduleType,this.Folder.FullName,this.EName)?t?null==r?t(e.exports):t.call(r,e.exports):e.exports:n?null==r?n("access denied"):n.call(r,"access denied"):null},t.prototype.require=function(e,t,n,r){var o=new u.Url(e);return(o.IsPlugin?this.Folder:this.FolderContext)._require(e,t,n,r)},t.prototype.loadLib=function(e,t){var n=e.indexOf("|"),r=e.substr(0,n),o=e.substr(n+1);return t(0==o.indexOf("*"))&&(o=o.substr(1)),this.RootFolder.LoadAssembly(this.Folder,o,r)},Object.defineProperty(t.prototype,"OnExecuted",{set:function(e){"function"==typeof e&&(e={callback:e,Owner:this}),this._stat>=ModuleStat.Executed?e.callback.call(e.Owner,this,e):this._onExecuted.push(e)},enumerable:!0,configurable:!0}),t.prototype.checkOverflow=function(){var e=[];return t.checkOverflow(this,this,e,[]),0!=e.length&&console.log(this.FullName),e},t.checkOverflow=function(e,n,r,o){if(o.indexOf(n)===-1&&(o.push(n),n.args)){var i=n.args.Dependencies;if(i)for(var s=0;s<i.length;s++){var a=i[s].module;a===e?r.push({module:e,arg:i[s]}):a instanceof t&&t.checkOverflow(e,a,r,o)}}},t.prototype.onModuleExecuted=function(){var e=c.indexOf(this);e!==-1&&c.splice(e,1);for(var t=this._onExecuted.splice(0),e=0;e<t.length;e++){var n=t[e];n.callback&&n.callback.call(n.Owner,this,n)}},t.prototype.NameOf=function(e){return y.NameOf(e)},t.prototype.GGetType=function(e){var t=s.getkey(e);return null!=t?t:(t=y.GetType(e.split(".")),void 0!==t?(s.set(t,e),t):void 0)},t.isConstructor=function(e){return e&&e.prototype&&e.prototype.constructor===e},t.prototype.GGetEnum=function(e,n){if(!n){var r=s.getkey(e);if(null!=r)return r;if(r=y.getRadical().GetEnum(e.split(".")),void 0===r)return;return s.set(r,e),r}for(var o=this.args.Dependencies,i=0;i<o.length;i++){var a=o[i].module;if(a instanceof t&&a.Url.moduleType===ModuleType.code){var u=a.GetEnum(e.split("."));if(u)return u}}},t.prototype.GetStat=function(){return this._stat},t.prototype.OnStatChanged=function(e,t,n){var r=e?this.GetModule(e):this,o=r.Stat;if(o>=t){var i=n(this,e,o,t);if("number"!=typeof i)return;if(i<=o)return;t=i}r._listeners.push({t:this,m:e,s:t,c:n})},t.prototype.OnGStatChanged=function(e,t){i.push({t:this,m:this,s:e,c:t})},t.prototype.GetType=function(e){for(var t=this.exports,n=0;n<e.length;n++)if(t=t[e[n]],void 0===t)return;return t instanceof Function?t:void 0},t.prototype.GetEnum=function(e){for(var t=this.exports,n=0;n<e.length;n++)if(t=t[e[n]],void 0===t)return;return"object"==typeof t?t:void 0},t.prototype.onStatChanged=function(e,t){for(var n=0;n<this._listeners.length;n++){var r=this._listeners[n];if(r.s>e&&r.s<=t){try{var o=r.c(r.t.FullName,this.FullName,t,r.s);if("number"==typeof o&&o>r.s){r.s=o;continue}}catch(e){}this._listeners.splice(n,1),n--}}},t.prototype.onGStatChanged=function(e,t){var n,r;try{for(var o=__values(i),s=o.next();!s.done;s=o.next()){var a=s.value;if(a.s>e&&a.s<=t)try{var u=a.c(a.t.FullName,this.FullName,t,a.s);"number"==typeof u&&u>a.s&&(a.s=u)}catch(e){}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},Object.defineProperty(t.prototype,"Stat",{get:function(){return this._stat},set:function(e){if(!(this._executedHandled&&e==ModuleStat.Executed||e==this._stat||e<this._stat)){var t=this._stat;this._stat=e,e>=ModuleStat.Executed&&this.onModuleExecuted(),this.onStatChanged(t,e),this.onGStatChanged(t,e),7==e&&(this._stat=0,this._fn=null)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){return this.Url.moduleName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EName",{get:function(){return this.Url.getEName(this.Url.isAsset?void 0:"js")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FullName",{get:function(){return null==this._fn&&(this._fn=this.Folder.FullName+this.EName),this._fn},enumerable:!0,configurable:!0}),t.loadEntryPoint=function(t){var n=t||document.currentScript,r=n.getAttribute("entry-point");if(void 0!=r){n.removeAttribute("entry-point");var o=new e.basics.Url(r);if(o.IsPlugin){if(0!==r.indexOf("lib:"))throw"";y._stat=_.Executed;var i=y.LoadAssemblyByUrl(o);i.OnExecuted=function(e,t){e.EntryPoint&&(i.EntryPoint.OnExecuted=function(e,t){var n=e.exports;6===e.Stat?n.Start&&n.Start():alert("we cannot find app")})}}else y.LoadEntryPoint(o);return!0}return!1},t.Init=function(){if(!document.currentScript||!this.loadEntryPoint())for(var e=Array.prototype.slice.call(document.getElementsByTagName("script"),0),t=0;t<e.length;t++){var n=e[t];if(this.loadEntryPoint(n))return}},Object.defineProperty(t.prototype,"RootFolder",{get:function(){return this.Folder.Root},enumerable:!0,configurable:!0}),t.prototype.GetModule=function(e){return"string"==typeof e&&(e=new u.Url(e)),(!e.IsContextual||this.Url.isAsset?this.Folder:this.FolderContext).GetModule(e)},t.__require=function(e,t){var n,r=!1;switch(t){case"exports":n=e.exports;break;case"define":n={define:e.Folder.define};break;case"require":n=e.require;break;case"context":n=e._thisContext;break;case"loadLib":r=!0,n=e.loadLib;break;default:if(0===t.indexOf("plugin|")){var o=m.get(t.substr(7));n=o?o:null}else if(0==t.indexOf("lib:")){var i=t.indexOf("|"),s=t.substr(4,i-4),a=t.substr(i+1);(r=0==a.indexOf("*"))&&(a=a.substr(1)),n=e.RootFolder.LoadAssembly(e.Folder,a,s)}else(r=0==t.indexOf("*"))&&(t=t.substr(1)),n=e.GetModule(t)}return{mdl:n,isOptional:r}},t.id=0,t}();t.Module=x;var _,w=function(){function e(t,n){if(this.Parent=t,this.Name=n,t===e.Me&&(this.Parent=this),this.Modules=new M,this.Assets=new M,this.subFolders=new O(this),this.require=this.require.bind(this),this.define=this.define.bind(this),this.define.amd={},null==t)throw"Parent is null"}return e.prototype.LoadAssemblyByUrl=function(e){if(!e.IsPlugin)throw"";var t=e.PluginName.substr(4,e.PluginName.length-4),n=e.FullPath;return 0==n.indexOf("*")&&(n=n.substr(1)),this.Root.LoadAssembly(this,n,t)},Object.defineProperty(e.prototype,"ResourceUrl",{get:function(){return new u.Url(this.FullName)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsAssemby",{get:function(){return this instanceof S},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Root",{get:function(){for(var e=this;!(e instanceof S);)e=e.Parent;return e},enumerable:!0,configurable:!0}),e.prototype.GetFolder=function(e,t){if(!e)return this;var n;return n=e.IsExternal?e.IsInternal?this.Root:p.createPath([e.host],t):e.IsRooted?this.Root:this,n.createPath(e.path,t)},e.prototype.GetModule=function(e){if("string"==typeof e&&(e=new u.Url(e)),e.IsPlugin&&"plugin"===e.PluginName.toLowerCase())return m.get(e.moduleName);if(e.IsFolder)throw"Invalid FileName Path :"+e.FullPath;e.setDefaultType(ModuleType.code);var t=this.GetFolder(e),n=e.isAsset===!0?t.Assets:t.Modules,r=n.getModule(e);return null==r&&(n.setModule(r=new x(t,e,this)),this.Root.OnModuleExecuting(r)),r},Object.defineProperty(e.prototype,"FullName",{get:function(){if(!this._fn){if(this==this.Parent)return this._fn=this.Name+"/";var e=this.Parent;this._fn=(null==e?"":e.FullName)+this.Name+"/"}return this._fn},enumerable:!0,configurable:!0}),e.prototype.createPath=function(t,n){return e.CreatePath(t,this,n)},e.prototype.NafigateTo=function(t){var n=new u.Url(t),r=e.NavigateTo(n.path,this);return r&&n.moduleName?r.GetModule(n.getEName()):r},e.NavigateTo=function(e,t){for(var n=0,r=e.length;n<r;n++){var o=e[n];switch(o=o.trim()){case"~":t=y;break;case"":case".":continue;case"..":t=t&&t.Parent;continue;default:if(t){var i=t.subFolders.GetFolder(o);if(!i)return;continue}return}}return t},e.CreatePath=function(t,n,r){if(!t)return n;for(var o=0,i=t.length;o<i;o++){if(r&&!n)return;var s=t[o];switch(s=s.trim()){case"~":n=y;break;
case"":case".":continue;case"..":n=n&&n.Parent;continue;default:if(n){var a=n.subFolders.GetFolder(s);n=a?a:r?null:n.subFolders.createFolder(s);continue}n=r?null:new e(null,s)}}return n},e.prototype._nameOf=function(e){var t=this.Modules._store;for(var n in t){var r=t[n],o=D.GetType(e,r.exports);if(null!=o)return o}var i=this.subFolders._store;for(var n in i){var s=i[n],o=s._nameOf(e);if(null!=o)return o}},e.prototype.NameOf=function(e){var t=s.get(e);return void 0!=t?t:(t=this._nameOf(e),null!=t&&s.set(e,t),t)},e.prototype.GetType=function(e){var t=this.Modules._store;for(var n in t){var r=t[n],o=r.GetType(e);if(void 0!==o)return o}var i=this.subFolders._store;for(var n in i){var s=i[n],o=s.GetType(e);if(void 0!==o)return o}},e.prototype.GetEnum=function(e){var t=this.Modules._store;for(var n in t){var r=t[n],o=r.GetEnum(e);if(void 0!==o)return o}var i=this.subFolders._store;for(var n in i){var s=i[n];if(o=s.GetEnum(e),void 0!==o)return o}},e.prototype.getRadical=function(){var e=this;for(t=e;;){var t=e.Parent;if(!t||e==t)return e;e=t}},e.prototype.define=function(){var e,t=0;if("string"==typeof arguments[0]){if(e=this.GetModule(arguments[0]),e.Stat>2)throw"module "+e.FullName+" exist";e._folderContext=this,e.Stat=ModuleStat.Downloaded}else t=-1,e=new x(this,new u.Url("code|@anonymouse"+ ++this.anonymouseCounter+".js"),this);this.Root.CheckIfToSkip(e)?e.Stat=ModuleStat.Failed:k.CodeManager.asyncLoadDependencies(e,arguments[1+t],arguments[2+t])},e.prototype.require=function(){return"string"!=typeof arguments[1]?this._require.apply(this,arguments):S.prototype.LoadAssembly.call(this.Root,this,arguments[0],arguments[1],arguments[2])},e.prototype._require=function(e,t,n,r){if("string"==typeof e){var o=this.GetModule(e);return o.Stat==ModuleStat.Executed?this.call(o,t,n,r):o.Stat==ModuleStat.Failed?n&&n.call(r,"module failed to execute"):(o.Stat>=ModuleStat.Downloading?o.OnExecuted={callback:function(e){this.call(e,t,n,r)},Owner:this}:o.Stat==ModuleStat.New&&(o.OnExecuted={callback:function(e){this.call(e,t,n,r)},Owner:this},m.Download(o)),o)}},e.prototype.call=function(e,t,n,r){return e._thisContext.canAccessToMe(-1,this.FullName,this.Name)?t?null==r?t(e.exports):t.call(r,e.exports):e.exports:n?null==r?n("access denied"):n.call(r,"access denied"):null},e.prototype.getRooteOfTemplate=function(e,t){if(t){if(t.indexOf(this)!==-1||null==this)return}else t=[];t.push(this);for(var n in this.Assets._store){var r=this.Assets._store[n];if(r.Url.moduleType===ModuleType.template){var o=r.exports,i=o.template.get(e);if(i)return i}}for(var n in this.subFolders._store){var s=this.subFolders._store[n],a=s.getRooteOfTemplate(e,t);if(a)return a}if(this.Parent)return this.Parent.getRooteOfTemplate(e,t)},e.prototype.ConvertToAssembly=function(e,t){if(this instanceof S)return this;var n=new S(e,t);return n.Replace(this,null)},e.prototype.Replace=function(e,t){if(e){this.subFolders._store=e.subFolders._store,this.Modules._store=e.Modules._store,this.Assets._store=e.Assets._store;for(var n in e.subFolders._store){var r=this.subFolders._store[n];r instanceof S||(r.Parent=this)}for(var n in e.Modules._store){var o=e.Modules._store[n];o.Folder=this}for(var n in e.Assets._store){var o=e.Assets._store[n];o.Folder=this}i.subFolders.deleteFolder(e);var i=t||e.Parent}else{if(!t)throw"unvalid arguments";i=t}this instanceof S||(this.Parent=i);var s=y.GetFolder(this.ResourceUrl.ParentDirectory);return i.subFolders.register(this),s!=i&&s.subFolders.register(this),this},e.prototype.collectAssets=function(e,t){if(t.indexOf(this)!=-1)return!0;for(var n in this.subFolders._store)this.subFolders._store[n].collectAssets(e,t);for(var n in this.Assets._store)e.push(this.Assets._store[n])},e.Me=new Object,e}();(function(e){e[e.New=0]="New",e[e.Executing=1]="Executing",e[e.Executed=2]="Executed"})(_=t.AssemblyStat||(t.AssemblyStat={}));var E;(function(e){function t(e,t){var n=e.FullPath.toLowerCase();if(n){if(t!=r[n])throw"Conflit assembly"}else r[e.FullPath.toLowerCase()]=t}function n(e){return r[e.FullPath.toLowerCase()]}var r={};e.setAssembly=t,e.getAssembly=n})(E||(E={}));var S=function(e){function t(t,n){var r=e.call(this,w.Me,t)||this;if(r.Assemblies=new P,r._stat=0,r.pendingAssemblies=0,r.pending=0,r.modules=[],r._onExecuted=[],r.modulePrototypes=[],r.onModuleExecuted=r.onModuleExecuted.bind(r),r.OnAssemblyDependencyExecuted=r.OnAssemblyDependencyExecuted.bind(r),!n.IsFolder)throw"Invalid assembly Path";return r.resourceUrl=n,r}return __extends(t,e),Object.defineProperty(t.prototype,"SuperVisor",{set:function(e){this._superVisor=e},enumerable:!0,configurable:!0}),t.prototype.CheckIfToSkip=function(e){return this._superVisor&&this._superVisor(e.Url)},t.prototype.LoadEntryPoint=function(e){var t=this.CreateEntryPoint(e);this.EntryPoint=t},t.prototype.collectAssets=function(t,n){if(!e.prototype.collectAssets.call(this,t,n))for(var r in this.Assemblies._store){var o=this.Assemblies._store[r];o.collectAssets(t,n)}},Object.defineProperty(t.prototype,"Stat",{get:function(){return this._stat},enumerable:!0,configurable:!0}),t.prototype.GetModuleOnStat=function(e){void 0===e&&(e=7);for(var t=[],n=0;n<this.modules.length;n++)this.modules[n]._stat==e&&t.push(this.modules[n]);return t},Object.defineProperty(t.prototype,"EntryPoint",{get:function(){return this.entryPoint},set:function(e){if(null!=this.entryPoint)throw"Invalide stat";this.entryPoint=e,e.OnExecuted=this.OnEntryPointExecuted.bind(this),m.Download(e)},enumerable:!0,configurable:!0}),t.prototype.OnEntryPointExecuted=function(e,t){0==this.pendingAssemblies&&0==this.pending&&this._stat<_.Executed&&this.OnAssemblyExecuted(),this.startDownloadModules()},Object.defineProperty(t.prototype,"IsEntryPointExecuted",{get:function(){return this.entryPoint._stat>5},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FullName",{get:function(){return this.resourceUrl.FullPath},enumerable:!0,configurable:!0}),t.prototype.Register=function(e){var n=this.subFolders._store[e.Name];{if(!(n instanceof t)){var r=e.Replace(n,this);return this.Assemblies.setAssembly(e),r}if(n!==e)throw"unvalid stat"}},t.prototype.GetAssembly=function(e){return this.Assemblies.getAssembly(e)},t.prototype.OnModuleExecuting=function(e){this.modules.push(e),this._stat<_.Executed&&(this.pending++,e.OnExecuted=this.onModuleExecuted)},t.prototype.OnAssemblyExecuted=function(){this._stat=_.Executed;for(var e=this._onExecuted.splice(0),t=0;t<e.length;t++){var n=e[t];n.callback&&n.callback.call(n.Owner,this,n)}},t.prototype.onModuleExecuted=function(e,t){this.pending--,0==this.pending&&this.OnAssemblyExecuted()},Object.defineProperty(t.prototype,"OnExecuted",{set:function(e){"function"==typeof e&&(e={callback:e,Owner:this}),this._stat>=_.Executed?e.callback.call(e.Owner,this,e):this._onExecuted.push(e)},enumerable:!0,configurable:!0}),t.prototype.OnAssemblyDependencyExecuted=function(e,t){this.pendingAssemblies--,0==this.pendingAssemblies&&this.startDownloadModules()},t.prototype.startDownloadModules=function(){for(var e;e=this.modulePrototypes.shift();)k.CodeManager.loadDependencies(e.module,e.dependencies,e.callback);this.CheckIfAssemblyExecuted()},t.prototype.PushModule=function(e,t,n){e.Stat=ModuleStat.Defining,e!=this.entryPoint&&this.deferedNonGlobalAssemblies||this.loadLibs(e,t,n),this.IsEntryPointExecuted?N.Dispatcher.call(null,k.CodeManager.loadDependencies,e,t,n):this.Stat<_.Executed?this.modulePrototypes.push({module:e,dependencies:t,callback:n}):k.CodeManager.loadDependencies(e,t,n)},t.prototype.loadLibs=function(e,t,n){for(var r=0,o=t.length;r<o;r++){var i=t[r];if(0==i.indexOf("lib:")){var s=i.indexOf("|"),a=i.substr(4,s-4),u=i.substr(s+1);0==u.indexOf("*")&&(u=u.substr(1)),this.LoadAssembly(e.Folder,u,a)}}},t.prototype.CheckIfAssemblyExecuted=function(){0==this.pendingAssemblies&&0==this.pending&&this.OnAssemblyExecuted()},t.prototype.CreateEntryPoint=function(e){var t,n=this.GetFolder(e.Directory,!1);return n.Modules.setModule(t=new x(n,e,this)),t},t.prototype.LoadAssembly=function(e,n,r){if("string"==typeof n&&0==n.indexOf("<")?(n=n.substr(1),n=y.ResourceUrl.Combine(n)):n=e.ResourceUrl.Combine(n),n.IsFolder)var o=n,i=n.Combine("index.js");else i=n,o=n.Directory;i.setDefaultType(ModuleType.code);var s=this.GetAssembly(r);if(s){if(s.Stat>=_.Executed)return s}else{var a=y.GetFolder(o,!0);a instanceof t?s=a:(s=E.getAssembly(o))||(s=new t(r,o),s.LoadEntryPoint(new u.Url(i.getEName("js")))),this.Register(s)}return this.pendingAssemblies++,s.OnExecuted=this.OnAssemblyDependencyExecuted,s},t}(w);t.Assembly=S;var O=function(){function e(e){this.folder=e,this._store={}}return e.prototype.register=function(e){this._store[e.Name.toLowerCase().trim()]=e},e.prototype.GetFolder=function(e){return this._store[e.toLowerCase().trim()]},e.prototype.createFolder=function(e){var t=new w(this.folder,e);return this._store[e.toLowerCase().trim()]=t,t},e.prototype.deleteFolder=function(e){if(e.Parent!==this.folder)throw"unvalid operation";e instanceof S||(e.Parent=null),delete this._store[e.Name.toLowerCase().trim()]},e}(),M=function(){function e(){this._store={},this.OnExecuted=new d.EventListener(1),this._store={},this.OnExecuted=new d.EventListener(1)}return e.prototype.getModule=function(e){return this._store[e.getEName(e.isAsset?void 0:"js")]},e.prototype.setModule=function(e){this._store[e.EName]=e},e}(),P=function(){function e(){this._store={}}return e.prototype.getAssembly=function(e){return this._store[e]},e.prototype.setAssembly=function(e){this._store[e.Name]=e},e}(),D=function(){function e(){}return e._getPath=function(e){if(e.constructor===Object||e.constructor===F)for(var t in e){var n=e[t];if(null!=n&&this.passed.indexOf(n)===-1)switch(this.passed.push(n),typeof n){case"string":case"number":case"boolean":case"undefined":continue;default:if(n===this.type)return t;if(n instanceof Function)continue;var r=this._getPath(n);if(null!=r)return t+"."+r}}return null},e.GetType=function(e,t){return this.type=e,this.passed.length=0,this._getPath(t)},e.passed=[],e}(),T=function(){function e(e,t,n){this.Args=e,this.module=t,this.Index=n}return e}(),F=function(){function e(e){if(e){for(var t in e)this[t]=e[t];Object.freeze(this),Object.seal(this)}}return e}();t.Exports=F;var A=function(){function e(e,t){this.Module=e,this.callback=t,this.Dependencies=[],this.nsuccess=0,this.onModuleExecuted=this.onModuleExecuted.bind(this),e.args=this,h.push(this)}return e.prototype.createDependency=function(e,t,n){var r=new T(this,e,t);return this.Dependencies[t]=r,e instanceof S?n?this.nsuccess++:e.Stat<_.Executed?e.OnExecuted=this.onAssemblyExecuted.bind(this):this.nsuccess++:e instanceof x?(n&&this.nsuccess++,e.Stat>=ModuleStat.Executed?this.nsuccess++:(n||(e.OnExecuted=this.onModuleExecuted),e.Stat===ModuleStat.New&&m.Download(e))):this.nsuccess++,r},e.prototype.onAssemblyExecuted=function(e,t){this.nsuccess++,this.checkNSuccess()},e.prototype.onModuleExecuted=function(e){this.nsuccess++,this.checkNSuccess()},e.prototype.checkNSuccess=function(){this.nsuccess>=this.Dependencies.length&&(this.nsuccess=Number.NEGATIVE_INFINITY,this.Execute())},e.prototype.populateArgs=function(){for(var e=new Array(this.Dependencies.length),t=this.Dependencies,n=0,r=t.length;n<r;n++){var o=t[n].module;o instanceof x?e[n]=this.Module.call(o):o instanceof S?e[n]={require:o.require,define:o.define,entryPoint:o.EntryPoint.call(o.EntryPoint)}:e[n]=o}this._args=e},e.prototype.Execute=function(){this.populateArgs();var e=this.Module;try{if(e.Stat=ModuleStat.Executing,e.Stat>=ModuleStat.Executed)return;if(e.RootFolder.CheckIfToSkip(e))return;var t=this.callback.apply(e._thisContext,this._args);if(t){var n=e.exports;"function"==typeof t?(e.exports=t,t.__export__=n):"object"!=typeof t?n.Default?n.Default instanceof Array?n.Default.push(t):n.Default=[n.Default,t]:n.Default=t:l(e.exports,t)}e.Stat=ModuleStat.Executed}catch(t){e.Stat=ModuleStat.Failed}},e.prototype.Invoke=function(){this.nsuccess>=this.Dependencies.length&&this.Execute()},e.prototype.getUnExecuted=function(){var e=[];return this.Dependencies.forEach(function(e,t,n){e.module instanceof x&&e.module.Stat<6&&this.push(e.module)},e),e},e.prototype.getUnSuccessed=function(){var e=[];return this.Dependencies.forEach(function(e,t,n){e.module instanceof x&&e.module.Stat>6&&this.push(e.module)},e),e},e.getUnExecuted=function(){var e=[];return h.every(function(t,n,r){var o=t.getUnExecuted();return 0!==o.length&&e.push({m:t.Module,r:o}),!0},e),e},e.getUnSuccessed=function(){var e=[];return h.every(function(t,n,r){var o=t.getUnSuccessed();return 0!==o.length&&e.push({m:t.Module,r:o}),!0},e),e},e}();t.Args=A,t.initialize=n;var I;(function(e){e[e.Initializer=0]="Initializer",e[e.Downloader=1]="Downloader",e[e.Definer=2]="Definer",e[e.Executer=3]="Executer"})(I=t.OperationPhase||(t.OperationPhase={}));var N;(function(e){function t(){u=!0;for(var e=l.slice(),t=0;t<e.length;t++)try{var i=e[t];i.callback.call(i.owner)}catch(e){}u=!1,0!=o.length&&(clearTimeout(r),r=setTimeout(c.start,0),n=!0)}var n=!1,r=-1,o=[],i=[],s=0,a=function(){function e(e,t){this.id=e,this.params=t||[]}return e.prototype.Set=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n,r=e.length-1;r>=0;r--){if(void 0===(n=e[r]))continue;this.params[r]=n}return this},e.prototype.Set1=function(e){for(var t,n=e.length-1;n>=0;n--){if(void 0===(t=e[n]))continue;this.params[n]=t}return this},e.prototype.Clone=function(){var t=new e(this.id);return t.Set1(this.params),t},e}();e.JobParam=a;var u,l=[],c=function(){function e(){}return e.OnIdle=function(e,t){if(u||!n)try{t.call(e)}catch(e){}else l.push({owner:e,callback:t})},e.InIdle=function(){return u},e.GC=function(){for(var e=0,n=i.length;e<n;e++){var r=i[e];r.children.length=0,r.ce=0}o.length=0,s=0,t()},e.clone=function(e,t,n){var r={callback:e.callback,_this:void 0===n?e._this:n,id:e.id,isWaiting:!0,optimizable:!1,params:new a(e.id).Set1(t||e.params.params)};return e.children.push(r),r},e.cretaeJob=function(e,t,n,r){var o={callback:e,params:new a(i.length,t),_this:n,optimizable:r,isWaiting:!1,id:i.length,children:[],ce:0};return i.push(o),o.params},e.Clear=function(e){for(var t=i[e.id],n=t.children,r=t.ce,o=n.length,s=o-1;s>r;s--){var a=n[s];a.isWaiting=!1,a.optimizable=!0}n.length=0,t.ce=0},Object.defineProperty(e,"CurrentJob",{get:function(){return o[s]},enumerable:!0,configurable:!0}),e.start=function(){if(n=!0,0===o.length)return n=!1,void t();for(var a=s+Math.min(3,o.length-s);s<a;s++){var u=o[s];if(u.isWaiting)try{var l=u.params.params;u.callback.call(u._this,l[0],l[1],l[2])}catch(e){}if(!u.optimizable){var c=i[u.id];c.ce++}u.isWaiting=!1,o[s]=null}n=s<o.length,n?r=setTimeout(e.start,0):e.GC()},e.Push=function(t,s,a){var l=i[t.id];if(l.optimizable){if(s&&l.params.Set(s),l._this=void 0===a?l._this:a,l.isWaiting)return}else l=this.clone(l,s,a);return l.isWaiting=!0,o.push(l),n||o.length>0&&(clearTimeout(r),r=setTimeout(e.start,0),n=!0,u=!1),l},e.call=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];this.Push(h,[e,t,n])},e.icall=function(e,t,n){this.Push(h,[e,t,n])},e}();e.Dispatcher=c;var h=e.Dispatcher.cretaeJob(function(e,t,n){t.apply(e,n)},[],null,!1)})(N=t.thread||(t.thread={}));var C=function(){function e(){this._store={},this.register(new k.StyleManager),this.register(new k.CodeManager),this.register(new k.TemplateManager),this.register(new k.JsonManager)}return e.prototype.register=function(e){this._store[e.moduleType]=e},e.prototype.Download=function(e,t,n){if(e.Stat>=ModuleStat.Downloading)throw"Modul Stat Corrupted";if(e.Url.IsPlugin)r=this._store[ModuleType[e.Url.PluginName]];else var r=this._store[e.Url.moduleType];if(!r)return void(e.Stat=ModuleStat.Failed);e.Stat=ModuleStat.Downloading;var o={module:e,dataStat:n,OnOperationDone:t};return r.Download(o),o},e.prototype.Execute=function(e){if(e.module.Stat>=ModuleStat.Executing)throw"Modul Stat Corrupted";var t=this._store[e.module.Url.moduleType];return t?(e.module.Stat=ModuleStat.Executing,void t.Download(e)):void(e.module.Stat=ModuleStat.Failed)},e.prototype.get=function(e){if("number"==typeof e)var t=e;else if(t=ModuleType[e=e.toLowerCase()],void 0===t)return this._store[e];return this._store[t]},e}();t.ModuleDownoader=C;var k;(function(e){$defineProperty(window,"define",{get:function(){return n.define},set:function(e){},configurable:!1,enumerable:!1}),$defineProperty(window,"require",{get:function(){return n._current&&n._current.module.require||y.require},set:function(e){},configurable:!1,enumerable:!1});var t=function(){function e(){this._eventsStore={}}return e.prototype.Define=function(e){},e.prototype.Execute=function(e){},e.prototype.addEventListener=function(e,t,n){var r=this._eventsStore[e];r||(this._eventsStore[e]=r=[]),r.push({data:n,callback:t})},e.prototype.removeEventlistenr=function(e,t){var n=this._eventsStore[e];if(n)for(var r=0;r<n.length;r++)if(n[r].callback===t)return n.splice(r,1)},Object.defineProperty(e.prototype,"avaibleEvents",{get:function(){return this._avaibleEvents},enumerable:!0,configurable:!0}),e.prototype.detacheEvent=function(e,t,n,r){var o=this._eventsStore[e];if(o)for(var i={data:r,exports:n,url:t},s=0;s<o.length;s++){var a=o[s];try{a.callback(i)}catch(e){}}},e}(),n=function(e){function t(){var n=e.call(this)||this;if(n.moduleType=ModuleType.code,t.instance)throw"this is Singliton class";return t.instance=n,n}return __extends(t,e),t.eventHandler=function(e){return t.instance.handleEvent(e,this)},t.Next=function(){this._isDownloading||this.Download()},t.Push=function(e){e&&this._store.push(e),this.Next()},t.prototype.handleEvent=function(e,n){var r=t._current,o=r.module;if(t._current=void 0,t._isDownloading=!1,r){var i=r.dData;this.detacheEvent(ModuleStat.Downloaded,o.Url,o.exports),i.removeEventListener("load",n),i.removeEventListener("error",n),i.remove(),r.error="error"===e.type,r.error;var s=o.Stat==ModuleStat.Defining;o.Stat=ModuleStat.Downloaded,s||(o.Stat=ModuleStat.Defined),l(o.exports,window.exports),window.exports={},r.error&&(o.Stat=ModuleStat.Failed),s||(o.Stat=r.error?ModuleStat.Failed:ModuleStat.Executed);try{r.OnOperationDone&&r.OnOperationDone(r,I.Downloader)}catch(e){}this.detacheEvent(o.Stat,o.Url,o.exports),t.Next()}},t.define=function(){var e=t._current;if(!e){if(0!=arguments.length)return y.define.apply(y,arguments);throw"UnExpected Error"}t.beginDefine(e.module,arguments)},t.beginDefine=function(e,n){if(e.RootFolder.CheckIfToSkip(e))return void(e.Stat=ModuleStat.Failed);if("string"==typeof n[0])w.prototype.define.apply(e.Folder,n);else if(n[0]instanceof Array)e._folderContext=e.Folder,t.asyncLoadDependencies(e,n[0],n[1]);else{if(!(n[0]instanceof Function))throw"Code not implimented";t.loadDependencies(e,[],n[0])}},t.Download=function(){if(0===this._store.length)return this._isDownloading=!1,void(this._current=void 0);var e=this._current=this._store.shift(),t=document.createElement("script"),n=e.module;t.src=n.ResourceUrl.FullPath,e.dData=t,n.Stat=ModuleStat.Downloading;var r={_this:this,handleEvent:this.eventHandler};t.addEventListener("load",r),t.addEventListener("error",r),this._isDownloading=!0,window.exports={},document.head.appendChild(t)},t.prototype.Download=function(e){t.Push(e)},t.prototype.Define=function(e){},t.prototype.Execute=function(e){},t.getUrls=function(){var e=[],t=document.head.firstChild;do t instanceof HTMLScriptElement&&""!=(t.src||"").trim()&&e.push(t.src);while(t=t.nextSibling);return e},t.asyncLoadDependencies=function(e,t,n){e.RootFolder.PushModule(e,t,n)},t.loadDependencies=function(e,t,n){if(e.RootFolder.CheckIfToSkip(e))return void(e.Stat=ModuleStat.Failed);if(!(e.Stat>ModuleStat.Defining)&&null==e.args){e.Stat=ModuleStat.Defining;for(var r=new A(e,n),o=0,i=t.length;o<i;o++){var s=t[o],a=x.__require(e,s),u=a.mdl,l=a.isOptional;r.createDependency(u,o,l)}e.Stat=ModuleStat.Defined,r.Invoke()}},t.__require=function(e,t){var n,r=!1;switch(t){case"exports":n=e.exports;break;case"define":n={define:e.Folder.define};break;case"require":n=e.require;break;case"context":n=e._thisContext;break;case"loadLib":r=!0,n=e.loadLib;break;default:if(0===t.indexOf("plugin|")){var o=m.get(t.substr(7));n=o?o:null}else if(0==t.indexOf("lib:")){var i=t.indexOf("|"),s=t.substr(4,i-4),a=t.substr(i+1);(r=0==a.indexOf("*"))&&(a=a.substr(1)),n=e.RootFolder.LoadAssembly(e.Folder,a,s)}else(r=0==t.indexOf("*"))&&(t=t.substr(1)),n=e.GetModule(t)}return{mdl:n,isOptional:r}},t._store=[],t._isDownloading=!1,t}(t);e.CodeManager=n,n.define.amd={};var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.moduleType=ModuleType.style,t}return __extends(t,e),t.handleEvent=function(e){var t=this;t.t.onDownloaded(t.e,this,e)},t.prototype.Download=function(e){var n=document.createElement("link");n.rel="stylesheet";var r=e.module;n.href=r.ResourceUrl.FullPath,e.dData=n,r.Stat=ModuleStat.Downloading;var o={handleEvent:t.handleEvent,e:e,t:this};n.addEventListener("load",o),n.addEventListener("error",o),document.head.appendChild(n)},t.prototype.Define=function(e){},t.prototype.Execute=function(e){},t.prototype.onDownloaded=function(e,t,n){e.dData.removeEventListener("load",t),e.dData.removeEventListener("error",t);var r=e.module,o=e.dData;this.detacheEvent(ModuleStat.Downloaded,r.Url,r.exports),e.error="error"===n.type,r.Stat=ModuleStat.Defined;try{e.eData=o.sheet,l(r.exports,{sheet:o.sheet,dom:o}),r.Stat=e.error?ModuleStat.Failed:ModuleStat.Executed,e.OnOperationDone&&e.OnOperationDone(e,I.Downloader)}catch(e){}this.detacheEvent(r.Stat,r.Url,r.exports)},t}(t);e.StyleManager=r;var o=function(){function e(){}return e.split=function(e){for(var t=[],n=e.split("."),r=0;r<n.length;r++){var o=n[r];if(""!==o){var i=o.split(/[\]\[]/);if(1===i.length)t.push(o);else for(var s=0;s<i.length;s++){var a,u=isNaN(a=parseInt(i[r]));u?t.push(a):t.push(i[r])}}}return t},e.get=function(e,t){for(var n=this.split(e),r=t.GetTemplateRoot(n[0]),o=r,i=1;i<n.length;i++){var s=n[i];if(o instanceof Element)return;o=o.get(s)}return o},e}();e.Templates=o;var i=function(t){function r(){var n=null!==t&&t.apply(this,arguments)||this;return n.moduleType=ModuleType.template,n.OnNewTemplateExecuted=new d.EventListener(e),n}return __extends(r,t),r.prototype.Download=function(e){v.Push(e.module.ResourceUrl,new d.downloadCallback(r._execute,{key:this,value:e},!0))},r._execute=function(e,t){var o=t.data.key,i=t.data.value,s=i.module;s.Stat=ModuleStat.Downloaded,o.detacheEvent(ModuleStat.Downloaded,s.Url,s.exports);try{var a=document.createElement("div");a.innerHTML=e.webr.Response;var u=[],c=r.BuildTree(a.firstElementChild,u);l(s.exports,{require:s.require,template:r.reduce(c),html:a.firstElementChild,context:s._thisContext})}catch(e){t.IsSuccess=!1}t.IsSuccess&&0!=u.length?n.asyncLoadDependencies(s,u,function(){s.Stat=t.IsSuccess?ModuleStat.Executed:ModuleStat.Failed,o.detacheEvent(s.Stat,s.Url,s.exports)}):(s.Stat=t.IsSuccess?ModuleStat.Executed:ModuleStat.Failed,o.detacheEvent(s.Stat,s.Url,s.exports))},r.prototype.Execute=function(){},r.reduce=function(e){return 2===Object.getOwnPropertyNames(e).length&&1===e["#"].length?r.reduce(e["#"][0]):e},r.get=function(e){return"string"==typeof e?this[e]:this["#"][e]},r.BuildTree=function(e,t){var n={get:this.get},o=[];return n["#"]=o,r.reduce(this.buildTree(e,n,o,t))},r.buildTree=function(e,t,n,r){var o=e.getAttribute("name");switch(e.tagName){case"REQUIRE":r.push(e.getAttribute("module")||e.getAttribute("url")||e.innerText||e.innerHTML);break;case"TEMPLATES":case"DESCRIPTOR":var i={get:this.get},s=[];i["#"]=s,o?t[o]=i:n.push(i);for(var a=e.firstElementChild;a;)this.buildTree(a,i,s,r),a=a.nextElementSibling;break;default:case"TEMPLATE":o?t[o]=e:n.push(o)}return t},r}(t);e.TemplateManager=i;var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.moduleType=ModuleType.json,t}return __extends(t,e),t.prototype.Download=function(e){v.Push(e.module.ResourceUrl,new d.downloadCallback(t._execute,{key:this,value:e},!0))},t._execute=function(e,t){var n=t.data.key,r=t.data.value,o=r.module;if(n.detacheEvent(ModuleStat.Downloaded,o.Url,o.exports),t.IsSuccess)try{l(o.exports,{require:o.require,value:JSON.parse(e.webr.Response)})}catch(e){t.IsSuccess=!1}o.Stat=t.IsSuccess?ModuleStat.Executed:ModuleStat.Failed,n.detacheEvent(o.Stat,o.Url,o.exports)},t}(t);e.JsonManager=s})(k||(k={}))})(f||(f={}));var p,y,v,m;f.initialize(),e.checkOverFlow=t,e.checkStat=n,e.getUnExecuted=r,e.getUnUnSuccessed=o,e.getUExecuted=i,e.collectAssets=s,e.getCmdCopy=a})(System||(System={}));